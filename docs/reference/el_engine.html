<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Empirical likelihood (EL) engine for NMAR — el_engine • NMAR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Empirical likelihood (EL) engine for NMAR — el_engine"><meta property="og:description" content="Constructs a configuration for the empirical likelihood estimator under
nonignorable nonresponse (NMAR), following Qin, Leung and Shao (2002).
Pass the returned object to `nmar()` together with a formula and data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NMAR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/developing_new_nmar_estimator.html">Developing a New NMAR Estimator</a>
    </li>
    <li>
      <a href="../articles/el_empirical_likelihood_theory.html">Empirical Likelihood Theory for NMAR</a>
    </li>
    <li>
      <a href="../articles/tutorial_empirical_likelihood.html">Empirical Likelihood Estimator for NMAR</a>
    </li>
    <li>
      <a href="../articles/tutorial_exptilt.html">tutorial_exptilt</a>
    </li>
    <li>
      <a href="../articles/tutorial_exptilt_nonparam.html">tutorial_exptilt_nonparam</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Empirical likelihood (EL) engine for NMAR</h1>

    <div class="hidden name"><code>el_engine.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Constructs a configuration for the empirical likelihood estimator under
nonignorable nonresponse (NMAR), following Qin, Leung and Shao (2002).
Pass the returned object to `nmar()` together with a formula and data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">el_engine</span><span class="op">(</span></span>
<span>  standardize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  trim_cap <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  on_failure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"return"</span>, <span class="st">"error"</span><span class="op">)</span>,</span>
<span>  variance_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"delta"</span>, <span class="st">"bootstrap"</span><span class="op">)</span>,</span>
<span>  variance_jacobian <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"analytic"</span>, <span class="st">"numeric"</span><span class="op">)</span>,</span>
<span>  solver_jacobian <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"analytic"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  variance_pseudoinverse <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  variance_ridge <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  bootstrap_reps <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  suppress_warnings <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  auxiliary_means <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logit"</span>, <span class="st">"probit"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-standardize">standardize<a class="anchor" aria-label="anchor" href="#arg-standardize"></a></dt>
<dd><p>Logical; standardize predictors. Default TRUE.</p></dd>


<dt id="arg-trim-cap">trim_cap<a class="anchor" aria-label="anchor" href="#arg-trim-cap"></a></dt>
<dd><p>Numeric; cap for EL weights (Inf = no trimming).</p></dd>


<dt id="arg-on-failure">on_failure<a class="anchor" aria-label="anchor" href="#arg-on-failure"></a></dt>
<dd><p>Character; "return" or "error" on solver failure.</p></dd>


<dt id="arg-variance-method">variance_method<a class="anchor" aria-label="anchor" href="#arg-variance-method"></a></dt>
<dd><p>Character; "delta" or "bootstrap".</p></dd>


<dt id="arg-variance-jacobian">variance_jacobian<a class="anchor" aria-label="anchor" href="#arg-variance-jacobian"></a></dt>
<dd><p>Character; "auto", "analytic", or "numeric".</p></dd>


<dt id="arg-solver-jacobian">solver_jacobian<a class="anchor" aria-label="anchor" href="#arg-solver-jacobian"></a></dt>
<dd><p>Character; "auto", "analytic", or "none".</p></dd>


<dt id="arg-variance-pseudoinverse">variance_pseudoinverse<a class="anchor" aria-label="anchor" href="#arg-variance-pseudoinverse"></a></dt>
<dd><p>Logical; allow pseudo-inverse for variance.</p></dd>


<dt id="arg-variance-ridge">variance_ridge<a class="anchor" aria-label="anchor" href="#arg-variance-ridge"></a></dt>
<dd><p>Logical or numeric; if TRUE, apply adaptive ridge to
stabilize Jacobian inversion; if numeric, treated as ridge epsilon.</p></dd>


<dt id="arg-bootstrap-reps">bootstrap_reps<a class="anchor" aria-label="anchor" href="#arg-bootstrap-reps"></a></dt>
<dd><p>Integer; reps when variance_method = "bootstrap".</p></dd>


<dt id="arg-suppress-warnings">suppress_warnings<a class="anchor" aria-label="anchor" href="#arg-suppress-warnings"></a></dt>
<dd><p>Logical; suppress variance method warnings.</p></dd>


<dt id="arg-auxiliary-means">auxiliary_means<a class="anchor" aria-label="anchor" href="#arg-auxiliary-means"></a></dt>
<dd><p>Named numeric vector; population means for auxiliaries
(names must match RHS of outcome formula). Optional.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>List; optional solver control (passed through).</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>Response model family; a string ("logit" or "probit") or a
family object created by `logit_family()` / `probit_family()`.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An engine object of class `c('nmar_engine_el','nmar_engine')`.
  This is a configuration list; it is not a fit. Pass it to `nmar()`.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The EL estimator uses weights that satisfy estimating equations for the
response mechanism and optional auxiliary moment constraints. The response
model score is the derivative of the Bernoulli log‑likelihood with respect
to the linear predictor, i.e. `mu.eta(eta)/linkinv(eta)`, valid for both
logit and probit links. Response predictors do not need to coincide with
auxiliary predictors; only auxiliaries require known population moments.
See the theory note and Qin, Leung and Shao (2002) for derivations.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Qin, J., Leung, D., and Shao, J. (2002). Estimation with survey data under
nonignorable nonresponse or informative sampling. Journal of the American
Statistical Association, 97(457), 193–200.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>`nmar()`, `el()`, `el.data.frame()`, `el.survey.design()`</p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Maciej Beręsewicz.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

