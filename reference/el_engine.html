<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Empirical likelihood (EL) engine for NMAR — el_engine • NMAR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Empirical likelihood (EL) engine for NMAR — el_engine"><meta name="description" content="Constructs a configuration for the empirical likelihood estimator under
nonignorable nonresponse (NMAR), following Qin, Leung and Shao (2002).
Pass the returned object to `nmar()` together with a formula and data."><meta property="og:description" content="Constructs a configuration for the empirical likelihood estimator under
nonignorable nonresponse (NMAR), following Qin, Leung and Shao (2002).
Pass the returned object to `nmar()` together with a formula and data."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">NMAR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/tutorial_empirical_likelihood.html">Empirical Likelihood</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial_exptilt.html">Exponential Tilting</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial_exptilt_nonparam.html">Exponential Tilting (Nonparametric)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ncn-foreigners/NMAR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Empirical likelihood (EL) engine for NMAR</h1>
      <small class="dont-index">Source: <a href="https://github.com/ncn-foreigners/NMAR/blob/package-dev/R/engines_el_engine.R" class="external-link"><code>R/engines_el_engine.R</code></a></small>
      <div class="d-none name"><code>el_engine.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Constructs a configuration for the empirical likelihood estimator under
nonignorable nonresponse (NMAR), following Qin, Leung and Shao (2002).
Pass the returned object to `nmar()` together with a formula and data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">el_engine</span><span class="op">(</span></span>
<span>  standardize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  trim_cap <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  on_failure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"return"</span>, <span class="st">"error"</span><span class="op">)</span>,</span>
<span>  variance_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"delta"</span>, <span class="st">"bootstrap"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  variance_jacobian <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"analytic"</span>, <span class="st">"numeric"</span><span class="op">)</span>,</span>
<span>  solver_jacobian <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"analytic"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  solver_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"newton"</span>, <span class="st">"broyden"</span><span class="op">)</span>,</span>
<span>  solver_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  variance_pseudoinverse <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  variance_ridge <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  bootstrap_reps <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  suppress_warnings <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  auxiliary_means <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logit"</span>, <span class="st">"probit"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-standardize">standardize<a class="anchor" aria-label="anchor" href="#arg-standardize"></a></dt>
<dd><p>Logical; standardize predictors. Default TRUE.</p></dd>


<dt id="arg-trim-cap">trim_cap<a class="anchor" aria-label="anchor" href="#arg-trim-cap"></a></dt>
<dd><p>Numeric; cap for EL weights (Inf = no trimming).</p></dd>


<dt id="arg-on-failure">on_failure<a class="anchor" aria-label="anchor" href="#arg-on-failure"></a></dt>
<dd><p>Character; "return" or "error" on solver failure.</p></dd>


<dt id="arg-variance-method">variance_method<a class="anchor" aria-label="anchor" href="#arg-variance-method"></a></dt>
<dd><p>Character; one of "delta", "bootstrap", or "none".</p></dd>


<dt id="arg-variance-jacobian">variance_jacobian<a class="anchor" aria-label="anchor" href="#arg-variance-jacobian"></a></dt>
<dd><p>Character; "auto", "analytic", or "numeric".</p></dd>


<dt id="arg-solver-jacobian">solver_jacobian<a class="anchor" aria-label="anchor" href="#arg-solver-jacobian"></a></dt>
<dd><p>Character; "auto", "analytic", or "none".</p></dd>


<dt id="arg-solver-method">solver_method<a class="anchor" aria-label="anchor" href="#arg-solver-method"></a></dt>
<dd><p>Character; policy for the root solver:
- "auto" (default): Newton with analytic Jacobian, perturbation restarts, then Broyden fallback.
- "newton": Newton only (no Broyden fallback).
- "broyden": Broyden only (secant updates, no analytic Jacobian).</p></dd>


<dt id="arg-solver-args">solver_args<a class="anchor" aria-label="anchor" href="#arg-solver-args"></a></dt>
<dd><p>List; optional top‑level `nleqslv` arguments such as
`global` (e.g., "dbldog", "qline") and `xscalm` (e.g., "auto", "fixed").
These are passed at the top level of the `nleqslv` call and take precedence
over similarly named entries provided in `control`.</p></dd>


<dt id="arg-variance-pseudoinverse">variance_pseudoinverse<a class="anchor" aria-label="anchor" href="#arg-variance-pseudoinverse"></a></dt>
<dd><p>Logical; allow pseudo-inverse for variance.</p></dd>


<dt id="arg-variance-ridge">variance_ridge<a class="anchor" aria-label="anchor" href="#arg-variance-ridge"></a></dt>
<dd><p>Logical or numeric; if TRUE, apply adaptive ridge to
stabilize Jacobian inversion; if numeric, treated as ridge epsilon.</p></dd>


<dt id="arg-bootstrap-reps">bootstrap_reps<a class="anchor" aria-label="anchor" href="#arg-bootstrap-reps"></a></dt>
<dd><p>Integer; reps when variance_method = "bootstrap".</p></dd>


<dt id="arg-suppress-warnings">suppress_warnings<a class="anchor" aria-label="anchor" href="#arg-suppress-warnings"></a></dt>
<dd><p>Logical; suppress variance method warnings.</p></dd>


<dt id="arg-auxiliary-means">auxiliary_means<a class="anchor" aria-label="anchor" href="#arg-auxiliary-means"></a></dt>
<dd><p>Named numeric vector; population means for auxiliaries
(names must match RHS of outcome formula). Optional.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>List; optional solver control for `nleqslv::nleqslv(control=...)`.
Recognized fields include `xtol`, `ftol`, `btol`, `maxit`, `trace`, `stepmax`,
and `delta`.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>Response model family; a string ("logit" or "probit") or a
family object created by `logit_family()` / `probit_family()`.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An engine object of class `c('nmar_engine_el','nmar_engine')`.
  This is a configuration list; it is not a fit. Pass it to `nmar()`.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The EL estimator uses weights that satisfy estimating equations for the
response mechanism and optional auxiliary moment constraints. The response
model score is the derivative of the Bernoulli log‑likelihood with respect
to the linear predictor, i.e. `mu.eta(eta)/linkinv(eta)`, valid for both
logit and probit links. Response predictors do not need to coincide with
auxiliary predictors; only auxiliaries require known population moments.
See the theory note and Qin, Leung and Shao (2002) for derivations.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Qin, J., Leung, D., and Shao, J. (2002). Estimation with survey data under
nonignorable nonresponse or informative sampling. Journal of the American
Statistical Association, 97(457), 193–200.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>`nmar()`; see the vignette "Empirical Likelihood Theory for NMAR" for derivations.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>; <span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">X</span> <span class="op">+</span> <span class="va">Z</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.7</span> <span class="op">+</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">p</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Y_miss <span class="op">=</span> <span class="va">Y</span>, X <span class="op">=</span> <span class="va">X</span><span class="op">)</span>; <span class="va">df</span><span class="op">$</span><span class="va">Y_miss</span><span class="op">[</span><span class="op">!</span><span class="va">R</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA_real_</span></span></span>
<span class="r-in"><span><span class="va">eng</span> <span class="op">&lt;-</span> <span class="fu">el_engine</span><span class="op">(</span>auxiliary_means <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, variance_method <span class="op">=</span> <span class="st">"delta"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="nmar.html">nmar</a></span><span class="op">(</span><span class="va">Y_miss</span> <span class="op">~</span> <span class="va">X</span>, data <span class="op">=</span> <span class="va">df</span>, engine <span class="op">=</span> <span class="va">eng</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NMAR Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> =================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y_miss estimate: 3.090401</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Std. Error: 0.281894</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95% CI: (2.537898, 3.642903)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Converged: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variance method: delta </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variance notes: Calculation successful </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total units: 200 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Respondents: 76 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: nmar(Y_miss ~ X, data = &lt;data.frame: N=200&gt;, engine = empirical_likelihood)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response-model coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error   z value     Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  3.250571  0.4834881  6.723167 1.778169e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y_miss      -1.239524  0.4592639 -2.698936 6.956151e-03</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maciej Beręsewicz, Igor Kołodziej, Mateusz Iwaniuk.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

