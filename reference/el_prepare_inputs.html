<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Prepare EL inputs for IID and survey designs — el_prepare_inputs • NMAR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prepare EL inputs for IID and survey designs — el_prepare_inputs"><meta name="description" content="Parses the two-part Formula, constructs EL design matrices, injects the
respondent delta indicator, attaches weights and (optionally) survey metadata,
and returns the pieces needed by the EL core. The outcome enters the
missingness design only through the evaluated LHS expression; any explicit
use of the outcome variable on RHS2 is rejected."><meta property="og:description" content="Parses the two-part Formula, constructs EL design matrices, injects the
respondent delta indicator, attaches weights and (optionally) survey metadata,
and returns the pieces needed by the EL core. The outcome enters the
missingness design only through the evaluated LHS expression; any explicit
use of the outcome variable on RHS2 is rejected."><meta property="og:image" content="https://ncn-foreigners.ue.poznan.pl/NMAR/index.html/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">NMAR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/tutorial_empirical_likelihood.html">Empirical Likelihood</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial_exptilt.html">Exponential Tilting</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial_exptilt_nonparam.html">Exponential Tilting (Nonparametric)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Theory</h6></li>
    <li><a class="dropdown-item" href="../articles/el_empirical_likelihood_theory.html">Empirical Likelihood Theory for NMAR</a></li>
    <li><a class="dropdown-item" href="../articles/exptilt_theory.html">Exponential Tilting Theory</a></li>
    <li><a class="dropdown-item" href="../articles/exptilt_nonparam_theory.html">Nonparametric Exponential Tilting Theory</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ncn-foreigners/NMAR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Prepare EL inputs for IID and survey designs</h1>
      <small class="dont-index">Source: <a href="https://github.com/ncn-foreigners/NMAR/blob/package-dev/R/engines_el_impl_input.R" class="external-link"><code>R/engines_el_impl_input.R</code></a></small>
      <div class="d-none name"><code>el_prepare_inputs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Parses the two-part Formula, constructs EL design matrices, injects the
respondent delta indicator, attaches weights and (optionally) survey metadata,
and returns the pieces needed by the EL core. The outcome enters the
missingness design only through the evaluated LHS expression; any explicit
use of the outcome variable on RHS2 is rejected.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">el_prepare_inputs</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_total <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  design_object <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Invariants enforced here (relied on by all downstream EL code):</p><ul><li><p>LHS references exactly one outcome source variable in <code>data</code>; any
    transforms are applied via the formula environment and must be defined
    for all respondent rows.</p></li>
<li><p>The outcome is never allowed to appear on RHS1 (auxiliaries) or RHS2
    (missingness predictors), either explicitly in the formula or implicitly
    via dot (<code>.</code>) expansion. The missingness model uses the evaluated LHS
    expression as a dedicated predictor column instead.</p></li>
<li><p>RHS1 always yields an intercept-free auxiliary design matrix with
    k-1 coding for factor auxiliaries, regardless of user <code>+0</code>/<code>-1</code> syntax or
    custom contrasts. Auxiliary columns are validated to be fully observed
    and non-constant among respondents.</p></li>
<li><p>RHS2 always yields a missingness-design matrix for respondents that
    includes an intercept column and zero-variance predictors only emit
    warnings (not errors); NA among respondents is rejected.</p></li>
<li><p><code>respondent_mask</code> is defined from the raw outcome in <code>data</code>, not from
    the transformed LHS; an injected <code>..nmar_delta..</code> indicator in
    <code>analysis_data</code> matches this mask exactly.</p></li>
<li><p><code>N_pop</code> is the analysis-scale population size used in the EL system:
    for IID it is <code>nrow(data)</code> unless overridden by <code>n_total</code>; for survey
    designs it is <code>sum(weights)</code> or <code>n_total</code> when supplied.</p></li>
</ul></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maciej Beresewicz, Igor Kołodziej, Mateusz Iwaniuk.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

