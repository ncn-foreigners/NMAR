[{"path":"https://ncn-foreigners.github.io/NMAR/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 nmar authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (â€œSoftwareâ€), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED â€œâ€, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/developing_new_nmar_estimator.html","id":"developing-a-new-nmar-estimator-in-the-nmar-package","dir":"Articles","previous_headings":"","what":"Developing a New NMAR Estimator in the nmar Package","title":"Developing a New NMAR Estimator","text":"guide explains add integrate new â€‘Missingâ€‘â€‘Random (NMAR) statistical estimator nmar, following architecture used Empirical Likelihood (EL) engine, emphasizing clean separation concerns: Shared, reusable utilities live src_dev/shared/ (scaling, families, bootstrap, numerics, diagnostics). Estimatorâ€‘specific math code live src_dev/engines/<method>/. Repository conventions - Always edit source src_dev/; flat files R/ generated running Rscript build_r_folder.R. - changing src_dev/, regenerate roxygen outputs R -q -e \"devtools::document()\" confirm git status clean; keeps S3 registrations Rd files sync. - Use testthat v3 tests/testthat/ tests run R -q -e \"devtools::test()\" opening PR. - Use roxygen2 documentation; edit NAMESPACE directly.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/developing_new_nmar_estimator.html","id":"general-guidelines","dir":"Articles","previous_headings":"Developing a New NMAR Estimator in the nmar Package","what":"0) General guidelines","title":"Developing a New NMAR Estimator","text":"Adhere functional programming style design patterns (writing pure functions, function factories, functionals, function operators) appropriate (eg. building systems equations) use unpredictable functions like sapply, use vapply purrr equivalents instead Avoid code duplication, reuse shared infrastructure much possible Develop loosely coupled, modular architecture, identify shareable, method-agnostic functionalities Use S3 OOP system Use constructor validator functions S3 objects Follow best software engineering practices, including SOLID, DRY, KISS, YAGNI, Separation Concerns, Principle Least Astonishment, Law Demeter?","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/developing_new_nmar_estimator.html","id":"overview-of-the-package-flow","dir":"Articles","previous_headings":"Developing a New NMAR Estimator in the nmar Package","what":"1) Overview of the package flow","title":"Developing a New NMAR Estimator","text":"User workflow: User creates engine configuration (e.g., el_engine(...)). User calls nmar(formula = ..., data = ..., engine = <engine>). nmar() creates nmar_input_spec via parse_nmar_spec(), validates validate_nmar_args() (using engine-specific traits), dispatches run_engine(engine, task) S3. *.data.frame(...) IID data *.survey.design(...) complex surveys method computes estimator returns result object class c(\"nmar_result_<method>\", \"nmar_result\") containing primary estimand supporting data S3 methods.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/developing_new_nmar_estimator.html","id":"what-to-implement-for-a-new-estimator","dir":"Articles","previous_headings":"Developing a New NMAR Estimator in the nmar Package","what":"2) What to implement for a new estimator","title":"Developing a New NMAR Estimator","text":"Assume engine named <method> (e.g., exptilt2, abc, etc.). Create following files src_dev/engines/<method>/:","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/developing_new_nmar_estimator.html","id":"engine-r-engine-constructor","dir":"Articles","previous_headings":"Developing a New NMAR Estimator in the nmar Package > 2) What to implement for a new estimator","what":"1) engine.R â€” engine constructor","title":"Developing a New NMAR Estimator","text":"Important: add @keywords engine roxygen ### 2) run_engine.R â€” run_engine method engine rely shared validation/traits infrastructure:","code":"method_engine <- function(...) { # Validate controls using validate_arguments.R as in exptilt.   validator$assert_choice(family, choices = c(\"logit\", \"probit\"), name = \"family\")    engine <- list(...)   class(engine) <- c(\"nmar_engine_method\", \"nmar_engine\")   engine } run_engine.nmar_engine_method <- function(engine, task) {   design <- prepare_nmar_design(     task,     standardize = engine$standardize,     auxiliary_means = engine$auxiliary_means,     include_response = TRUE,     include_auxiliary = TRUE   )    args <- c(     list(       data = design$survey_design %||% design$data,       formula = task$formula,       response_predictors = if (length(design$response_predictors)) design$response_predictors else NULL,       auxiliary_means = design$auxiliary_means,       standardize = design$standardize     ),     as.list(engine)   )    method_fn <- get(\"method\", mode = \"function\")   fit <- do.call(method_fn, args)   if (!inherits(fit, \"nmar_result_method\")) stop(\"Expected nmar_result_method.\")   fit } engine_traits.nmar_engine_method <- function(engine) {   utils::modifyList(     engine_traits.default(engine),     list(       allow_outcome_in_missingness = TRUE,      # customise as needed       allow_covariate_overlap = FALSE,       requires_single_outcome = TRUE     )   ) }"},{"path":"https://ncn-foreigners.github.io/NMAR/articles/developing_new_nmar_estimator.html","id":"implmethod-r-define-the-generic","dir":"Articles","previous_headings":"Developing a New NMAR Estimator in the nmar Package > 2) What to implement for a new estimator","what":"3) impl/<method>.R â€” define the generic","title":"Developing a New NMAR Estimator","text":"","code":"#' @param data A data.frame or survey.design. #' @export method <- function(data, ...) UseMethod(\"method\")"},{"path":"https://ncn-foreigners.github.io/NMAR/articles/developing_new_nmar_estimator.html","id":"implmethod_dataframe-r-method-for-iid-data","dir":"Articles","previous_headings":"Developing a New NMAR Estimator in the nmar Package > 2) What to implement for a new estimator","what":"4) impl/<method>_dataframe.R â€” method for IID data","title":"Developing a New NMAR Estimator","text":"","code":"#' @export method.data.frame <- function(data, formula, controls = list(), ...) { # Prepare inputs. You may adapt from ELâ€™s prepare_el_inputs() pattern.   parsed <- build_method_inputs(data, formula, controls)   estimation_data <- parsed$data   internal_formula <- parsed$formula_list  # Identify respondents   response_var <- all.vars(internal_formula$response)[1]   obs_idx <- which(estimation_data[[response_var]] == 1)  # Build design matrices   Z_un <- model.matrix(update(internal_formula$response, NULL ~ .), data = estimation_data[obs_idx, ])   X_un <- build_method_auxiliary_matrix(estimation_data[obs_idx, ])   mu_x <- controls$auxiliary_means  # Shared scaling   sc <- validate_and_apply_nmar_scaling(     standardize = TRUE, has_aux = !is.null(X_un),     response_model_matrix_unscaled = Z_un,     auxiliary_matrix_unscaled = if (is.null(X_un)) matrix(nrow = nrow(Z_un), ncol = 0) else X_un,     mu_x_unscaled = mu_x   )  # Solve on the scaled space (method-specific code)   fit <- method_solve_core(     full_data = estimation_data,     respondent_data = estimation_data[obs_idx, ],     response_model_matrix_scaled = sc$response_model_matrix_scaled,     auxiliary_matrix_scaled = sc$auxiliary_matrix_scaled,     mu_x_scaled = sc$mu_x_scaled,     controls = controls,     ...   )  # Wrap into a standard result object (see Section 5)   new_nmar_result_method(     estimate = fit$estimate,     std_error = fit$std_error,     coefficients = fit$model$coefficients,     vcov = fit$model$vcov,     diagnostics = fit$diagnostics   ) }"},{"path":"https://ncn-foreigners.github.io/NMAR/articles/developing_new_nmar_estimator.html","id":"implmethod_survey-r-method-for-survey-design","dir":"Articles","previous_headings":"Developing a New NMAR Estimator in the nmar Package > 2) What to implement for a new estimator","what":"5) impl/<method>_survey.R â€” method for survey.design","title":"Developing a New NMAR Estimator","text":"Follow ELâ€™s el.survey.design pattern: Subset respondents via observed_mask. Get respondent base weights via weights(resp_design) set N_pop <- sum(weights(design)). Compute covariance â€œtotal scoresâ€ delta variance using svytotal(~ scores, design) followed vcov(). See Variance subsection .","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/developing_new_nmar_estimator.html","id":"implmethod_equations-r-implmethod_jacobian-r-optional","dir":"Articles","previous_headings":"Developing a New NMAR Estimator in the nmar Package > 2) What to implement for a new estimator","what":"6) impl/<method>_equations.R / impl/<method>_jacobian.R (optional)","title":"Developing a New NMAR Estimator","text":"estimator uses system estimating equations analytic Jacobian (like EL), define document . Otherwise, keep methodâ€‘specific math (e.g., likelihood, gradients, constraints).","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/developing_new_nmar_estimator.html","id":"implmethod_variance-r","dir":"Articles","previous_headings":"Developing a New NMAR Estimator in the nmar Package > 2) What to implement for a new estimator","what":"7) impl/<method>_variance.R","title":"Developing a New NMAR Estimator","text":"Jacobian inversion policy: invert_jacobian() (ridge/pinv options). IID B: crossâ€‘product respondent score rows â€œexpandedâ€ N (zeros nonrespondents). Survey B: covariance design totals via svytotal. Add option use shared bootstrap variance helpers (bootstrap_variance()) IID survey designs.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/developing_new_nmar_estimator.html","id":"implmethod_constructors-r","dir":"Articles","previous_headings":"Developing a New NMAR Estimator in the nmar Package > 2) What to implement for a new estimator","what":"8) impl/<method>_constructors.R","title":"Developing a New NMAR Estimator","text":"Call new_nmar_result() inside constructor object carries class c(\"nmar_result_<method>\", \"nmar_result\") shares standard layout: Scalar fields: estimate, estimate_name, std_error, converged. Lists: model (coefficients/vcov), weights_info, sample, inference, diagnostics, meta, extra. Populate components directly; add extra top-level aliases y_hat data_info. Call validate_nmar_result() returning ensure structure complete. Minimal constructor example (inside src_dev/engines/<method>/impl/constructors.R):","code":"#' @keywords internal new_nmar_result_method <- function(estimate, std_error,                                    coefficients = NULL, vcov = NULL,                                    weights = NULL, sample = list(),                                    inference = list(variance_method = NA_character_,                                                     df = NA_real_,                                                     message = NA_character_,                                                     used_pseudoinverse = FALSE,                                                     used_ridge = FALSE),                                    diagnostics = list(),                                    meta = list(engine_name = \"method\", call = NULL, formula = NULL),                                    extra = list()) {   sample_defaults <- list(n_total = NA_integer_, n_respondents = NA_integer_,                           is_survey = FALSE, design = NULL, outcome_var = NA_character_)   sample <- utils::modifyList(sample_defaults, sample)   result <- new_nmar_result(     estimate = estimate,     estimate_name = sample$outcome_var,     std_error = std_error,     converged = TRUE,     model = list(coefficients = coefficients, vcov = vcov),     weights_info = list(values = weights, trimmed_fraction = NA_real_),     sample = list(n_total = sample$n_total,                   n_respondents = sample$n_respondents,                   is_survey = sample$is_survey,                   design = sample$design),     inference = inference,     diagnostics = diagnostics,     meta = meta,     extra = extra,     class = \"nmar_result_method\"   )   validate_nmar_result(result, \"nmar_result_method\") }"},{"path":"https://ncn-foreigners.github.io/NMAR/articles/developing_new_nmar_estimator.html","id":"s3-r-s3-methods-for-your-result-class","dir":"Articles","previous_headings":"Developing a New NMAR Estimator in the nmar Package > 2) What to implement for a new estimator","what":"9) s3.R â€” S3 methods for your result class","title":"Developing a New NMAR Estimator","text":"Implement (rely parent defaults): print.nmar_result_<method>(), summary.nmar_result_<method>() (optional). overriding, call NextMethod() first reuse parent output append estimator-specific details. estimate(), vcov(), confint(), tidy(), glance(): work box long populate shared schema. Optional accessors: weights(), fitted(), coef(), etc., engine exposes .","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/developing_new_nmar_estimator.html","id":"reusing-shared-infrastructure","dir":"Articles","previous_headings":"Developing a New NMAR Estimator in the nmar Package","what":"3) Reusing shared infrastructure","title":"Developing a New NMAR Estimator","text":"Use shared modules src_dev/shared/:","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/developing_new_nmar_estimator.html","id":"scaling","dir":"Articles","previous_headings":"Developing a New NMAR Estimator in the nmar Package > 3) Reusing shared infrastructure","what":"Scaling","title":"Developing a New NMAR Estimator","text":"validate_and_apply_nmar_scaling() standardize Z/X auxiliary means solving, returning nmar_scaling_recipe unscaling. unscale_coefficients() map scaled coefficients vcov back original scale reporting. Intercept never scaled; constant columns get sd=1. Engines may create recipe respondentsâ€‘matrices (EL) full/design matrices.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/developing_new_nmar_estimator.html","id":"families-response-model","dir":"Articles","previous_headings":"Developing a New NMAR Estimator in the nmar Package > 3) Reusing shared infrastructure","what":"Families (response model)","title":"Developing a New NMAR Estimator","text":"logit_family() / probit_family() expose linkinv, mu.eta, d2mu.deta2, score_eta linkâ€‘agnostic estimating equations Jacobians. Probit uses tailâ€‘stable logâ€‘ratio phi/Phi.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/developing_new_nmar_estimator.html","id":"bootstrap-variance","dir":"Articles","previous_headings":"Developing a New NMAR Estimator in the nmar Package > 3) Reusing shared infrastructure","what":"Bootstrap variance","title":"Developing a New NMAR Estimator","text":"bootstrap_variance() S3 generic methods data.frame survey.design. IID: resample rows rerun estimator. Survey: convert bootstrap replicate weights (svrep::as_bootstrap_design), use survey::withReplicates, survey::svrVar.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/developing_new_nmar_estimator.html","id":"engine-boundaries-and-naming","dir":"Articles","previous_headings":"Developing a New NMAR Estimator in the nmar Package > 3) Reusing shared infrastructure","what":"4) Engine boundaries and naming","title":"Developing a New NMAR Estimator","text":"call helpers enginesâ€™ impl/ folders. Engines must depend src_dev/shared/ src_dev/engines/<method>/impl/. Prefix engineâ€‘specific helpers <method>_ (e.g., el_... empirical likelihood) signal ownership avoid accidental reuse. parent S3 class nmar_result provides default methods (estimate, vcov, confint, tidy, glance, plot/autoplot, coef, fitted, weights, formula). Implement child print/summary need extra presentation.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"units","dir":"Articles","previous_headings":"Notation","what":"Units","title":"Empirical Likelihood Theory","text":"=1,â€¦,ni = 1, \\ldots, n index respondents (observed YY) Riâˆˆ{0,1}R_i \\\\{0, 1\\} response indicator; work observed subset Ri=1R_i = 1","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"data","dir":"Articles","previous_headings":"Notation","what":"Data","title":"Empirical Likelihood Theory","text":"Outcome: YiY_i (observed Ri=1R_i = 1; missing otherwise) Response covariates: row vector Ziâˆˆâ„KZ_i \\\\mathbb{R}^K, model.matrix response RHS Auxiliary covariates: row vector Xiâˆˆâ„LX_i \\\\mathbb{R}^L (possibly L=0L = 0), auxiliary RHS (intercept) Population auxiliary means: Î¼xâˆˆâ„L\\mu_x \\\\mathbb{R}^L, known; names match columns XX","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"response-model-family-functions","dir":"Articles","previous_headings":"Notation","what":"Response Model (Family functions)","title":"Empirical Likelihood Theory","text":"Linear predictor: Î·i=ZiÎ²\\eta_i = Z_i \\, \\beta Response probability: wiâ‰¡g(Î·i)=linkinv(Î·i)w_i \\equiv g(\\eta_i) = \\mathrm{linkinv}(\\eta_i) First derivative: dwdÎ·(Î·i)=Î¼Î·,=mu.eta(Î·i)\\dfrac{dw}{d\\eta}(\\eta_i) = \\mu_{\\eta,} = \\mathrm{mu.eta}(\\eta_i) Second derivative: d2wdÎ·2(Î·i)=d2mu.deta2(Î·i)\\dfrac{d^2 w}{d\\eta^2}(\\eta_i) = \\mathrm{d2mu.deta2}(\\eta_i) linkinv, mu.eta, d2mu.deta2 refer chosen response family (logit probit). follow paperâ€™s wiw_i notation response probability reserve piELp_i^{\\text{EL}} empiricalâ€‘likelihood weights.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"weight-re-parameterization","dir":"Articles","previous_headings":"Notation","what":"Weight Re-parameterization","title":"Empirical Likelihood Theory","text":"Wâˆˆ(0,1)W \\(0,1) nuisance scalar; parameterize via z=logit(W)z = \\text{logit}(W) stability set W=plogis(z)W = \\text{plogis}(z) Î»Wâˆˆâ„\\lambda_W \\\\mathbb{R} Î»xâˆˆâ„L\\lambda_x \\\\mathbb{R}^L EL Lagrange multipliers constraints; collected together Î¸\\theta","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"el-weights","dir":"Articles","previous_headings":"Notation","what":"EL Weights","title":"Empirical Likelihood Theory","text":"Denominator: Di=1+Î»W(wiâˆ’W)+(Xiâˆ’Î¼x)TÎ»xD_i = 1 + \\lambda_W (w_i - W) + (X_i - \\mu_x)^T \\lambda_x Base sampling weights: ai=1a_i = 1 (IID) ai=a_i = survey base weight respondent ii EL weights respondents: piELâˆai/Dip_i^{\\text{EL}} \\propto a_i / D_i (proportionality normalized totals )","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"estimator","dir":"Articles","previous_headings":"Notation","what":"Estimator","title":"Empirical Likelihood Theory","text":"YÌ‚=âˆ‘piELYi/âˆ‘piEL\\hat{Y} = \\sum p_i^{\\text{EL}} Y_i / \\sum p_i^{\\text{EL}}","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"engines","dir":"Articles","previous_headings":"Notation","what":"Engines","title":"Empirical Likelihood Theory","text":"Family: â€œlogitâ€ (default) â€œprobitâ€; use logâ€‘likelihood score w.r.t. Î·\\eta: si=âˆ‚logwi/âˆ‚Î·i=Î¼Î·,/wis_i = \\partial\\log w_i/\\partial\\eta_i = \\mu_{\\eta,}/w_i (respondents, Î´i=1\\delta_i=1) Scaling: optional standardization design matrices Î¼x\\mu_x via nmar_scaling_recipe","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"from-paper-to-implementation-core-ideas","dir":"Articles","previous_headings":"","what":"From Paper to Implementation: Core Ideas","title":"Empirical Likelihood Theory","text":"paper (Qinâ€“Leungâ€“Shao, JASA 2002) sets EL nonignorable response using: Zeroâ€‘sum residual: âˆ‘piEL(wiâˆ’W)=0\\sum p_i^{\\text{EL}} (w_i - W) = 0 Auxiliary moments: âˆ‘piEL(Xiâˆ’Î¼x)=0\\sum p_i^{\\text{EL}} (X_i - \\mu_x) = 0 response model probability wi=g(Î·i)w_i = g(\\eta_i), Î·i=ZiÎ²\\eta_i = Z_i \\, \\beta code, adopt EL structure estimating equations. extend arbitrary ZZ XX, survey designs via design-based covariance variance estimation. YÌ‚\\hat Y ratio--weights estimator, common normalization piELâˆai/Dip_i^{\\text{EL}} \\propto a_i/D_i cancels YÌ‚\\hat Y; relative weights matter (KKT multipliers Î»\\lambda enforce constraints; normalization affects common scale vanishes ratio).","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"equation-crosswalk-qls-2002-this-vignettecode","dir":"Articles","previous_headings":"From Paper to Implementation: Core Ideas","what":"Equation Crosswalk (QLS 2002 â†’ This Vignette/Code)","title":"Empirical Likelihood Theory","text":"QLS (5): Discrete mass form pip_i two multipliers â†’ Di=1+Î»W(wiâˆ’W)+(Xiâˆ’Î¼x)TÎ»xD_i = 1 + \\lambda_W (w_i - W) + (X_i - \\mu_x)^T \\lambda_x piELâˆai/Dip_i^{\\text{EL}} \\propto a_i/D_i. QLS (7): âˆ‘xiâˆ’xâ€¾1+â‹¯=0\\sum \\dfrac{x_i - \\bar x}{1 + \\cdots} = 0 â†’ auxiliary constraints âˆ‘ai(Xiâˆ’Î¼x)/Di=0\\sum a_i (X_i - \\mu_x)/D_i = 0. QLS (8): âˆ‘wiâˆ’W1+â‹¯=0\\sum \\dfrac{w_i - W}{1 + \\cdots} = 0 â†’ WW-equation âˆ‘ai(wiâˆ’W)/Di=0\\sum a_i (w_i - W)/D_i = 0. QLS (10): Î»Ì‚2=(N/nâˆ’1)/(1âˆ’W)\\hat{\\lambda}_2 = (N/n - 1)/(1 - W) â†’ Î»W=((Npop/nresp_weighted)âˆ’1)/(1âˆ’W)\\lambda_W = ((N_{\\text{pop}}/n_{\\text{resp\\_weighted}}) - 1)/(1 - W) (design-weighted generalization). Estimator YÌ‚\\hat Y QLS â†’ ratio YÌ‚=âˆ‘piELYi/âˆ‘piEL\\hat Y = \\sum p_i^{\\mathrm{EL}} Y_i/\\sum p_i^{\\mathrm{EL}} using piELâˆai/Dip_i^{\\mathrm{EL}} \\propto a_i/D_i. Note predictors: response model predictors ZZ (missingness mechanism) auxiliary predictors XX (moment constraints) need coincide. may include response-predictors part auxiliary set; variables XX require known population moments Î¼x\\mu_x.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"semiparametric-likelihood-qls-eq--2","dir":"Articles","previous_headings":"","what":"Semiparametric Likelihood (QLS Eq. 2)","title":"Empirical Likelihood Theory","text":"paperâ€™s semiparametric likelihood (Eq. (2)) combines response mechanism wi=g(Î·i)w_i = g(\\eta_i) nonparametric distribution FF (Y,X)(Y,X): L(Î²,W,F)=âˆ=1n[w(yi,xi;Î²)dF(yi,xi)]Wn(1âˆ’W)Nâˆ’n, L(\\beta, W, F) \\;=\\; \\prod_{=1}^{n} \\Big[\\, w( y_i, x_i; \\beta )\\, dF(y_i, x_i)\\,\\Big]\\; W^{n} (1-W)^{N-n}, nn number respondents (Ri=1R_i=1), NN population size, W=âˆ¬w(y,x;Î²)dF(y,x) W \\;=\\; \\iint w(y,x;\\beta)\\, dF(y,x) unconditional response rate model. first product contribution fully observed respondents; binomial factor Wn(1âˆ’W)Nâˆ’nW^n(1-W)^{N-n} likelihood response indicators, marginalizing (Y,X)(Y,X) via FF. parametric form assumed FF. make inference without fully parameterizing FF, QLS discretize FF observed points treat masses unknown parameters, estimated subject moment constraints. yields empirical-likelihood solution. Remark conditioning: QLSâ€™s Eq. (2) writes first product âˆ[w(yi,xi;Î²)dF(yi,xi)/W]\\prod_i [\\, w(y_i,x_i;\\beta)\\,dF(y_i,x_i)/W\\,] explicitly represents likelihood (Yi,Xi)(Y_i,X_i) conditional Ri=1R_i=1. Multiplying binomial term Wn(1âˆ’W)Nâˆ’nW^n(1-W)^{N-n} yields overall likelihood Wâˆ’nW^{-n} first factor cancels WnW^n second. factorizations lead estimating equations profiled logâ€‘likelihood form used subsequently QLS introducing multipliers.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"lagrange-multipliers-and-el-weights","dir":"Articles","previous_headings":"","what":"Lagrange Multipliers and EL Weights","title":"Empirical Likelihood Theory","text":"Let pip_i jump FF (yi,xi)(y_i,x_i) =1,â€¦,ni=1,\\dots,n (respondents). known auxiliary mean Î¼x\\mu_x (vector), maximize likelihood subject constraints âˆ‘=1npi=1,âˆ‘=1npi(Xiâˆ’Î¼x)=0,âˆ‘=1npi(wiâˆ’W)=0. \\sum_{=1}^n p_i = 1,\\quad \\sum_{=1}^n p_i\\,(X_i - \\mu_x) = 0,\\quad \\sum_{=1}^n p_i\\,(w_i - W) = 0. Introducing Lagrange multipliers (Î»0,Î»x,Î»W)(\\lambda_0,\\lambda_x,\\lambda_W) constraints profiling pip_iâ€™s gives KKT stationarity conditions âˆ‚âˆ‚pi[logpi+Î»0(âˆ‘jpjâˆ’1)+Î»xTâˆ‘jpj(Xjâˆ’Î¼x)+Î»Wâˆ‘jpj(wjâˆ’W)]=0, \\frac{\\partial}{\\partial p_i} \\Big[\\, \\log p_i + \\lambda_0 \\big(\\sum_j p_j - 1\\big) + \\lambda_x^T \\sum_j p_j (X_j-\\mu_x) + \\lambda_W \\sum_j p_j (w_j-W) \\,\\Big] = 0, solve piâˆ11+Î»xT(Xiâˆ’Î¼x)+Î»W(wiâˆ’W)â‰¡1Di. p_i \\,\\propto\\, \\frac{1}{\\,1 + \\lambda_x^T (X_i-\\mu_x) + \\lambda_W (w_i - W)\\,} \\;\\equiv\\; \\frac{1}{D_i}. Normalizing enforce âˆ‘pi=1\\sum p_i = 1 yields pi=Diâˆ’1âˆ‘jDjâˆ’1p_i = \\frac{D_i^{-1}}{\\sum_j D_j^{-1}}. presence base sampling weights aia_i (survey designs), derivation gives natural generalization piELâˆaiDiwithDi=1+Î»W(wiâˆ’W)+(Xiâˆ’Î¼x)TÎ»x. p_i^{\\text{EL}} \\;\\propto\\; \\frac{a_i}{D_i} \\quad \\text{} \\quad D_i = 1 + \\lambda_W (w_i - W) + (X_i - \\mu_x)^T\\lambda_x. exactly working form used estimator. EL weights piELp_i^{\\text{EL}} used build mean estimator YÌ‚=âˆ‘ipiELYiâˆ‘ipiEL. \\hat Y \\;=\\; \\frac{\\sum_i p_i^{\\text{EL}} Y_i}{\\sum_i p_i^{\\text{EL}}}. remaining unknowns (Î²,W,Î»x)(\\beta, W, \\lambda_x) determined estimating equations .","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"clarification-relationship-between-w-and-lambda_w","dir":"Articles","previous_headings":"Lagrange Multipliers and EL Weights","what":"Clarification: Relationship Between WW and Î»W\\lambda_W","title":"Empirical Likelihood Theory","text":"reparameterization, EL multiplier probability constraint expressed : Î»W=C1âˆ’W,C=Npopnresp_weightedâˆ’1 W=plogis(z)\\lambda_W = \\frac{C}{1 - W}, \\quad \\text{} C = \\frac{N_{\\text{pop}}}{n_{\\text{resp\\_weighted}}} - 1 \\text{ } W = \\text{plogis}(z) Intuition: EL KKT system, constraint âˆ‘piEL(wiâˆ’W)=0\\sum p_i^{\\text{EL}} (w_i - W) = 0 sits alongside normalization (optionally) auxiliary constraints. Incorporating base weights aia_i ratio population respondent totals induces scaling multiplier linked mass constraint. Writing Î»W\\lambda_W scaled form keeps parameter numerically stable scale lets derivative structure (w.r.t. zz via WW) handled cleanly. consistent EL structure baseline mass nresp_weightedn_{\\text{resp\\_weighted}} â€œfull populationâ€ target NpopN_{\\text{pop}}, exactly code uses match normalization implied base weights. Derivation sketch (KKT): discretized semiparametric likelihood (QLS, 2002) maximizes, unknown masses {pi}\\{p_i\\} observed points (Î²,W)(\\beta, W), â„“(Î²,W,Î»x,Î»W)=âˆ‘=1nlogwi(Î²)+(Npopâˆ’nresp_weighted)log(1âˆ’W)âˆ’âˆ‘=1nlog(1+(Xiâˆ’Î¼x)âŠ¤Î»x+Î»W(wiâˆ’W)), \\ell(\\beta, W, \\lambda_x, \\lambda_W)  \\;=\\; \\sum_{=1}^{n} \\log w_i(\\beta) \\; +\\; (N_{\\text{pop}} - n_{\\text{resp\\_weighted}}) \\log(1 - W) \\; -\\; \\sum_{=1}^{n} \\log\\!\\Big(1 + (X_i - \\mu_x)^\\top \\lambda_x + \\lambda_W (w_i - W)\\Big), subject normalization moment constraints generate EL denominator. weighted-EL variant work unnormalized respondent weights proportional ai/Dia_i/D_i; choosing conventional normalization âˆ‘=1naiDi=nresp_weightedâ‰¡âˆ‘=1nai \\sum_{=1}^{n} \\frac{a_i}{D_i} \\,=\\, n_{\\text{resp\\_weighted}} \\equiv \\sum_{=1}^{n} a_i recovers estimating system (common normalization cancels ratio estimator YÌ‚=âˆ‘piYi/âˆ‘pi\\hat Y = \\sum p_i Y_i/\\sum p_i). Taking derivatives (KKT conditions) using âˆ‚/âˆ‚W\\partial/\\partial W second third terms produces opposing contributions, one obtains system equivalent QLS (7)â€“(10). particular, first-order condition w.r.t. multiplier associated WW-constraint yields, together derivative w.r.t. WW, closed form Î»W=Npopnresp_weightedâˆ’11âˆ’W=C1âˆ’W, \\lambda_W  \\;=\\; \\frac{\\tfrac{N_{\\text{pop}}}{n_{\\text{resp\\_weighted}}} - 1}{1 - W} \\;=\\; \\frac{C}{1 - W}, generalizes QLS (10) design-weighted case (nresp_weighted=âˆ‘iain_{\\text{resp\\_weighted}} = \\sum_i a_i Npop=âˆ‘allaiN_{\\text{pop}} = \\sum_{\\text{}} a_i). quick derivation sketch mirrors QLS (7)â€“(10): W-FOC yields âˆ‘iai(wiâˆ’W)/Di=0\\sum_i a_i (w_i - W) / D_i = 0; combining implicit normalization âˆ‘iai/Di=nresp_weighted\\sum_i a_i / D_i = n_{\\text{resp\\_weighted}} binomial part WW gives Î»W(1âˆ’W)nresp_weighted=Npopâˆ’nresp_weighted\\lambda_W (1-W)\\, n_{\\text{resp\\_weighted}} = N_{\\text{pop}} - n_{\\text{resp\\_weighted}}, hence Î»W=(Npop/nresp_weightedâˆ’1)/(1âˆ’W)\\lambda_W = (N_{\\text{pop}}/n_{\\text{resp\\_weighted}} - 1)/(1-W). expression implemented estimator used throughout Jacobian variance calculations.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"estimating-equations","dir":"Articles","previous_headings":"","what":"Estimating Equations","title":"Empirical Likelihood Theory","text":"Unknown parameters: Î²âˆˆâ„K\\beta \\\\mathbb{R}^K, zâˆˆâ„z \\\\mathbb{R} (W=plogis(z)W = \\text{plogis}(z)), Î»xâˆˆâ„L\\lambda_x \\\\mathbb{R}^L; define Î¸=(Î²,z,Î»x)\\theta = (\\beta, z, \\lambda_x). Define wi=linkinv(Î·i)w_i = \\mathrm{linkinv}(\\eta_i) Î¼Î·,=dwdÎ·(Î·i)\\mu_{\\eta,} = \\frac{dw}{d\\eta}(\\eta_i) (denoted mu.eta(eta_i) code). Define C=Npopnresp_weightedâˆ’1C = \\frac{N_{\\text{pop}}}{n_{\\text{resp\\_weighted}}} - 1, nresp_weighted=âˆ‘ain_{\\text{resp\\_weighted}} = \\sum a_i NpopN_{\\text{pop}} known (sum design weights survey; nn IID). Î»W=C1âˆ’W\\lambda_W = \\frac{C}{1 - W}. Denominator: Di=1+Î»W(wiâˆ’W)+(Xiâˆ’Î¼x)TÎ»xD_i = 1 + \\lambda_W (w_i - W) + (X_i - \\mu_x)^T \\lambda_x, Diâ‰¥ÏµD_i \\geq \\epsilon enforced numerically. Define score term si=Î¼Î·,/wis_i = \\mu_{\\eta,}/w_i (unitâ€‘level contribution logâ€‘likelihood score respect Î·\\eta). logit, si=1âˆ’wis_i = 1 - w_i; probit, si=Ï•(Î·i)/Î¦(Î·i)s_i = \\phi(\\eta_i)/\\Phi(\\eta_i) (computed stably code). Intuition (score appears): respondent observe Ri=1R_i=1, Bernoulli logâ€‘likelihood contribution response model logwi(Î·i)\\log w_i(\\eta_i). Differentiating w.r.t. linear predictor gives âˆ‚âˆ‚Î·ilogwi(Î·i)=1widwidÎ·i=Î¼Î·,iwiâ‰¡si. \\frac{\\partial}{\\partial\\eta_i} \\log w_i(\\eta_i) \\,=\\, \\frac{1}{w_i}\\, \\frac{dw_i}{d\\eta_i} \\,=\\, \\frac{\\mu_{\\eta,}}{w_i} \\;\\equiv\\; s_i.  Thus sis_i measures local sensitivity observedâ€‘response likelihood Î·i\\eta_i. logit family, Î¼Î·,=wi(1âˆ’wi)\\mu_{\\eta,}=w_i(1-w_i) si=1âˆ’wis_i=1-w_iâ€”familiar residualâ€‘like term; probit family, si=Ï•(Î·i)/Î¦(Î·i)s_i=\\phi(\\eta_i)/\\Phi(\\eta_i), (inverse) Mills ratio. EL Î²\\betaâ€‘equations balance likelihood score EL penalty term Î»WÎ¼Î·,/Di\\lambda_W\\,\\mu_{\\eta,}/D_i, enforcing calibration constraints fitting response model.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"the-system-of-estimating-equations-ftheta-0","dir":"Articles","previous_headings":"Estimating Equations","what":"The System of Estimating Equations F(Î¸)=0F(\\theta) = 0","title":"Empirical Likelihood Theory","text":"Î²\\beta-equations (KK equations): âˆ‘aiZi[siâˆ’Î»WÎ¼Î·,/Di]=0\\sum a_i Z_i [s_i - \\lambda_W \\mu_{\\eta,} / D_i] = 0 W-equation (1 equation): âˆ‘ai(wiâˆ’W)/Di=0\\sum a_i (w_i - W) / D_i = 0 Auxiliary constraints (LL equations): âˆ‘ai(Xiâˆ’Î¼x)/Di=0\\sum a_i (X_i - \\mu_x) / D_i = 0 exactly build_equation_system constructs function code (src/engines/el/impl/el_equations.R). Intuition: Î²\\beta-equations equate score respondent log-likelihood EL penalty term Î»WÎ¼Î·,/Di\\lambda_W \\mu_{\\eta,}/D_i; WW-equation centers modeled response probabilities around unconditional mean WW EL weights; auxiliary equations calibrate centered auxiliaries zero mean EL weights.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"remarks","dir":"Articles","previous_headings":"Estimating Equations","what":"Remarks","title":"Empirical Likelihood Theory","text":"logit probit, sis_i logâ€‘likelihood score âˆ‚logwi/âˆ‚Î·i=Î¼Î·,/wi\\partial\\log w_i/\\partial\\eta_i = \\mu_{\\eta,}/w_i (equals 1âˆ’wi1-w_i logit; Ï•/Î¦\\phi/\\Phi probit). follows paperâ€™s MLE derivation; EL constraints supply nonparametric part.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"analytical-jacobian-a-matrix","dir":"Articles","previous_headings":"","what":"Analytical Jacobian (AA Matrix)","title":"Empirical Likelihood Theory","text":"differentiate F(Î¸)=0F(\\theta) = 0 respect Î¸=(Î²,z,Î»x)\\theta = (\\beta, z, \\lambda_x). Let: Î·i=ZiÎ²\\eta_i = Z_i \\beta, wi=linkinv(Î·i)w_i = \\text{linkinv}(\\eta_i), Î¼Î·,=dwdÎ·(Î·i)\\mu_{\\eta,} = \\dfrac{dw}{d\\eta}(\\eta_i), Î¼â€³=d2wdÎ·2(Î·i)\\mu''_i = \\dfrac{d^2 w}{d\\eta^2}(\\eta_i) W=plogis(z)W = \\text{plogis}(z), dWdz=W(1âˆ’W)\\frac{dW}{dz} = W(1 - W) Î»W=C1âˆ’W\\lambda_W = \\frac{C}{1 - W}, dÎ»WdW=C(1âˆ’W)2\\frac{d\\lambda_W}{dW} = \\frac{C}{(1 - W)^2} dÎ»Wdz=dÎ»WdWâ‹…dWdz\\frac{d\\lambda_W}{dz} = \\frac{d\\lambda_W}{dW} \\cdot \\frac{dW}{dz} Xcentered,=Xiâˆ’Î¼xX_{\\text{centered},} = X_i - \\mu_x","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"intermediate-derivatives","dir":"Articles","previous_headings":"Analytical Jacobian (AA Matrix)","what":"Intermediate Derivatives","title":"Empirical Likelihood Theory","text":"si=Î¼Î·,/wiâ‡’dsidÎ·i=(Î¼â€²Î·,iwiâˆ’Î¼Î·,i2)/wi2s_i = \\mu_{\\eta,}/w_i \\Rightarrow \\;\\frac{ds_i}{d\\eta_i} = (\\mu'_{\\eta,}w_i - \\mu_{\\eta,}^2)/w_i^2 Î¼â€²Î·,=dÎ¼Î·,idÎ·i=d2wdÎ·i2â‰¡Î¼â€³\\mu'_{\\eta,} = \\dfrac{d\\mu_{\\eta,}}{d\\eta_i} = \\dfrac{d^2 w}{d\\eta_i^2} \\equiv \\mu''_i (d2mu.deta2(eta_i) code) âˆ‚Diâˆ‚Î·i=Î»WÎ¼Î·,\\frac{\\partial D_i}{\\partial \\eta_i} = \\lambda_W \\mu_{\\eta,} âˆ‚Diâˆ‚z=âˆ‚Î»Wâˆ‚zâ‹…(wiâˆ’W)âˆ’Î»Wâ‹…dWdz\\frac{\\partial D_i}{\\partial z} = \\frac{\\partial \\lambda_W}{\\partial z} \\cdot (w_i - W) - \\lambda_W \\cdot \\frac{dW}{dz} âˆ‚Diâˆ‚Î»x=Xcentered,\\frac{\\partial D_i}{\\partial \\lambda_x} = X_{\\text{centered},} Define invi=1/Di\\text{inv}_i = 1 / D_i scalar term driving Î²\\betaâ€‘equations: Ti=siâˆ’Î»WÎ¼Î·,iinvi,si=Î¼Î·,iwi.T_i = s_i - \\lambda_W \\mu_{\\eta,} \\text{inv}_i,\\quad s_i = \\frac{\\mu_{\\eta,}}{w_i}.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"compute-its-derivatives","dir":"Articles","previous_headings":"Analytical Jacobian (AA Matrix)","what":"Compute Its Derivatives","title":"Empirical Likelihood Theory","text":"Using Î¼â€²Î·,=dÎ¼Î·,/dÎ·i=d2mudeta2(Î·i)\\,\\mu'_{\\eta,} = d\\mu_{\\eta,}/d\\eta_i = \\mathrm{d2mu\\,deta2}(\\eta_i) dwi/dÎ·i=Î¼Î·,\\,dw_i/d\\eta_i = \\mu_{\\eta,}, âˆ‚siâˆ‚Î·i=Î¼â€²Î·,iwiâˆ’Î¼Î·,i2wi2.\\frac{\\partial s_i}{\\partial \\eta_i} = \\frac{\\mu'_{\\eta,} w_i - \\mu_{\\eta,}^2}{w_i^2}. Also âˆ‚inviâˆ‚Î·i=âˆ’invi2â‹…âˆ‚Diâˆ‚Î·i=âˆ’invi2(Î»WÎ¼Î·,)\\,\\frac{\\partial \\text{inv}_i}{\\partial \\eta_i} = -\\text{inv}_i^2 \\cdot \\frac{\\partial D_i}{\\partial \\eta_i} = -\\text{inv}_i^2 (\\lambda_W \\mu_{\\eta,}). Therefore âˆ‚Tiâˆ‚Î·i=Î¼â€²Î·,iwiâˆ’Î¼Î·,i2wi2âˆ’Î»WÎ¼â€²Î·,iinvi+Î»W2(Î¼Î·,)2invi2.\\frac{\\partial T_i}{\\partial \\eta_i} = \\frac{\\mu'_{\\eta,} w_i - \\mu_{\\eta,}^2}{w_i^2} - \\lambda_W \\mu'_{\\eta,} \\text{inv}_i + \\lambda_W^2 (\\mu_{\\eta,})^2 \\text{inv}_i^2. âˆ‚Tiâˆ‚z=âˆ’âˆ‚Î»Wâˆ‚zâ‹…Î¼Î·,iinvi+Î»WÎ¼Î·,iinvi2â‹…âˆ‚Diâˆ‚z\\frac{\\partial T_i}{\\partial z} = -\\frac{\\partial \\lambda_W}{\\partial z} \\cdot \\mu_{\\eta,} \\text{inv}_i + \\lambda_W \\mu_{\\eta,} \\text{inv}_i^2 \\cdot \\frac{\\partial D_i}{\\partial z} âˆ‚Tiâˆ‚Î»x=Î»WÎ¼Î·,iinvi2â‹…Xcentered,\\frac{\\partial T_i}{\\partial \\lambda_x} = \\lambda_W \\mu_{\\eta,} \\text{inv}_i^2 \\cdot X_{\\text{centered},}","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"assemble-jacobian-blocks-with-a_i-weights","dir":"Articles","previous_headings":"Analytical Jacobian (AA Matrix)","what":"Assemble Jacobian Blocks (with aia_i weights)","title":"Empirical Likelihood Theory","text":"JÎ²Î²J_{\\beta\\beta} (KÃ—KK \\times K): J11=âˆ‘aiZiT[âˆ‚Tiâˆ‚Î·i]ZiJ_{11} = \\sum a_i Z_i^T \\left[ \\frac{\\partial T_i}{\\partial \\eta_i} \\right] Z_i JÎ²zJ_{\\beta z} (KÃ—1K \\times 1): J12=âˆ‘aiZiT[âˆ‚Tiâˆ‚z]J_{12} = \\sum a_i Z_i^T \\left[ \\frac{\\partial T_i}{\\partial z} \\right] JÎ²Î»J_{\\beta \\lambda} (KÃ—LK \\times L): J13=âˆ‘aiZiT[âˆ‚Tiâˆ‚Î»x]J_{13} = \\sum a_i Z_i^T \\left[ \\frac{\\partial T_i}{\\partial \\lambda_x} \\right] JzÎ²J_{z\\beta} (1Ã—K1 \\times K): derivative W-equation w.r.t. Î²\\beta Equation: GW=âˆ‘ai(wiâˆ’W)inviG_W = \\sum a_i (w_i - W) \\text{inv}_i âˆ‚GWâˆ‚Î·i=ai[Î¼Î·,iinviâˆ’(wiâˆ’W)invi2(âˆ‚Diâˆ‚Î·i)]=ai[Î¼Î·,iinviâˆ’(wiâˆ’W)invi2(Î»WÎ¼Î·,)]\\frac{\\partial G_W}{\\partial \\eta_i} = a_i \\left[ \\mu_{\\eta,} \\text{inv}_i - (w_i - W) \\text{inv}_i^2 \\left(\\frac{\\partial D_i}{\\partial \\eta_i}\\right) \\right] = a_i \\left[ \\mu_{\\eta,} \\text{inv}_i - (w_i - W) \\text{inv}_i^2 (\\lambda_W \\mu_{\\eta,}) \\right] : J21=âˆ‘âˆ‚GWâˆ‚Î·iâ‹…ZiJ_{21} = \\sum \\frac{\\partial G_W}{\\partial \\eta_i} \\cdot Z_i JzzJ_{zz} (1Ã—11 \\times 1): âˆ‚GWâˆ‚z=âˆ‘ai[âˆ’dWdzâ‹…inviâˆ’(wiâˆ’W)invi2â‹…âˆ‚Diâˆ‚z]\\frac{\\partial G_W}{\\partial z} = \\sum a_i \\left[ -\\frac{dW}{dz} \\cdot \\text{inv}_i - (w_i - W) \\text{inv}_i^2 \\cdot \\frac{\\partial D_i}{\\partial z} \\right] JzÎ»J_{z\\lambda} (1Ã—L1 \\times L): âˆ‚GWâˆ‚Î»x=âˆ‘ai[âˆ’(wiâˆ’W)invi2Xcentered,]\\frac{\\partial G_W}{\\partial \\lambda_x} = \\sum a_i \\left[ -(w_i - W) \\text{inv}_i^2 X_{\\text{centered},} \\right] JÎ»Î²J_{\\lambda\\beta} (LÃ—KL \\times K): constraints H(Î»):âˆ‘aiinviXcentered,=0H(\\lambda): \\sum a_i \\text{inv}_i X_{\\text{centered},} = 0 âˆ‚Hâˆ‚Î·i=âˆ’aiinvi2âˆ‚Diâˆ‚Î·iXcentered,=âˆ’aiinvi2(Î»WÎ¼Î·,)Xcentered,\\frac{\\partial H}{\\partial \\eta_i} = -a_i \\text{inv}_i^2 \\frac{\\partial D_i}{\\partial \\eta_i} X_{\\text{centered},} = -a_i \\text{inv}_i^2 (\\lambda_W \\mu_{\\eta,}) X_{\\text{centered},} , componentâ€‘wise J31=âˆ‘iai(âˆ’Î»WÎ¼Î·,iinvi2)Xcentered,iTZiJ_{31} = \\sum_i a_i\\,(-\\lambda_W \\mu_{\\eta,}\\,\\text{inv}_i^2)\\, X_{\\text{centered},}^T Z_i. compact matrix form: J31=XcenteredTdiag(ai(âˆ’Î»WÎ¼Î·,iinvi2))Z, J_{31} \\;=\\; X_{\\text{centered}}^T \\, \\operatorname{diag}\\big( a_i\\,(-\\lambda_W \\mu_{\\eta,}\\,\\text{inv}_i^2) \\big) \\, Z, matches implementation crossprod(X_centered, Z * .numeric(respondent_weights * term31)) term31 = -dden_deta * inv_denom^2 dden_deta = \\lambda_W\\,\\mu_{\\eta}. JÎ»zJ_{\\lambda z} (LÃ—1L \\times 1): âˆ‚Hâˆ‚z=âˆ’âˆ‘aiinvi2âˆ‚Diâˆ‚zXcentered,\\frac{\\partial H}{\\partial z} = -\\sum a_i \\text{inv}_i^2 \\frac{\\partial D_i}{\\partial z} X_{\\text{centered},} JÎ»Î»J_{\\lambda\\lambda} (LÃ—LL \\times L): âˆ‚Hâˆ‚Î»x=âˆ’âˆ‘aiinvi2Xcentered,iXcentered,\\frac{\\partial H}{\\partial \\lambda_x} = -\\sum a_i \\text{inv}_i^2 X_{\\text{centered},} X_{\\text{centered},}^T exactly build_el_jacobian computes (src/engines/el/impl/el_jacobian.R). =âˆ‚Fâˆ‚Î¸A = \\frac{\\partial F}{\\partial \\theta}, analytic Jacobian logit probit.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"why-a-matters-solver-and-variance","dir":"Articles","previous_headings":"Analytical Jacobian (AA Matrix)","what":"Why AA matters (solver and variance)","title":"Empirical Likelihood Theory","text":"Newtonâ€“Raphson (used nleqslv) linearizes F(Î¸)F(\\theta) near current iterate: F(Î¸+Î”)â‰ˆF(Î¸)+(Î¸)Î”F(\\theta + \\Delta) \\approx F(\\theta) + (\\theta)\\,\\Delta. update Î”\\Delta solves AÎ”=âˆ’FA\\,\\Delta = -F, hence highâ€‘quality AA critical fast, stable convergence. variance, delta method uses AA: asymptotic covariance Î¸Ì‚\\hat\\theta âˆ’1BAâˆ’TA^{-1} B ^{-T}, inaccuracies AA propagate standard errors. provide analytic numeric AA â€œautoâ€ policy prefers analytic unless diagnostics indicate poor agreement conditioning.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"sandwich-variance-for-theta-analytical-covariance","dir":"Articles","previous_headings":"Variance Estimation","what":"Sandwich Variance for Î¸\\theta (Analytical Covariance)","title":"Empirical Likelihood Theory","text":"UÎ²,=aiZiT[siâˆ’Î»WÎ¼Î·,/Di]U_{\\beta,} = a_i\\, Z_i^T\\,[\\, s_i - \\lambda_W \\mu_{\\eta,}/D_i\\,] (vector length KK) UW,=ai(wiâˆ’W)/DiU_{W,} = a_i\\, (w_i - W)/D_i (scalar) UÎ»,=ai(Xiâˆ’Î¼x)/DiU_{\\lambda,} = a_i\\, (X_i - \\mu_x)/D_i (vector length LL) Concatenating gives UiU_i length K+1+LK+1+L. =âˆ‚F/âˆ‚Î¸A = \\partial F/\\partial\\theta (K+1+LK+1+L square) comes analytic Jacobian (numeric necessary). IID: Form NÃ—(K+1+L)N\\times(K+1+L) matrix UiU_i respondent rows zeros nonrespondent rows, compute BÌ‚=UTU\\widehat B = U^T U (empirical second moment totals). Survey: Treat column UU survey variable compute covariance totals using survey::svytotal(...); vcov(...). provides designâ€‘based BÌ‚\\widehat B complex designs. Asymptotic covariance: VarÌ‚(Î¸Ì‚)=âˆ’1BÌ‚âˆ’T\\widehat{\\operatorname{Var}}(\\hat\\theta) = ^{-1}\\, \\widehat B\\, ^{-T}. AA BB totals (sum) scale, extra 1/N1/N factors introduced; matches survey path vcov(svytotal) returns covariances totals.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"delta-variance-for-haty","dir":"Articles","previous_headings":"Variance Estimation","what":"Delta Variance for YÌ‚\\hat{Y}","title":"Empirical Likelihood Theory","text":"Define estimator functional g(Î¸)=YÌ‚(Î¸)g(\\theta) = \\hat{Y}(\\theta): recompute piEL(Î¸)p_i^{\\text{EL}}(\\theta) Î¸\\theta via Di(Î¸)D_i(\\theta), YÌ‚=âˆ‘piELYi/âˆ‘piEL\\hat{Y} = \\sum p_i^{\\text{EL}} Y_i / \\sum p_i^{\\text{EL}} Gradient: âˆ‡g(Î¸)â‰ˆ\\nabla g(\\theta) \\approx numeric gradient (numDeriv::grad) Variance: Var(YÌ‚)â‰ˆâˆ‡gAâˆ’1B(âˆ’1)Tâˆ‡gT\\text{Var}(\\hat{Y}) \\approx \\nabla g \\, ^{-1} B (^{-1})^T \\nabla g^T Practical note stability: unconditional response rate WW low auxiliaries weak, Î»W\\lambda_W can large denominators DiD_i may approach zero, creating large EL weights heavyâ€‘tailed sampling distribution YÌ‚\\hat Y. regimes firstâ€‘order (delta) approximation may understate acrossâ€‘sample variability. Prefer variance_method = \"bootstrap\" strengthen auxiliary constraints. Implementation: compute_delta_variance() src/engines/el/impl/el_variance.R assembles BB U_matrix_resp provided compute_score_variance_func (IID vs survey), computes âˆ‡g\\nabla g numerically, returns Var(YÌ‚)\\mathrm{Var}(\\hat{Y}) (scaled) sandwich vcov Î²\\beta.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"solving-strategy-and-initialization","dir":"Articles","previous_headings":"Variance Estimation","what":"Solving Strategy and Initialization","title":"Empirical Likelihood Theory","text":"Newton analytic Jacobian available; Perturbationâ€‘based reâ€‘starts seed zz logit(observed response rate)\\mathrm{logit}(\\text{observed response rate}) align binomial part; Broyden fallback without Jacobian needed. reparameterization initialization improve stability strong NMAR settings. See src/engines/el/impl/el_core.R.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"jacobian-inversion-policy-and-numerical-stability","dir":"Articles","previous_headings":"Variance Estimation","what":"Jacobian Inversion Policy and Numerical Stability","title":"Empirical Likelihood Theory","text":"Let =âˆ‚Fâˆ‚Î¸A = \\frac{\\partial F}{\\partial \\theta} Jacobian estimating system. delta variance uses âˆ’1A^{-1}. Numerically, follow principled, layered inversion policy implemented invert_jacobian() (src/shared/numerics.R): Condition number check: Compute condition number Îº()\\kappa(). Îº()â‰¤Îºthr\\kappa() \\leq \\kappa_{\\text{thr}} (default 10810^8), attempt plain inverse via solve(). Ridge regularization: plain inversion fails Îº()\\kappa() large variance_ridge requested: Apply ridge: invert +ÏµIA + \\epsilon , Ïµ\\epsilon either provided (numeric variance_ridge) chosen adaptively Ïµ=baseÃ—Ïƒmax()\\epsilon = \\text{base} \\times \\sigma_{\\max}() (default base 10âˆ’810^{-8}). Pseudoinverse fallback: variance_pseudoinverse = TRUE, compute SVD-based pseudoinverse (MASS::ginv explicit SVD tolerance), use . Diagnostics: function returns inverse diagnostics: invert_rule âˆˆ\\{â€œplainâ€,â€œridgeâ€,â€œpinvâ€}, used_ridge, used_pinv, kappa.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"remarks-1","dir":"Articles","previous_headings":"Variance Estimation","what":"Remarks","title":"Empirical Likelihood Theory","text":"minus sign âˆ’âˆ’1-^{-1} conventional; cancels sandwich âˆ‡gAâˆ’1B(âˆ’1)Tâˆ‡gT\\nabla g \\, ^{-1} B (^{-1})^T \\nabla g^T. Pseudoinverse ridge opt-, full diagnostics recorded. ill-conditioned regimes (weak identification, trimming, etc.), controlled stabilizers standard practice preferable failing silently. finite weight trimming, delta-variance approximate g(Î¸)g(\\theta) incorporates trimming; prefer variance_method = \"bootstrap\" case (implemented). Example: Îº()â‰ˆ1010\\kappa() \\approx 10^{10} variance_ridge = TRUE, inversion applies adaptive ridge Ïµâ‰ˆ10âˆ’8Ã—Ïƒmax()\\epsilon \\approx 10^{-8} \\times \\sigma_{\\max}() inverts +ÏµIA + \\epsilon . typically reduces ill-conditioning stabilizes Newton linear solve sandwich variance.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"survey-design-details","dir":"Articles","previous_headings":"","what":"Survey Design Details","title":"Empirical Likelihood Theory","text":"extend QLSâ€™s methodology complex surveys two complementary ways: Estimating equations base weights: sums already include base weight aia_i; set aia_i survey design weight respondents. Totals NpopN_{\\text{pop}} nresp_weighted=âˆ‘ain_{\\text{resp\\_weighted}}=\\sum a_i computed design weights, feeds Î»W=((Npop/nresp_weighted)âˆ’1)/(1âˆ’W)\\lambda_W = ((N_{\\text{pop}}/n_{\\text{resp\\_weighted}}) - 1)/(1-W). Designâ€‘based variance totals: Rather assuming ..d. sampling, estimate B=Var(âˆ‘Ui)B = \\operatorname{Var}(\\sum U_i) using design: Create fullâ€‘design score variables placing respondent contributions UiU_i observed rows zeros nonrespondents. Compute survey totals svytotal(~U, design) take covariance via vcov(...) obtain BÌ‚\\widehat B. short form, compute BÌ‚=vcov(ğšœğšŸğš¢ğšğš˜ğšğšŠğš•(âˆ¼U,ğšğšğšœğš’ğšğš—)), \\widehat B \\;=\\; \\operatorname{vcov}\\!\\big(\\,\\texttt{svytotal}(\\,\\sim U,\\; \\texttt{design}\\,)\\,\\big), UU stacks respondent score contributions zeros elsewhere. matches paperâ€™s guidance adapt likelihood/estimating framework stratification unequalâ€‘probability sampling. approach keeps EL structure uses standard survey inference tools secondâ€‘order properties. Degreesâ€‘â€‘freedom: confidence intervals, use survey degreesâ€‘â€‘freedom (tâ€‘quantiles) survey.design supplied; otherwise, use normal quantiles.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"scaling-optional-standardizetrue","dir":"Articles","previous_headings":"Scaling and Unscaling","what":"Scaling (optional; standardize=TRUE)","title":"Empirical Likelihood Theory","text":"meanj\\text{mean}_j, sdj\\text{sd}_j; sdjâ‰ˆ0\\text{sd}_j \\approx 0, set sdj=1\\text{sd}_j = 1 avoid blow-ups. Zscaled[,j]=(Zun[,j]âˆ’meanj)/sdjZ_{\\text{scaled}}[,j] = (Z_{\\text{un}}[,j] - \\text{mean}_j) / \\text{sd}_j Xscaled[,j]=(Xun[,j]âˆ’meanj)/sdjX_{\\text{scaled}}[,j] = (X_{\\text{un}}[,j] - \\text{mean}_j) / \\text{sd}_j Î¼x,scaled[j]=(Î¼x,un[j]âˆ’meanj)/sdj\\mu_{x,\\text{scaled}}[j] = (\\mu_{x,\\text{un}}[j] - \\text{mean}_j) / \\text{sd}_j","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"unscaling-beta-and-vcov","dir":"Articles","previous_headings":"Scaling and Unscaling","what":"Unscaling Î²\\beta and vcov","title":"Empirical Likelihood Theory","text":"columns jâ‰ j \\neq intercept: D[j,j]=1/sdjD[j,j] = 1/\\text{sd}_j intercept: adjust absorb centering: D[intercept,j]=âˆ’meanj/sdjD[\\text{intercept},j] = -\\text{mean}_j/\\text{sd}_j Transform: Î²unscaled=DÎ²scaled\\beta_{\\text{unscaled}} = D \\beta_{\\text{scaled}}; vcovunscaled=DvcovscaledDT\\text{vcov}_{\\text{unscaled}} = D \\, \\text{vcov}_{\\text{scaled}} \\, D^T Code: centralized src/shared/scaling.R; engines call validate_and_apply_nmar_scaling() unscale_coefficients().","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"bootstrap-variance","dir":"Articles","previous_headings":"","what":"Bootstrap Variance","title":"Empirical Likelihood Theory","text":"Resample rows replacement (nn nn), re-run estimator, compute var\\text{var} bootstrap YÌ‚\\hat{Y}s; warn many failures; return var\\sqrt{\\text{var}}. Convert bootstrap replicate-weight design via svrep::as_bootstrap_design. replicate, re-construct temporary design run estimator; use survey::svrVar compute variance replicate estimates (scale/rscales). Code: src/shared/bootstrap.R S3 methods data.frame survey.design.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"families-logit-and-probit","dir":"Articles","previous_headings":"","what":"Families: Logit and Probit","title":"Empirical Likelihood Theory","text":"families implement: linkinv(eta), mu.eta(eta), d2mu.deta2(eta), score_eta(eta, delta).","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"logit","dir":"Articles","previous_headings":"Families: Logit and Probit","what":"Logit","title":"Empirical Likelihood Theory","text":"linkinv(eta) = stats::plogis(eta) mu.eta(eta) = p(1 - p) d2mu.deta2(eta) = p(1 - p)(1 - 2p) score_eta(eta, delta) = mu.eta(eta)/p(eta) = 1 - p(eta)","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"probit","dir":"Articles","previous_headings":"Families: Logit and Probit","what":"Probit","title":"Empirical Likelihood Theory","text":"linkinv(eta) = stats::pnorm(eta) mu.eta(eta) = stats::dnorm(eta) d2mu.deta2(eta) = -eta * stats::dnorm(eta) score_eta(eta, delta) = mu.eta(eta)/p(eta) = phi(eta)/Phi(eta) (computed via stable logâ€‘ratio) definitions match semiparametric MLE equations Qinâ€“Leungâ€“Shao (2002), analytic Jacobian formulas valid links.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"score-functions-iid-vs-survey","dir":"Articles","previous_headings":"Families: Logit and Probit","what":"Score functions: IID vs Survey","title":"Empirical Likelihood Theory","text":"perâ€‘unit score contributions UiU_i analytic form IID survey designs; difference presence base weights aia_i multiplying contribution, way estimate covariance totals BB. IID case: ai=1a_i = 1, BÌ‚\\widehat B empirical crossproduct perâ€‘unit scores (zeros nonrespondents). Survey case: aia_i equals design weight; BÌ‚\\widehat B obtained svytotal/vcov clustering, stratification, unequal probabilities reflected covariance score totals.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"choosing-analytic-vs-numeric-jacobian-auto","dir":"Articles","previous_headings":"Families: Logit and Probit","what":"Choosing Analytic vs Numeric Jacobian (â€œautoâ€)","title":"Empirical Likelihood Theory","text":"analytic numeric versions AA available, default selection â€œautoâ€: Prefer analytic AA available, unless quality gates suggest otherwise. Override numeric relative Frobenius difference analytic numeric exceeds small threshold (default 10âˆ’310^{-3}), condition number analytic AA much worse (Îºanalytic>10Ã—Îºnumeric\\kappa_{\\text{analytic}} > 10 \\times \\kappa_{\\text{numeric}}). Record diagnostics source used (jacobian_source) (jacobian_auto_rule âˆˆ\\{â€œdefaultâ€,â€œrel_diff_highâ€,â€œkappa_ratio_highâ€}). balances accuracy/speed (analytic) numerical robustness (numeric) follows best practices nonlinear estimating systems.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"end-to-end-mapping-to-code","dir":"Articles","previous_headings":"","what":"End-to-End Mapping to Code","title":"Empirical Likelihood Theory","text":"Validated validate_nmar_engine_el(). Family objects: logit_family(), probit_family() src/shared/families.R. Dispatch: run_engine.nmar_engine_el(...) src/engines/el/run.R adapts formula forwards arguments el() methods. el.data.frame() / el.survey.design() src/engines/el/impl/el_dataframe.R el_survey.R prepare inputs, call el_estimator_core(), wrap results. Scaling via validate_and_apply_nmar_scaling() Build equations via el_build_equation_system(family, ...) Solve nleqslv (multi-start fallback Broyden needed) Compute EL weights, Y_hat, diagnostics, constraints Variance (delta bootstrap), via build_el_jacobian(family, ...) B via compute_score_variance_func (IID vs survey), grad_g via numDeriv::grad Unscale coefficients vcov needed Jacobian: build_el_jacobian(...) src_dev/engines/el/impl/jacobian.R returns analytic whenever family supplies d2mu.deta2 (logit, probit). Variance: src_dev/engines/el/impl/variance.R assembles B computes delta variance; bootstrap variance src_dev/shared/bootstrap.R. Scaling: src_dev/shared/scaling.R (class â€˜nmar_scaling_recipeâ€™, constructor, validator, create/apply/prepare, unscale). Parent nmar_result S3 methods src_dev/S3/nmar_result_methods.R (estimate, vcov, confint, tidy, glance, plot, autoplot). EL-specific S3 methods src_dev/engines/el/s3.R (print/summary nmar_result_el).","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"worked-example-logit-one-auxiliary-mean","dir":"Articles","previous_headings":"","what":"Worked Example: Logit + One Auxiliary Mean","title":"Empirical Likelihood Theory","text":"Consider simple NMAR setup single auxiliary X whose population mean known. Data: outcome Y_miss (NA nonrespondents), auxiliary X. Response model (logit): wi=plogis(Î²0+Î²1Yi)w_i = \\mathrm{plogis}(\\beta_0 + \\beta_1\\,Y_i) respondents (Ri=1R_i=1). Auxiliary mean: Î¼x\\mu_x known (e.g., mean(X) external source). Step 1 â€” Build design matrices moments Zi=[1,Yi]Z_i = [1,\\;Y_i] model.matrix(~ Y_miss, data=respondents). XiX_i model.matrix(~ X - 1, data=respondents); Î¼x\\,\\mu_x scalar. Optionally standardize ZZ XX transform Î¼x\\mu_x accordingly (recommend standardize=TRUE). Step 2 â€” Define EL denominator weights Di=1+Î»W(wiâˆ’W)+(Xiâˆ’Î¼x)TÎ»xD_i = 1 + \\lambda_W (w_i - W) + (X_i - \\mu_x)^T \\, \\lambda_x. Respondent EL weights proportional 1/Di1/D_i (times base weights aia_i, 1). mean estimator YÌ‚=âˆ‘piELYi/âˆ‘piEL\\hat{Y} = \\sum p_i^{\\mathrm{EL}} Y_i / \\sum p_i^{\\mathrm{EL}}. Step 3 â€” Estimating equations Score term (logit): si=Î¼Î·,/wi=1âˆ’wis_i = \\mu_{\\eta,}/w_i = 1 - w_i Î¼Î·,=wi(1âˆ’wi)\\mu_{\\eta,} = w_i(1-w_i). Beta equations (2 unknowns): âˆ‘Zi[siâˆ’Î»WÎ¼Î·,/Di]=0\\sum Z_i\\,[s_i - \\lambda_W\\,\\mu_{\\eta,}/D_i] = 0. W equation: âˆ‘(wiâˆ’W)/Di=0\\sum (w_i - W)/D_i = 0. Auxiliary: âˆ‘(Xiâˆ’Î¼x)/Di=0\\sum (X_i - \\mu_x)/D_i = 0. Î»W\\lambda_W determined C=(Npop/nresp_weighted)âˆ’1C = (N_{\\text{pop}}/n_{\\text{resp\\_weighted}}) - 1 via Î»W=C/(1âˆ’W)\\lambda_W = C/(1 - W) (IID data, nresp_weighted=nn_{\\text{resp\\_weighted}} = n). Step 4 â€” Solve compute YÌ‚\\hat{Y} Unknowns: (Î²0,Î²1,z,Î»x)(\\beta_0, \\beta_1, z, \\lambda_x) W=plogis(z)W=\\mathrm{plogis}(z). Solve F(Î¸)=0F(\\theta)=0 using Newton/Broyden (analytic Jacobian). solution, compute DiD_i, normalize piELâˆ1/Dip_i^{\\mathrm{EL}} \\propto 1/D_i, return YÌ‚\\hat{Y} diagnostics. Step 5 â€” Variance Assemble =âˆ‚F/âˆ‚Î¸A=\\partial F/\\partial\\theta analytically; assemble BB score totals (IID crossproduct survey svytotal vcov). Compute Var(YÌ‚)\\mathrm{Var}(\\hat{Y}) via delta method: âˆ‡gAâˆ’1BAâˆ’Tâˆ‡gT\\nabla g\\,^{-1} B ^{-T}\\,\\nabla g^T. run (code) maps code Equations: src/engines/el/impl/el_equations.R Jacobian: src/engines/el/impl/el_jacobian.R Core solve + weights + variance: src/engines/el/impl/el_core.R, src/engines/el/impl/el_variance.R Scaling: src/shared/scaling.R","code":"eng <- el_engine(auxiliary_means = c(X = mu_x), family = \"logit\", standardize = TRUE) res <- nmar(   formula = list(outcome = ~ Y_miss, covariates_outcome = ~ X, covariates_missingness = ~ NULL),   data = df,   engine = eng ) estimate(res); confint(res)"},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"worked-example-probit-one-auxiliary-mean","dir":"Articles","previous_headings":"","what":"Worked Example: Probit + One Auxiliary Mean","title":"Empirical Likelihood Theory","text":"setup , probit response model. Response model (probit): wi=Î¦(Î²0+Î²1Yi)w_i = \\Phi(\\beta_0 + \\beta_1\\,Y_i). Score term: si=Î¼Î·,/wi=Ï•(Î·i)/Î¦(Î·i)s_i = \\mu_{\\eta,}/w_i = \\phi(\\eta_i)/\\Phi(\\eta_i) (computed stably via logâ€‘ratio code). equations denominator DiD_i logit example; wiw_i, Î¼Î·,\\mu_{\\eta,}, sis_i change family. run (code) Notes analytic Jacobian valid probit Î¼Î·,=Ï•(Î·i)\\mu_{\\eta,}=\\phi(\\eta_i) Î¼â€²Î·,=âˆ’Î·iÏ•(Î·i)\\mu'_{\\eta,}=-\\eta_i\\phi(\\eta_i). clip wiw_i away {0,1}\\{0,1\\} forming Î¼/w\\mu/w ensure numerical stability.","code":"eng <- el_engine(auxiliary_means = c(X = mu_x), family = \"probit\", standardize = TRUE) res <- nmar(   formula = list(outcome = ~ Y_miss, covariates_outcome = ~ X, covariates_missingness = ~ NULL),   data = df,   engine = eng ) estimate(res); confint(res)"},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"debugging-tips","dir":"Articles","previous_headings":"","what":"Debugging Tips","title":"Empirical Likelihood Theory","text":"Convergence: diagnostics$max_equation_residual tiny (e.g., < 1e-5) solution. Constraints: constraint_sum_W constraint_sum_aux near 0 without trimming; small deviations may occur trimming. Denominator: min_denominator > 0; negative nearâ€‘zero values indicate inconsistent auxiliary targets bad starting point. Jacobian/inversion: inspect jacobian_condition_number, jacobian_source, invert_rule (â€œplainâ€, â€œridgeâ€, â€œpinvâ€). Consider variance_ridge=TRUE variance_pseudoinverse=TRUE illâ€‘conditioned. Variance choice: strong NMAR weight trimming, prefer variance_method=\"bootstrap\". Survey designs: ensure design weights known NpopN_{\\text{pop}} correct; confint() uses survey df tâ€‘quantiles applicable. Conventions: normalization âˆ‘ipiEL\\sum_i p_i^{\\text{EL}} implicit constraints applied explicitly forming YÌ‚\\hat Y.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"model-dimensions","dir":"Articles","previous_headings":"Generalization and Stability","what":"Model Dimensions","title":"Empirical Likelihood Theory","text":"Response model dimensions: arbitrary K=ncol(Z)K = \\text{ncol}(Z); sums crossproducts generalize automatically Auxiliary constraints: arbitrary L=ncol(X)L = \\text{ncol}(X); Î»xâˆˆâ„L\\lambda_x \\\\mathbb{R}^L constraint sums columns","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"survey-design","dir":"Articles","previous_headings":"Generalization and Stability","what":"Survey Design","title":"Empirical Likelihood Theory","text":"Base weights enter aia_i totals NpopN_{\\text{pop}} nresp_weightedn_{\\text{resp\\_weighted}}; score covariance uses survey designâ€™s replication BB. CI computation uses degrees--freedom tt-quantiles is_survey=TRUE. Example (survey; evaluated build):","code":"# \\dontshow{ if (!requireNamespace(\"survey\", quietly = TRUE)) stop(\"survey not installed\") } # \\dontrun{ library(survey) dclus1 <- svydesign(id = ~dnum, weights = ~pw, data = apiclus1, fpc = ~fpc) pop_mean_ell <- mean(apiclus1$ell) eng <- el_engine(auxiliary_means = c(ell = pop_mean_ell)) fit <- nmar(   formula = list(outcome = ~ api00_miss, covariates_outcome = ~ ell, covariates_missingness = ~ NULL),   data = dclus1,   engine = eng ) confint(fit)  # uses t-quantiles with survey df # }"},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"numerical-safeguards","dir":"Articles","previous_headings":"Generalization and Stability","what":"Numerical Safeguards","title":"Empirical Likelihood Theory","text":"Bounds: cap Î·\\eta Â±50\\pm 50; bound WW (Ïµ,1âˆ’Ïµ)(\\epsilon, 1 - \\epsilon); clip pp away {0,1}\\{0,1\\} computing Î¼/p\\mu/p; lower bound DiD_i Ïµ\\epsilon Trimming: optional trim_cap piELp_i^{\\text{EL}} mass redistribution; prefer bootstrap variance trimming used Inversion: condition-aware âˆ’1A^{-1} optional ridge/pseudoinverse fallbacks full diagnostics, described Eta cap option: can adjust Î·\\eta cap via options(nmar.eta_cap = 60) (default 50) suit data scale link","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Empirical Likelihood Theory","text":"Qin, J., Leung, D., Shao, J. (2002). Estimation survey data nonignorable nonresponse informative sampling. Journal American Statistical Association, 97(457), 193-200. doi:10.1198/016214502753479338","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"appendix-el-engine-api-reference-user-facing","dir":"Articles","previous_headings":"","what":"Appendix: EL Engine API Reference (User-Facing)","title":"Empirical Likelihood Theory","text":"appendix summarizes key options EL engine (constructor: el_engine()), defaults, recommended usage. Values: â€œlogitâ€, â€œprobitâ€, family object (list name, linkinv, mu.eta, d2mu.deta2, score_eta). Notes: implement logit_family() probit_family(). use logâ€‘likelihood score score_eta(eta, delta) = mu.eta(eta)/linkinv(eta) (respondents), .e., âˆ‚logp/âˆ‚Î·\\partial\\log p/\\partial\\eta. matches paperâ€™s semiparametric MLE equations keeps analytic Jacobian familyâ€‘agnostic. Standardize ZZ/XX (Î¼x\\mu_x) using nmar_scaling_recipe numerical stability. Coefficients vcov unscaled solving. Caps EL weights redistributes mass. Improves robustness extreme weights arise. Prefer variance_method = \"bootstrap\" trimming finite. â€œdeltaâ€: analytic delta method variance via sandwich âˆ’1BAâˆ’TA^{-1} B ^{-T} numeric âˆ‡g\\nabla g. â€œbootstrapâ€: IID resampling survey replicate weights via svrep; often preferred trimming near-boundary cases. Values: â€œautoâ€, â€œanalyticâ€, â€œnumericâ€. â€œautoâ€: prefer analytic available; fall back numeric rel_diff > 1e-3 kappa_analytic > 10 * kappa_numeric. Records jacobian_source jacobian_auto_rule (â€œdefaultâ€, â€œrel_diff_highâ€, â€œkappa_ratio_highâ€). â€œanalyticâ€: force analytic . â€œnumericâ€: force numeric . Values: â€œautoâ€, â€œanalyticâ€, â€œnoneâ€. â€œautoâ€/â€œanalyticâ€: pass analytic jacobian Newton available; otherwise, Newton without jac + Broyden fallback. â€œnoneâ€: never pass jacobian; rely Newton w/o jac Broyden fallback. TRUE, allow SVD pseudoinverse singular/ill-conditioned. Diagnostics: used_pseudoinverse = TRUE, invert_rule = \"pinv\". TRUE, apply adaptive ridge epsilon = base * sigma_max() (base=1e-8 ridge_scale). numeric, use epsilon. Diagnostics: used_ridge = TRUE, invert_rule = \"ridge\", ridge_epsilon. Helpful borderline ill-conditioned rank-deficient. Number bootstrap replicates variance_method = \"bootstrap\". Increase stability, decrease speed. Passed nleqslv (e.g., ftol, xtol, maxit). defaults ftol = 1e-10, xtol = 1e-10, maxit = 100, Broyden fallback needed.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"diagnostics-glanceprint","dir":"Articles","previous_headings":"Appendix: EL Engine API Reference (User-Facing)","what":"Diagnostics (glance/print)","title":"Empirical Likelihood Theory","text":"jacobian_source: â€œanalyticâ€ â€œnumericâ€ used variance (). jacobian_rel_diff: relative Frobenius difference analytic numeric (computed). jacobian_auto_rule: reason overriding analytic (â€œdefaultâ€, â€œrel_diff_highâ€, â€œkappa_ratio_highâ€). jacobian_condition_number: kappa() used variance. invert_rule: â€œplainâ€, â€œridgeâ€, â€œpinvâ€ used ^{-1}. used_pseudoinverse, used_ridge: inversion flags.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/el_empirical_likelihood_theory.html","id":"recommended-settings","dir":"Articles","previous_headings":"Appendix: EL Engine API Reference (User-Facing)","what":"Recommended settings","title":"Empirical Likelihood Theory","text":"Default: variance_method = \"delta\", variance_jacobian = \"auto\", solver_jacobian = \"auto\", standardize = TRUE. trimming suspected weak identification: prefer variance_method = \"bootstrap\". borderline ill-conditioned: set variance_ridge = TRUE (adaptive ridge) variance_pseudoinverse = TRUE (SVD pinv). Inspect diagnostics.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/tutorial_empirical_likelihood.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Empirical Likelihood","text":"vignette demonstrates empirical likelihood (EL) estimator Missing Random (NMAR) data nmar package. method implements estimator Qin, Leung, Shao (2002), using empirical likelihood weights satisfy estimating equations response mechanism (optionally) auxiliary moment constraints. full derivations analytic Jacobian/variance details, see companion article â€œEmpirical Likelihood Theory NMARâ€. Key features: Supports data.frame (IID) survey.design objects (design-based variance) via nmar() API. Variance via delta (analytical sandwich) bootstrap. Optional standardization predictors; weight trimming robustness. Rich S3 surface: summary(), confint(), tidy(), glance(), plot()/autoplot().","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/tutorial_empirical_likelihood.html","id":"quick-start","dir":"Articles","previous_headings":"Overview","what":"Quick start","title":"Empirical Likelihood","text":"Variables outcome RHS (e.g., X1 + X2) auxiliaries; can supply known population means via auxiliary_means = c(X1 = ..., X2 = ...). Variables covariates_missingness enter response model (auxiliary constraint). need population means. Choose engine: el_engine(...), e.g., el_engine(auxiliary_means = c(X1 = 0), variance_method = \"delta\", standardize = TRUE). Fit: nmar(formula = <list>, data = df_or_design, engine = el_engine(...)). Inspect: summary(), confint(), weights(), fitted(), fit$diagnostics. # # Data-frame example (IID) simulate NMAR mechanism response probability depends unobserved outcome. Probit family (optional): Tidy/glance summaries, plots: Outputs diagnostics glance: Bootstrap variance (keep reps small speed):","code":"N <- 500 X <- rnorm(N) Z <- rnorm(N) Y <- 2 + 0.5 * X + Z  # NMAR response: depends on Y p <- plogis(-1.0 + 0.4 * scale(Y)[, 1]) R <- runif(N) < p  dat <- data.frame(Y_miss = Y, X = X) dat$Y_miss[!R] <- NA_real_ engine = el_engine(auxiliary_means = c(X = 0), variance_method = \"delta\", standardize = TRUE   ) # Fit EL estimator (delta variance) fit <- nmar(   formula = Y_miss ~ X,   data = dat,   engine = engine,   response_predictors = NULL )  summary(fit) #> NMAR Model Summary #> ================= #> Y_miss estimate: 1.878660 #> Std. Error: 0.251403 #> 95% CI: (1.385920, 2.371400) #> Converged: TRUE  #> Variance method: delta  #> Variance notes: Calculation successful  #> Total units: 500  #> Respondents: 150  #> Call: #> el.data.frame(data = list(Y_miss = c(1.11786933073888, 0.891212664159646,  #> 3.80613921314947, NA, NA, NA, NA, -0.703281687845231, 1.80669370524138,  #> 1.69795730569143, NA, 2.39605945532991, NA, NA, NA, 2.15865731648026,  #> NA, NA, NA, 1.57929542729365, NA, NA, NA, 1.35960921692889, 2.80212891143735,  #> NA, NA, NA, NA, NA, NA, NA, NA, 2.56705970945065, 4.35664175855018,  #> NA, NA, NA, NA, NA, NA, 1.42734158120811, NA, NA, NA, NA, NA,  #> 2.40616432108892, 4.82020921151267, NA, NA, 1.20352477670625,  #> NA, 2.93412586193379, NA, 1.29926457367785, NA, NA, NA, NA, 1.35597616084494,  #> NA, NA, NA, NA, 2.25284347209741, 2.75709417614119, 2.61323745245788,  #> NA, NA, 2.71574856878141, NA, NA, NA, NA, NA, NA, NA, NA, 1.95665454410672,  #> 1.68646622475295, NA, NA, 2.82084631808934, NA, NA, NA, NA, NA,  #> NA, NA, 2.73916647053989, 2.95990569451672, 1.40020153838893,  #> 3.18445247885661, NA, NA, NA, NA, 3.34670041138977, NA, NA, NA,  #> NA, NA, NA, 0.950804839910387, NA, NA, NA, NA, NA, 2.87864812880112,  #> NA, NA, NA, NA, 1.00416470425524, NA, NA, NA, NA, 2.60115756372936,  #> 2.0501440923189, NA, 2.61519085587644, NA, NA, NA, NA, 2.04377228379324,  #> NA, 2.55387582375012, 2.09898183989108, NA, NA, NA, NA, NA, NA,  #> NA, 2.13996801204931, NA, 1.87237791980185, 0.803433962923807,  #> 2.63390079211795, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,  #> NA, 3.25753898833842, NA, NA, 2.85592602498151, NA, NA, NA, NA,  #> 2.5238460454669, NA, NA, NA, 1.37432731601133, NA, 2.38080858193111,  #> NA, NA, -0.509705732422634, NA, NA, 1.36463804272785, NA, NA,  #> NA, 1.09779127693569, NA, NA, 1.48682332646205, NA, NA, 2.05570205042387,  #> NA, NA, 3.02484385490614, NA, NA, NA, NA, NA, NA, NA, -0.206779498917775,  #> NA, NA, NA, 2.39044646262061, NA, NA, 1.89504260989221, NA, NA,  #> 2.72106709995112, NA, NA, 2.52260114533162, 1.65525394954568,  #> NA, 3.96292035847959, 2.6138199593044, NA, NA, NA, NA, NA, NA,  #> 0.824483645737372, NA, 2.28012279004063, 2.21156915846585, NA,  #> NA, 2.47856957059369, NA, NA, NA, NA, NA, NA, NA, 2.11280512925553,  #> 2.08688897443196, NA, 2.31729093705924, NA, 5.1309570301535,  #> NA, NA, NA, 4.64122656058171, NA, 4.04234999745836, 2.61737355745743,  #> NA, NA, NA, NA, NA, 1.83532361930806, NA, NA, -0.0945024421938705,  #> NA, NA, NA, NA, 0.957997817964329, NA, 3.74164973943895, 3.21000319930318,  #> NA, 1.48371748178133, 3.53244144341469, NA, NA, 2.79961679406569,  #> -0.31541094028096, NA, NA, NA, NA, NA, 1.73326532062576, NA,  #> NA, NA, NA, NA, 1.47402195702891, NA, 0.862217908331818, NA,  #> NA, 2.97858678451513, NA, 3.45938059228624, NA, NA, 2.85217857199687,  #> 3.3217910851728, NA, NA, NA, NA, NA, 2.38593285326074, NA, NA,  #> 2.30969424894168, NA, NA, NA, 2.86049298042027, NA, 0.813105616867448,  #> NA, NA, NA, NA, 1.75301192367766, NA, 1.92070181117748, NA, NA,  #> NA, NA, NA, NA, 1.74998065871254, NA, 0.463863532273996, NA,  #> NA, 3.56310159045139, NA, NA, NA, NA, 1.25776749613549, -0.433086245437266,  #> NA, NA, NA, NA, 5.16436168812071, NA, NA, 2.62380091406307, 1.09736268565487,  #> NA, NA, NA, NA, NA, NA, 2.80281557409945, NA, NA, 1.56342022346128,  #> 0.746865545869773, 1.63256409316893, NA, 4.90935028061355, NA,  #> NA, NA, NA, NA, 4.44812952784634, NA, NA, NA, NA, NA, NA, NA,  #> NA, 3.73884576217742, 3.65598048714365, NA, NA, 3.23927020207819,  #> NA, NA, 1.12312094637029, NA, NA, NA, 3.14664240010495, NA, NA,  #> 1.01757125140048, NA, NA, 1.48321822259141, NA, NA, NA, NA, 1.85397346769852,  #> NA, NA, NA, NA, NA, 1.98221955228511, NA, NA, NA, 2.65104578204186,  #> NA, NA, NA, NA, NA, 2.42754869874855, 0.158668381543694, NA,  #> 1.77503399570692, 3.39919173186142, NA, NA, 3.31573077572703,  #> NA, NA, NA, NA, NA, NA, 3.10323864957989, NA, 5.30478208792561,  #> NA, NA, NA, 2.15287532022513, NA, 1.99858380750331, NA, 1.66953601017944,  #> NA, 0.673001636356519, NA, NA, 1.86740951654826, 0.644034864532564,  #> 1.05547165741333, 1.2196824883296, NA, NA, 4.44833210080624,  #> NA, NA, NA, NA, 2.37380018172917, NA, NA, NA, NA, 2.06795628226048,  #> NA, NA, 3.22015335613371, NA, NA, 1.85139103819851, NA, NA, 0.52197723029947,  #> 1.19100406093598, NA, 1.98143399234759, 3.04244605206696, NA,  #> NA, NA, NA, NA, NA, 1.91680187242138, NA, NA, 4.31528733630821,  #> NA, NA, NA, NA, 1.61994509200149, 2.3752997316521, NA, NA, NA,  #> NA, NA, NA, NA, NA, NA, NA, NA, NA, 2.02688817935388), X = c(-0.560475646552213,  #> -0.23017748948328, 1.55870831414912, 0.070508391424576, 0.129287735160946,  #> 1.71506498688328, 0.460916205989202, -1.26506123460653, -0.686852851893526,  #> -0.445661970099958, 1.22408179743946, 0.359813827057364, 0.400771450594052,  #> 0.11068271594512, -0.555841134754075, 1.78691313680308, 0.497850478229239,  #> -1.96661715662964, 0.701355901563686, -0.472791407727934, -1.06782370598685,  #> -0.217974914658295, -1.02600444830724, -0.72889122929114, -0.625039267849257,  #> -1.68669331074241, 0.837787044494525, 0.153373117836515, -1.13813693701195,  #> 1.25381492106993, 0.426464221476814, -0.295071482992271, 0.895125661045022,  #> 0.878133487533042, 0.821581081637487, 0.688640254100091, 0.553917653537589,  #> -0.0619117105767217, -0.305962663739917, -0.380471001012383,  #> -0.694706978920513, -0.207917278019599, -1.26539635156826, 2.16895596533851,  #> 1.20796199830499, -1.12310858320335, -0.402884835299076, -0.466655353623219,  #> 0.779965118336318, -0.0833690664718293, 0.253318513994755, -0.028546755348703,  #> -0.0428704572913161, 1.36860228401446, -0.225770985659268, 1.51647060442954,  #> -1.54875280423022, 0.584613749636069, 0.123854243844614, 0.215941568743973,  #> 0.379639482759882, -0.502323453109302, -0.33320738366942, -1.01857538310709,  #> -1.07179122647558, 0.303528641404258, 0.448209778629426, 0.0530042267305041,  #> 0.922267467879738, 2.05008468562714, -0.491031166056535, -2.30916887564081,  #> 1.00573852446226, -0.709200762582393, -0.688008616467358, 1.0255713696967,  #> -0.284773007051009, -1.22071771225454, 0.18130347974915, -0.138891362439045,  #> 0.00576418589988693, 0.38528040112633, -0.370660031792409, 0.644376548518833,  #> -0.220486561818751, 0.331781963915697, 1.09683901314935, 0.435181490833803,  #> -0.325931585531227, 1.14880761845109, 0.993503855962119, 0.54839695950807,  #> 0.238731735111441, -0.627906076039371, 1.36065244853001, -0.600259587147127,  #> 2.18733299301658, 1.53261062618519, -0.235700359100477, -1.02642090030678,  #> -0.710406563699301, 0.25688370915653, -0.246691878462374, -0.347542599397733,  #> -0.951618567265016, -0.0450277248089203, -0.784904469457076,  #> -1.66794193658814, -0.380226520287762, 0.918996609060766, -0.575346962608392,  #> 0.607964322225033, -1.61788270828916, -0.0555619655245394, 0.519407203943462,  #> 0.301153362166714, 0.105676194148943, -0.640706008305376, -0.849704346033582,  #> -1.02412879060491, 0.117646597100126, -0.947474614184802, -0.490557443700668,  #> -0.256092192198247, 1.84386200523221, -0.651949901695459, 0.235386572284857,  #> 0.0779608495637108, -0.961856634130129, -0.0713080861235987,  #> 1.44455085842335, 0.451504053079215, 0.0412329219929399, -0.422496832339625,  #> -2.05324722154052, 1.13133721341418, -1.46064007092482, 0.739947510877334,  #> 1.90910356921748, -1.4438931609718, 0.701784335374711, -0.262197489402468,  #> -1.57214415914549, -1.51466765378175, -1.60153617357459, -0.530906522170303,  #> -1.4617555849959, 0.687916772975828, 2.10010894052567, -1.28703047603518,  #> 0.787738847475178, 0.76904224100091, 0.332202578950118, -1.00837660827701,  #> -0.119452606630659, -0.280395335170247, 0.56298953322048, -0.372438756103829,  #> 0.976973386685621, -0.374580857767014, 1.05271146557933, -1.04917700666607,  #> -1.26015524475811, 3.2410399349424, -0.416857588160432, 0.298227591540715,  #> 0.636569674033849, -0.483780625708744, 0.516862044313609, 0.368964527385086,  #> -0.215380507641693, 0.0652930335253153, -0.034067253738464, 2.12845189901618,  #> -0.741336096272828, -1.09599626707466, 0.0377883991710788, 0.310480749443137,  #> 0.436523478910183, -0.458365332711106, -1.06332613397119, 1.26318517608949,  #> -0.349650387953555, -0.865512862653374, -0.236279568941097, -0.197175894348552,  #> 1.10992028971364, 0.0847372921971965, 0.754053785184521, -0.499292017172261,  #> 0.214445309581601, -0.324685911490835, 0.0945835281735714, -0.895363357977542,  #> -1.31080153332797, 1.99721338474797, 0.600708823672418, -1.25127136162494,  #> -0.611165916680421, -1.18548008459731, 2.19881034888372, 1.31241297643351,  #> -0.265145056696353, 0.54319405923209, -0.41433994791886, -0.476246894615578,  #> -0.788602837850243, -0.594617267459511, 1.65090746733669, -0.0540281250854405,  #> 0.119245236427584, 0.243687429599092, 1.23247587848534, -0.51606383094478,  #> -0.992507150392037, 1.67569693240319, -0.441163216905286, -0.723065969939874,  #> -1.23627311888329, -1.2847157223178, -0.573973479297987, 0.617985817166529,  #> 1.10984813892972, 0.707588353835588, -0.363657297095253, 0.0597499373846007,  #> -0.70459646368007, -0.71721816157401, 0.88465049897692, -1.01559257860354,  #> 1.95529396549246, -0.0903195939658516, 0.214538826629216, -0.738527704739573,  #> -0.57438868976327, -1.31701613230524, -0.182925388372727, 0.418982404924464,  #> 0.32430434416138, -0.781536487054751, -0.788621970854002, -0.502198718342861,  #> 1.49606066984635, -1.13730362066574, -0.179051594380198, 1.90236182167893,  #> -0.100974885328808, -1.35984070382139, -0.664769435274062, 0.485459978904878,  #> -0.375602871669773, -0.561876363549783, -0.343917234128459, 0.0904966471392212,  #> 1.59850877114583, -0.088565112138884, 1.08079949615152, 0.630754115650567,  #> -0.113639895506141, -1.5329020028906, -0.52111731755252, -0.489870453138474,  #> 0.0471544327615272, 1.30019867766682, 2.29307897383109, 1.54758105898377,  #> -0.133150964328944, -1.75652739555764, -0.388779864071743, 0.0892072230732945,  #> 0.845013004067436, 0.962527968484271, 0.684309429416465, -1.39527434979947,  #> 0.849643045633355, -0.446557216427222, 0.174802700161256, 0.0745511771737346,  #> 0.428166764970505, 0.0246749828261399, -1.66747509758566, 0.736495964773442,  #> 0.386026568349676, -0.265651625278222, 0.118144511046681, 0.134038645368463,  #> 0.221019468561002, 1.64084616597749, -0.219050378933476, 0.168065383884658,  #> 1.16838387306909, 1.05418102337692, 1.14526311038036, -0.577468001059557,  #> 2.00248273029283, 0.066700870930183, 1.86685184470686, -1.35090268603071,  #> 0.0209835863542375, 1.24991457096922, -0.715242187222796, -0.752688968217742,  #> -0.938538703606894, -1.05251327933874, -0.437159533180399, 0.331179172958982,  #> -2.01421049792072, 0.211980433372292, 1.23667504641657, 2.03757401824044,  #> 1.30117599220059, 0.756774763795962, -1.72673039911433, -0.601506708006782,  #> -0.352046456582617, 0.703523902756894, -0.105671334003774, -1.25864862806017,  #> 1.68443570809411, 0.911391291795963, 0.237430272491026, 1.21810861032581,  #> -1.33877428723497, 0.6608202977898, -0.522912376313422, 0.683745521850712,  #> -0.0608219546600742, 0.632960713031451, 1.33551761505939, 0.00729009031689879,  #> 1.01755863695209, -1.18843403514798, -0.721604440436015, 1.51921771138818,  #> 0.377387973023929, -2.05222282043373, -1.36403745208238, -0.200781015589121,  #> 0.865779404334488, -0.101883255715222, 0.624187472020653, 0.959005377787825,  #> 1.67105482886294, 0.0560167332749619, -0.051981906180899, -1.75323735914227,  #> 0.0993275940878275, -0.571850057895563, -0.974009582804091, -0.17990623104754,  #> 1.01494317274366, -1.99274848868858, -0.427279287205429, 0.116637283582706,  #> -0.893207570054953, 0.333902942499225, 0.411429920615731, -0.0330361592759917,  #> -2.46589819376003, 2.57145814586664, -0.205299257468199, 0.65119328158767,  #> 0.273766491036548, 1.02467323481835, 0.817659446374088, -0.209793171228509,  #> 0.378167772208507, -0.945408831123893, 0.856923010899318, -0.461038338884354,  #> 2.41677335378821, -1.65104889568819, -0.463987242966015, 0.825379862759242,  #> 0.510132546878663, -0.589481038515, -0.996780742207522, 0.144475704710697,  #> -0.0143074131669134, -1.79028123726406, 0.034551067133851, 0.190230315692457,  #> 0.174726396981842, -1.05501704260268, 0.476133278302629, 1.37857013695924,  #> 0.456236403179813, -1.13558847037434, -0.435645469691905, 0.346103619553607,  #> -0.647045631318269, -2.15764633501528, 0.884250820028209, -0.829477611624518,  #> -0.573560270768283, 1.50390060900454, -0.774144929605405, 0.845731540189296,  #> -1.26068287881878, -0.354542403073978, -0.0735560191364783, -1.16865142442436,  #> -0.634748264908909, -0.0288415529283144, 0.67069596873393, -1.65054654342511,  #> -0.349754239211268, 0.756406438545484, -0.538809159977592, 0.227291921672942,  #> 0.492228570064431, 0.267835015331683, 0.653257679471382, -0.12270866097738,  #> -0.41367651359212, -2.64314895202898, -0.092941018479472, 0.430284696359987,  #> 0.53539884086815, -0.555278351313252, 1.77950290977515, 0.286424419628825,  #> 0.126315858458886, 1.27226677946852, -0.718466221319259, -0.450338623924712,  #> 2.39745248004976, 0.011129187220888, 1.63356842140831, -1.43850664491452,  #> -0.190516802042901, 0.378423903636832, 0.300038545205798, -1.00563625951084,  #> 0.0192592746253708, -1.07742065311198, 0.712703325244282, 1.08477508986065,  #> -2.22498769648741, 1.23569346230014, -1.24104449680849, 0.454769268982633,  #> 0.659902638142608, -0.199889828101433, -0.645113956859792, 0.16532102124205,  #> 0.438818700714454, 0.883302819948705, -2.05233698390195, -1.63637926805902,  #> 1.43040234118818, 1.04662884711155, 0.435288948907682, 0.71517840711106,  #> 0.917174917641003, -2.66092279846568, 1.11027709663882, -0.484987596562325,  #> 0.230616830631202, -0.295157800883577, 0.871964954078744, -0.348472448955611,  #> 0.518503765888248, -0.390684978638979, -1.09278720910151, 1.21001051044026,  #> 0.740900011274274, 1.72426223915645, 0.0651539325793032, 1.12500274582817,  #> 1.97541905401908, -0.281482115038967, -1.32295111275522, -0.239351567138116,  #> -0.214041239985383, 0.15168050450932, 1.71230497731928, -0.326143892505348,  #> 0.373004655804915, -0.227684064895531, 0.0204507085250325, 0.314057663506262,  #> 1.32821469603699, 0.121318377490778, 0.712842320031113, 0.778860029783535,  #> 0.914773270855634, -0.574394552184383, 1.62688121419468, -0.380956739294013,  #> -0.105784167649752, 1.40405026771417, 1.29408390614558, -1.08999187241124,  #> -0.873071000417463, -1.35807905937061, 0.181847192619832, 0.164840867918466,  #> 0.364114687355063, 0.552157714218558)), formula = Y_miss ~ X,  #>     response_predictors = NULL, auxiliary_means = c(X = 0), standardize = TRUE,  #>     trim_cap = Inf, control = list(), on_failure = \"return\",  #>     variance_method = \"delta\", variance_jacobian = \"auto\", solver_jacobian = \"auto\",  #>     variance_pseudoinverse = FALSE, bootstrap_reps = 500, suppress_warnings = FALSE,  #>     family = list(name = \"logit\", linkinv = function (eta)  #>     stats::plogis(eta), mu.eta = function (eta)  #>     { #>         p <- stats::plogis(eta) #>         p * (1 - p) #>     }, d2mu.deta2 = function (eta)  #>     { #>         p <- stats::plogis(eta) #>         p * (1 - p) * (1 - 2 * p) #>     }, score_eta = function (eta, delta)  #>     { #>         if (missing(delta))  #>             delta <- 1 #>         delta <- validate_delta(delta) #>         p <- stats::plogis(eta) #>         delta - p #>     })) #>  #> Response-model coefficients: #>               Estimate Std. Error   z value    Pr(>|z|) #> (Intercept) -1.5706942  0.5001079 -3.140711 0.001685384 #> Y_miss       0.3667545  0.2793335  1.312963 0.189195444 confint(fit) #>          2.5 % 97.5 % #> Y_miss 1.38592 2.3714 engine = el_engine(auxiliary_means = c(X = 0), family = \"probit\", variance_method = \"delta\", standardize = TRUE)  fit_probit <- nmar(   formula = Y_miss ~ X,   engine = engine,   data = dat,   response_predictors = NULL  ) summary(fit_probit) #> NMAR Model Summary #> ================= #> Y_miss estimate: 1.880128 #> Std. Error: 0.248300 #> 95% CI: (1.393469, 2.366787) #> Converged: TRUE  #> Variance method: delta  #> Variance notes: Calculation successful  #> Total units: 500  #> Respondents: 150  #> Call: #> el.data.frame(data = list(Y_miss = c(1.11786933073888, 0.891212664159646,  #> 3.80613921314947, NA, NA, NA, NA, -0.703281687845231, 1.80669370524138,  #> 1.69795730569143, NA, 2.39605945532991, NA, NA, NA, 2.15865731648026,  #> NA, NA, NA, 1.57929542729365, NA, NA, NA, 1.35960921692889, 2.80212891143735,  #> NA, NA, NA, NA, NA, NA, NA, NA, 2.56705970945065, 4.35664175855018,  #> NA, NA, NA, NA, NA, NA, 1.42734158120811, NA, NA, NA, NA, NA,  #> 2.40616432108892, 4.82020921151267, NA, NA, 1.20352477670625,  #> NA, 2.93412586193379, NA, 1.29926457367785, NA, NA, NA, NA, 1.35597616084494,  #> NA, NA, NA, NA, 2.25284347209741, 2.75709417614119, 2.61323745245788,  #> NA, NA, 2.71574856878141, NA, NA, NA, NA, NA, NA, NA, NA, 1.95665454410672,  #> 1.68646622475295, NA, NA, 2.82084631808934, NA, NA, NA, NA, NA,  #> NA, NA, 2.73916647053989, 2.95990569451672, 1.40020153838893,  #> 3.18445247885661, NA, NA, NA, NA, 3.34670041138977, NA, NA, NA,  #> NA, NA, NA, 0.950804839910387, NA, NA, NA, NA, NA, 2.87864812880112,  #> NA, NA, NA, NA, 1.00416470425524, NA, NA, NA, NA, 2.60115756372936,  #> 2.0501440923189, NA, 2.61519085587644, NA, NA, NA, NA, 2.04377228379324,  #> NA, 2.55387582375012, 2.09898183989108, NA, NA, NA, NA, NA, NA,  #> NA, 2.13996801204931, NA, 1.87237791980185, 0.803433962923807,  #> 2.63390079211795, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,  #> NA, 3.25753898833842, NA, NA, 2.85592602498151, NA, NA, NA, NA,  #> 2.5238460454669, NA, NA, NA, 1.37432731601133, NA, 2.38080858193111,  #> NA, NA, -0.509705732422634, NA, NA, 1.36463804272785, NA, NA,  #> NA, 1.09779127693569, NA, NA, 1.48682332646205, NA, NA, 2.05570205042387,  #> NA, NA, 3.02484385490614, NA, NA, NA, NA, NA, NA, NA, -0.206779498917775,  #> NA, NA, NA, 2.39044646262061, NA, NA, 1.89504260989221, NA, NA,  #> 2.72106709995112, NA, NA, 2.52260114533162, 1.65525394954568,  #> NA, 3.96292035847959, 2.6138199593044, NA, NA, NA, NA, NA, NA,  #> 0.824483645737372, NA, 2.28012279004063, 2.21156915846585, NA,  #> NA, 2.47856957059369, NA, NA, NA, NA, NA, NA, NA, 2.11280512925553,  #> 2.08688897443196, NA, 2.31729093705924, NA, 5.1309570301535,  #> NA, NA, NA, 4.64122656058171, NA, 4.04234999745836, 2.61737355745743,  #> NA, NA, NA, NA, NA, 1.83532361930806, NA, NA, -0.0945024421938705,  #> NA, NA, NA, NA, 0.957997817964329, NA, 3.74164973943895, 3.21000319930318,  #> NA, 1.48371748178133, 3.53244144341469, NA, NA, 2.79961679406569,  #> -0.31541094028096, NA, NA, NA, NA, NA, 1.73326532062576, NA,  #> NA, NA, NA, NA, 1.47402195702891, NA, 0.862217908331818, NA,  #> NA, 2.97858678451513, NA, 3.45938059228624, NA, NA, 2.85217857199687,  #> 3.3217910851728, NA, NA, NA, NA, NA, 2.38593285326074, NA, NA,  #> 2.30969424894168, NA, NA, NA, 2.86049298042027, NA, 0.813105616867448,  #> NA, NA, NA, NA, 1.75301192367766, NA, 1.92070181117748, NA, NA,  #> NA, NA, NA, NA, 1.74998065871254, NA, 0.463863532273996, NA,  #> NA, 3.56310159045139, NA, NA, NA, NA, 1.25776749613549, -0.433086245437266,  #> NA, NA, NA, NA, 5.16436168812071, NA, NA, 2.62380091406307, 1.09736268565487,  #> NA, NA, NA, NA, NA, NA, 2.80281557409945, NA, NA, 1.56342022346128,  #> 0.746865545869773, 1.63256409316893, NA, 4.90935028061355, NA,  #> NA, NA, NA, NA, 4.44812952784634, NA, NA, NA, NA, NA, NA, NA,  #> NA, 3.73884576217742, 3.65598048714365, NA, NA, 3.23927020207819,  #> NA, NA, 1.12312094637029, NA, NA, NA, 3.14664240010495, NA, NA,  #> 1.01757125140048, NA, NA, 1.48321822259141, NA, NA, NA, NA, 1.85397346769852,  #> NA, NA, NA, NA, NA, 1.98221955228511, NA, NA, NA, 2.65104578204186,  #> NA, NA, NA, NA, NA, 2.42754869874855, 0.158668381543694, NA,  #> 1.77503399570692, 3.39919173186142, NA, NA, 3.31573077572703,  #> NA, NA, NA, NA, NA, NA, 3.10323864957989, NA, 5.30478208792561,  #> NA, NA, NA, 2.15287532022513, NA, 1.99858380750331, NA, 1.66953601017944,  #> NA, 0.673001636356519, NA, NA, 1.86740951654826, 0.644034864532564,  #> 1.05547165741333, 1.2196824883296, NA, NA, 4.44833210080624,  #> NA, NA, NA, NA, 2.37380018172917, NA, NA, NA, NA, 2.06795628226048,  #> NA, NA, 3.22015335613371, NA, NA, 1.85139103819851, NA, NA, 0.52197723029947,  #> 1.19100406093598, NA, 1.98143399234759, 3.04244605206696, NA,  #> NA, NA, NA, NA, NA, 1.91680187242138, NA, NA, 4.31528733630821,  #> NA, NA, NA, NA, 1.61994509200149, 2.3752997316521, NA, NA, NA,  #> NA, NA, NA, NA, NA, NA, NA, NA, NA, 2.02688817935388), X = c(-0.560475646552213,  #> -0.23017748948328, 1.55870831414912, 0.070508391424576, 0.129287735160946,  #> 1.71506498688328, 0.460916205989202, -1.26506123460653, -0.686852851893526,  #> -0.445661970099958, 1.22408179743946, 0.359813827057364, 0.400771450594052,  #> 0.11068271594512, -0.555841134754075, 1.78691313680308, 0.497850478229239,  #> -1.96661715662964, 0.701355901563686, -0.472791407727934, -1.06782370598685,  #> -0.217974914658295, -1.02600444830724, -0.72889122929114, -0.625039267849257,  #> -1.68669331074241, 0.837787044494525, 0.153373117836515, -1.13813693701195,  #> 1.25381492106993, 0.426464221476814, -0.295071482992271, 0.895125661045022,  #> 0.878133487533042, 0.821581081637487, 0.688640254100091, 0.553917653537589,  #> -0.0619117105767217, -0.305962663739917, -0.380471001012383,  #> -0.694706978920513, -0.207917278019599, -1.26539635156826, 2.16895596533851,  #> 1.20796199830499, -1.12310858320335, -0.402884835299076, -0.466655353623219,  #> 0.779965118336318, -0.0833690664718293, 0.253318513994755, -0.028546755348703,  #> -0.0428704572913161, 1.36860228401446, -0.225770985659268, 1.51647060442954,  #> -1.54875280423022, 0.584613749636069, 0.123854243844614, 0.215941568743973,  #> 0.379639482759882, -0.502323453109302, -0.33320738366942, -1.01857538310709,  #> -1.07179122647558, 0.303528641404258, 0.448209778629426, 0.0530042267305041,  #> 0.922267467879738, 2.05008468562714, -0.491031166056535, -2.30916887564081,  #> 1.00573852446226, -0.709200762582393, -0.688008616467358, 1.0255713696967,  #> -0.284773007051009, -1.22071771225454, 0.18130347974915, -0.138891362439045,  #> 0.00576418589988693, 0.38528040112633, -0.370660031792409, 0.644376548518833,  #> -0.220486561818751, 0.331781963915697, 1.09683901314935, 0.435181490833803,  #> -0.325931585531227, 1.14880761845109, 0.993503855962119, 0.54839695950807,  #> 0.238731735111441, -0.627906076039371, 1.36065244853001, -0.600259587147127,  #> 2.18733299301658, 1.53261062618519, -0.235700359100477, -1.02642090030678,  #> -0.710406563699301, 0.25688370915653, -0.246691878462374, -0.347542599397733,  #> -0.951618567265016, -0.0450277248089203, -0.784904469457076,  #> -1.66794193658814, -0.380226520287762, 0.918996609060766, -0.575346962608392,  #> 0.607964322225033, -1.61788270828916, -0.0555619655245394, 0.519407203943462,  #> 0.301153362166714, 0.105676194148943, -0.640706008305376, -0.849704346033582,  #> -1.02412879060491, 0.117646597100126, -0.947474614184802, -0.490557443700668,  #> -0.256092192198247, 1.84386200523221, -0.651949901695459, 0.235386572284857,  #> 0.0779608495637108, -0.961856634130129, -0.0713080861235987,  #> 1.44455085842335, 0.451504053079215, 0.0412329219929399, -0.422496832339625,  #> -2.05324722154052, 1.13133721341418, -1.46064007092482, 0.739947510877334,  #> 1.90910356921748, -1.4438931609718, 0.701784335374711, -0.262197489402468,  #> -1.57214415914549, -1.51466765378175, -1.60153617357459, -0.530906522170303,  #> -1.4617555849959, 0.687916772975828, 2.10010894052567, -1.28703047603518,  #> 0.787738847475178, 0.76904224100091, 0.332202578950118, -1.00837660827701,  #> -0.119452606630659, -0.280395335170247, 0.56298953322048, -0.372438756103829,  #> 0.976973386685621, -0.374580857767014, 1.05271146557933, -1.04917700666607,  #> -1.26015524475811, 3.2410399349424, -0.416857588160432, 0.298227591540715,  #> 0.636569674033849, -0.483780625708744, 0.516862044313609, 0.368964527385086,  #> -0.215380507641693, 0.0652930335253153, -0.034067253738464, 2.12845189901618,  #> -0.741336096272828, -1.09599626707466, 0.0377883991710788, 0.310480749443137,  #> 0.436523478910183, -0.458365332711106, -1.06332613397119, 1.26318517608949,  #> -0.349650387953555, -0.865512862653374, -0.236279568941097, -0.197175894348552,  #> 1.10992028971364, 0.0847372921971965, 0.754053785184521, -0.499292017172261,  #> 0.214445309581601, -0.324685911490835, 0.0945835281735714, -0.895363357977542,  #> -1.31080153332797, 1.99721338474797, 0.600708823672418, -1.25127136162494,  #> -0.611165916680421, -1.18548008459731, 2.19881034888372, 1.31241297643351,  #> -0.265145056696353, 0.54319405923209, -0.41433994791886, -0.476246894615578,  #> -0.788602837850243, -0.594617267459511, 1.65090746733669, -0.0540281250854405,  #> 0.119245236427584, 0.243687429599092, 1.23247587848534, -0.51606383094478,  #> -0.992507150392037, 1.67569693240319, -0.441163216905286, -0.723065969939874,  #> -1.23627311888329, -1.2847157223178, -0.573973479297987, 0.617985817166529,  #> 1.10984813892972, 0.707588353835588, -0.363657297095253, 0.0597499373846007,  #> -0.70459646368007, -0.71721816157401, 0.88465049897692, -1.01559257860354,  #> 1.95529396549246, -0.0903195939658516, 0.214538826629216, -0.738527704739573,  #> -0.57438868976327, -1.31701613230524, -0.182925388372727, 0.418982404924464,  #> 0.32430434416138, -0.781536487054751, -0.788621970854002, -0.502198718342861,  #> 1.49606066984635, -1.13730362066574, -0.179051594380198, 1.90236182167893,  #> -0.100974885328808, -1.35984070382139, -0.664769435274062, 0.485459978904878,  #> -0.375602871669773, -0.561876363549783, -0.343917234128459, 0.0904966471392212,  #> 1.59850877114583, -0.088565112138884, 1.08079949615152, 0.630754115650567,  #> -0.113639895506141, -1.5329020028906, -0.52111731755252, -0.489870453138474,  #> 0.0471544327615272, 1.30019867766682, 2.29307897383109, 1.54758105898377,  #> -0.133150964328944, -1.75652739555764, -0.388779864071743, 0.0892072230732945,  #> 0.845013004067436, 0.962527968484271, 0.684309429416465, -1.39527434979947,  #> 0.849643045633355, -0.446557216427222, 0.174802700161256, 0.0745511771737346,  #> 0.428166764970505, 0.0246749828261399, -1.66747509758566, 0.736495964773442,  #> 0.386026568349676, -0.265651625278222, 0.118144511046681, 0.134038645368463,  #> 0.221019468561002, 1.64084616597749, -0.219050378933476, 0.168065383884658,  #> 1.16838387306909, 1.05418102337692, 1.14526311038036, -0.577468001059557,  #> 2.00248273029283, 0.066700870930183, 1.86685184470686, -1.35090268603071,  #> 0.0209835863542375, 1.24991457096922, -0.715242187222796, -0.752688968217742,  #> -0.938538703606894, -1.05251327933874, -0.437159533180399, 0.331179172958982,  #> -2.01421049792072, 0.211980433372292, 1.23667504641657, 2.03757401824044,  #> 1.30117599220059, 0.756774763795962, -1.72673039911433, -0.601506708006782,  #> -0.352046456582617, 0.703523902756894, -0.105671334003774, -1.25864862806017,  #> 1.68443570809411, 0.911391291795963, 0.237430272491026, 1.21810861032581,  #> -1.33877428723497, 0.6608202977898, -0.522912376313422, 0.683745521850712,  #> -0.0608219546600742, 0.632960713031451, 1.33551761505939, 0.00729009031689879,  #> 1.01755863695209, -1.18843403514798, -0.721604440436015, 1.51921771138818,  #> 0.377387973023929, -2.05222282043373, -1.36403745208238, -0.200781015589121,  #> 0.865779404334488, -0.101883255715222, 0.624187472020653, 0.959005377787825,  #> 1.67105482886294, 0.0560167332749619, -0.051981906180899, -1.75323735914227,  #> 0.0993275940878275, -0.571850057895563, -0.974009582804091, -0.17990623104754,  #> 1.01494317274366, -1.99274848868858, -0.427279287205429, 0.116637283582706,  #> -0.893207570054953, 0.333902942499225, 0.411429920615731, -0.0330361592759917,  #> -2.46589819376003, 2.57145814586664, -0.205299257468199, 0.65119328158767,  #> 0.273766491036548, 1.02467323481835, 0.817659446374088, -0.209793171228509,  #> 0.378167772208507, -0.945408831123893, 0.856923010899318, -0.461038338884354,  #> 2.41677335378821, -1.65104889568819, -0.463987242966015, 0.825379862759242,  #> 0.510132546878663, -0.589481038515, -0.996780742207522, 0.144475704710697,  #> -0.0143074131669134, -1.79028123726406, 0.034551067133851, 0.190230315692457,  #> 0.174726396981842, -1.05501704260268, 0.476133278302629, 1.37857013695924,  #> 0.456236403179813, -1.13558847037434, -0.435645469691905, 0.346103619553607,  #> -0.647045631318269, -2.15764633501528, 0.884250820028209, -0.829477611624518,  #> -0.573560270768283, 1.50390060900454, -0.774144929605405, 0.845731540189296,  #> -1.26068287881878, -0.354542403073978, -0.0735560191364783, -1.16865142442436,  #> -0.634748264908909, -0.0288415529283144, 0.67069596873393, -1.65054654342511,  #> -0.349754239211268, 0.756406438545484, -0.538809159977592, 0.227291921672942,  #> 0.492228570064431, 0.267835015331683, 0.653257679471382, -0.12270866097738,  #> -0.41367651359212, -2.64314895202898, -0.092941018479472, 0.430284696359987,  #> 0.53539884086815, -0.555278351313252, 1.77950290977515, 0.286424419628825,  #> 0.126315858458886, 1.27226677946852, -0.718466221319259, -0.450338623924712,  #> 2.39745248004976, 0.011129187220888, 1.63356842140831, -1.43850664491452,  #> -0.190516802042901, 0.378423903636832, 0.300038545205798, -1.00563625951084,  #> 0.0192592746253708, -1.07742065311198, 0.712703325244282, 1.08477508986065,  #> -2.22498769648741, 1.23569346230014, -1.24104449680849, 0.454769268982633,  #> 0.659902638142608, -0.199889828101433, -0.645113956859792, 0.16532102124205,  #> 0.438818700714454, 0.883302819948705, -2.05233698390195, -1.63637926805902,  #> 1.43040234118818, 1.04662884711155, 0.435288948907682, 0.71517840711106,  #> 0.917174917641003, -2.66092279846568, 1.11027709663882, -0.484987596562325,  #> 0.230616830631202, -0.295157800883577, 0.871964954078744, -0.348472448955611,  #> 0.518503765888248, -0.390684978638979, -1.09278720910151, 1.21001051044026,  #> 0.740900011274274, 1.72426223915645, 0.0651539325793032, 1.12500274582817,  #> 1.97541905401908, -0.281482115038967, -1.32295111275522, -0.239351567138116,  #> -0.214041239985383, 0.15168050450932, 1.71230497731928, -0.326143892505348,  #> 0.373004655804915, -0.227684064895531, 0.0204507085250325, 0.314057663506262,  #> 1.32821469603699, 0.121318377490778, 0.712842320031113, 0.778860029783535,  #> 0.914773270855634, -0.574394552184383, 1.62688121419468, -0.380956739294013,  #> -0.105784167649752, 1.40405026771417, 1.29408390614558, -1.08999187241124,  #> -0.873071000417463, -1.35807905937061, 0.181847192619832, 0.164840867918466,  #> 0.364114687355063, 0.552157714218558)), formula = Y_miss ~ X,  #>     response_predictors = NULL, auxiliary_means = c(X = 0), standardize = TRUE,  #>     trim_cap = Inf, control = list(), on_failure = \"return\",  #>     variance_method = \"delta\", variance_jacobian = \"auto\", solver_jacobian = \"auto\",  #>     variance_pseudoinverse = FALSE, bootstrap_reps = 500, suppress_warnings = FALSE,  #>     family = list(name = \"probit\", linkinv = function (eta)  #>     stats::pnorm(eta), mu.eta = function (eta)  #>     stats::dnorm(eta), d2mu.deta2 = function (eta)  #>     -eta * stats::dnorm(eta), score_eta = function (eta, delta)  #>     { #>         if (missing(delta))  #>             delta <- 1 #>         delta <- validate_delta(delta) #>         phi <- stats::dnorm(eta) #>         score <- numeric(length(phi)) #>         if (!length(score)) { #>             return(score) #>         } #>         log_Phi <- stats::pnorm(eta, log.p = TRUE) #>         log_tail <- stats::pnorm(eta, lower.tail = FALSE, log.p = TRUE) #>         idx1 <- delta == 1 #>         if (any(idx1)) { #>             score[idx1] <- phi[idx1] * exp(-log_Phi[idx1]) #>         } #>         idx0 <- delta == 0 #>         if (any(idx0)) { #>             score[idx0] <- -phi[idx0] * exp(-log_tail[idx0]) #>         } #>         idx_other <- !(idx1 | idx0) #>         if (any(idx_other)) { #>             p_other <- stats::pnorm(eta[idx_other]) #>             p_other <- pmin(pmax(p_other, .Machine$double.eps),  #>                 1 - .Machine$double.eps) #>             score[idx_other] <- phi[idx_other] * ((delta[idx_other] -  #>                 p_other)/(p_other * (1 - p_other))) #>         } #>         score #>     })) #>  #> Response-model coefficients: #>               Estimate Std. Error   z value     Pr(>|z|) #> (Intercept) -0.9496775  0.2795960 -3.396606 0.0006822712 #> Y_miss       0.2175044  0.1592956  1.365414 0.1721230033 if (requireNamespace(\"broom\", quietly = TRUE)) {   broom::tidy(fit)   broom::glance(fit) } #>   estimate std.error conf.low conf.high converged trimmed_fraction #> 1  1.87866 0.2514025  1.38592    2.3714      TRUE                0 #>   variance_method solver_jacobian jacobian_source jacobian_condition_number #> 1           delta        analytic        analytic                  36.83019 #>   jacobian_rel_diff max_equation_residual min_denominator #> 1      6.884968e-12          3.347322e-14       0.4613402 #>   fraction_small_denominators used_pseudoinverse nobs nobs_resp is_survey #> 1                           0              FALSE  500       150     FALSE  # plot(fit, which = \"weights\") # plot(fit, which = \"fitted\") weights(fit)[1:10] #>  [1] 1.2576603 1.3406704 0.6572937 2.1675980 1.0438681 1.0741326 0.8992693 #>  [8] 0.9537856 1.1085666 1.1764099 fitted(fit)[1:10] #>  [1] 0.2385382 0.2237686 0.4564170 0.1384020 0.2873926 0.2792951 0.3336042 #>  [8] 0.3145361 0.2706197 0.2550132 str(fit$diagnostics) #> List of 20 #>  $ convergence_code           : int 1 #>  $ message                    : chr \"Function criterion near zero\" #>  $ vcov_message               : chr \"Calculation successful\" #>  $ trimmed_fraction           : num 0 #>  $ solver_jacobian            : chr \"analytic\" #>  $ solver_method              : logi NA #>  $ solver_iterations          : int 7 #>  $ reparam_W                  : chr \"logit\" #>  $ max_equation_residual      : num 3.35e-14 #>  $ jacobian_condition_number  : num 36.8 #>  $ jacobian_source            : chr \"analytic\" #>  $ jacobian_rel_diff          : num 6.88e-12 #>  $ jacobian_auto_rule         : chr \"default\" #>  $ min_denominator            : num 0.461 #>  $ fraction_small_denominators: num 0 #>  $ constraint_sum_W           : num 6.73e-15 #>  $ constraint_sum_aux         : Named num 4.22e-15 #>   ..- attr(*, \"names\")= chr \"X\" #>  $ used_pseudoinverse         : logi FALSE #>  $ used_ridge                 : logi FALSE #>  $ invert_rule                : chr \"plain\" engine = el_engine(auxiliary_means = c(X = 0), variance_method = \"bootstrap\", bootstrap_reps = 15, standardize = TRUE, suppress_warnings = TRUE)  fit_boot <- nmar(   formula = Y_miss ~ X,   engine = engine,   data = dat,   response_predictors = NULL  ) fit_boot$se #> NULL"},{"path":"https://ncn-foreigners.github.io/NMAR/articles/tutorial_empirical_likelihood.html","id":"response-only-predictors","dir":"Articles","previous_headings":"","what":"Response-only predictors","title":"Empirical Likelihood","text":"can include predictors enter response model (constrained auxiliaries). Specify covariates_missingness keeping auxiliary set RHS outcome formula. Auxiliary means formulas: Names auxiliary_means must match variables outcome RHS exactly. standardize = TRUE, engine automatically transforms auxiliary_means standardized scale internally reports coefficients original scale. Response-predictors (covariates_missingness) need auxiliary means.","code":"N <- 400 X <- rnorm(N) Z <- rnorm(N) Y <- 1 + 0.6 * X + 0.3 * Z + rnorm(N) p <- plogis(-0.6 + 0.5 * scale(Y)[, 1] + 0.4 * Z) R <- runif(N) < p df2 <- data.frame(Y_miss = Y, X = X, Z = Z) df2$Y_miss[!R] <- NA_real_ engine = el_engine(auxiliary_means = c(X = 0), variance_method = \"delta\", standardize = TRUE)  # Use X as auxiliary (known population mean 0), and Z as response-only predictor fit_resp_only <- nmar(   formula = Y_miss ~ X,   data = df2,   engine = engine,   response_predictors = c('Z') ) summary(fit_resp_only) #> NMAR Model Summary #> ================= #> Y_miss estimate: 1.258792 #> Std. Error: 0.140526 #> 95% CI: (0.983365, 1.534218) #> Converged: TRUE  #> Variance method: delta  #> Variance notes: Calculation successful  #> Total units: 400  #> Respondents: 154  #> Call: #> el.data.frame(data = list(Y_miss = c(NA, 1.38556913768562, 1.77310575384346,  #> NA, NA, NA, NA, 0.332327292075492, 1.34281199944437, NA, 1.28565279507139,  #> NA, NA, NA, 2.2263808918028, NA, 1.67147178042605, NA, NA, 1.3244489729197,  #> 3.54497441526664, NA, NA, NA, 0.208650896665685, -0.0211422805074557,  #> NA, 1.26632988560754, NA, NA, 1.19434029031729, NA, 0.355539662218102,  #> NA, NA, NA, NA, NA, 1.88118092096618, 1.06972369459129, 2.61479860289541,  #> 0.931033895555733, NA, 1.55292886413551, NA, NA, NA, 0.0971062425650471,  #> NA, NA, NA, NA, 1.02373491704083, NA, 1.8429183125796, NA, 1.50633913332477,  #> 3.14455905868299, 1.97393921497226, 1.71555388671248, NA, NA,  #> NA, 0.168298555201535, NA, NA, NA, 1.83865476620452, NA, 0.230634491393376,  #> 2.40262624493874, NA, NA, NA, NA, 2.01197807985703, NA, 2.59407744562995,  #> 2.22863300349864, NA, NA, NA, NA, NA, 2.89793081903239, NA, NA,  #> 1.19477725286094, NA, NA, NA, 0.555698971407137, NA, 1.37378442153686,  #> NA, NA, NA, NA, 1.80127738769062, NA, NA, NA, 1.19663226635383,  #> NA, -0.742945144914763, NA, 1.67965109256475, NA, NA, 0.616338643098616,  #> NA, 0.914976890648566, 4.04484568391639, NA, NA, 0.869130105078053,  #> NA, NA, 0.191885099449048, NA, NA, NA, NA, NA, NA, 0.426547185106147,  #> 3.51259757253409, 1.10527612544585, NA, 0.589010895264272, NA,  #> 1.13230033109516, NA, 2.69467595563762, NA, 1.94284253502543,  #> NA, NA, NA, NA, 2.73655618202429, 1.119644311582, NA, NA, 0.183829186449307,  #> NA, NA, NA, 2.8522900492624, NA, NA, NA, 0.397481754700013, NA,  #> NA, NA, 3.59242545261985, NA, 0.566877846960978, NA, NA, NA,  #> 0.266286805266145, 0.740273482469958, 1.99315182911921, 2.56040542898351,  #> NA, NA, NA, 1.03544613608865, 0.188193118957859, 2.01377001960161,  #> NA, NA, 2.08633483285817, 1.98354118084458, NA, NA, NA, NA, 1.8895344660609,  #> 1.64581659987632, 1.34224653990259, 0.212203109882827, 0.210260177686282,  #> -1.32584930796719, NA, -0.389896185565483, 1.01328906890677,  #> NA, 2.49780523416379, NA, 1.01269035493081, NA, 2.14776604030454,  #> NA, 1.73488472044957, NA, 1.33010705136306, 0.552562283148064,  #> NA, -0.190943327181827, NA, 0.888616370752793, NA, NA, NA, 1.96856572294173,  #> 2.68229033572361, 2.93305630692969, NA, NA, NA, 2.86306679763485,  #> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 1.39891678406827, 0.164770874376557,  #> NA, NA, 3.30081098344531, NA, -0.0199573763003082, NA, -0.43133713918143,  #> NA, NA, 0.802707358121971, 0.817114737690162, -0.393184236369951,  #> 0.558024409804495, NA, NA, -0.682509605660794, NA, NA, 1.36653497617517,  #> NA, NA, 0.276347351903606, NA, 1.16002326886435, NA, NA, NA,  #> 1.74049953016959, 2.71133312520455, 2.68888343946357, 1.22341674524806,  #> NA, 0.648385347079262, NA, NA, NA, NA, NA, 2.32464781063458,  #> NA, NA, 3.51726836816621, 1.42655555057501, NA, 2.42378716059449,  #> NA, 3.15095636008304, NA, 1.34262731667449, NA, 2.44685580161714,  #> NA, 1.16264867883167, NA, NA, 1.94548169478212, 2.36044935752065,  #> NA, NA, NA, NA, NA, 2.95322385680791, NA, NA, NA, NA, NA, NA,  #> NA, NA, NA, NA, NA, NA, NA, 2.5251550352492, 0.591536148001904,  #> NA, NA, NA, NA, NA, NA, 3.46518894047381, 3.23891130435199, NA,  #> NA, NA, NA, NA, NA, NA, NA, NA, 0.210170423831445, 0.263309382736915,  #> 2.12580462770459, 3.23420315683729, NA, -0.874669551639703, NA,  #> 4.53205317869802, NA, NA, 1.18571169163732, 0.659463604831259,  #> 1.52649450162796, NA, 2.00901309769828, NA, NA, 1.32983964613139,  #> NA, -0.299156492706869, NA, NA, 3.53825780466168, NA, 1.45045372629898,  #> 1.14559889302662, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,  #> NA, NA, 3.6241301299964, 0.996363722917245, 3.33960949513695,  #> NA, 0.289088472944333, NA, NA, NA, 1.97014384495767, NA, 1.60101431057626,  #> 0.281617463704373, NA, 0.46418340419772, NA, NA, 1.2993414367573,  #> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 2.82986729683318, NA,  #> 1.97350977722259, 0.206651824532079, NA, 0.977543878637118, NA,  #> 1.9812970816466, 1.03940258412447, NA, NA, 2.4940684158354, 2.55996112074168 #> ), X = c(0.342673809908576, -0.217888546518944, -0.254931686100134,  #> 0.342370468111289, -0.415209145926036, -0.538170831690783, 1.47135176184773,  #> -1.06653233761657, -1.00233945361176, -1.04356134497353, -0.582889290964355,  #> 0.571616197333525, -0.301777107811405, -0.675609725470712, -0.339073815221847,  #> 0.443969498131154, -0.55086914034931, 1.11067249197446, -0.508755142473003,  #> -0.316623090237736, 0.326384345284153, -0.842065240454817, -0.78576881539627,  #> 0.465523703433005, -1.75073606562768, -1.3209122859245, 0.936975550302291,  #> 0.12209659090266, -0.624863526902011, 0.338353393046866, 1.37057330212024,  #> 0.798721887326517, 0.268621832174641, 0.342754651683118, -0.0631635380300432,  #> -0.98188616412373, 0.677428665165048, -0.127956895941332, -1.40544404891561,  #> -0.600690697459372, -0.384978058019545, 0.717653489530215, 1.1271136005015,  #> -1.07680047032123, 0.599034069067819, 0.24330992440578, -0.680854278937542,  #> -0.727703736478873, -1.22086971436041, 0.880466773315259, 0.473655553818349,  #> -1.03796422982368, -0.359151615734395, -1.03423526622973, 0.10663926331916,  #> 1.60875544168133, -0.0364957472231548, 0.939545445050499, 1.87607754446687,  #> 2.28428463572661, -1.31173356790275, -0.574520878686566, 0.425523552624071,  #> 0.508454574791457, -0.0164319745881963, 1.30540759594292, -0.613021399172525,  #> -0.0899630431720063, 0.629241128057797, 0.88692520337292, 1.78679865852635,  #> -0.0703448520840248, -0.676333341013683, 0.211931012514322, -0.7887343225216,  #> 0.983528260634817, -1.09723702214792, 2.22181577214592, 0.90101248473432,  #> -0.401728727777859, -0.865014659564364, 0.905558520545688, 1.34530077942331,  #> -2.23971891824027, 1.9026521267045, -0.53281607601307, -1.09378453068041,  #> 0.0984328641650773, -0.39099813013891, 1.2901318674451, 0.661536735652902,  #> -0.68132272665024, 0.730342574589494, -0.258259433293706, -0.0453978248901636,  #> 0.117387536661231, -0.0785909524134938, -1.07053989114208, 1.70623163925947,  #> -0.705759005647489, -0.890315624049446, -1.41168829365752, 0.463120834324549,  #> -0.901178853225169, -0.461190445549823, 0.134931906909821, -0.380835859993346,  #> -0.225282992346034, 0.13245952106055, 0.758715782175997, 1.97497695501343,  #> -0.979723188380758, 1.07883391263135, 0.832577561550012, -2.87294953954151,  #> -0.0591759261235084, 0.541619772052565, 1.65771746688812, -1.40091611246608,  #> -0.206732168126741, -2.09255128227584, 0.486549146633067, 1.21229067770493,  #> 0.102342022806371, 0.710116552786685, -0.921415884361544, 1.09675202242372,  #> -0.0440376956820925, 0.195592067060288, 0.0662265321336024, 0.465800223599794,  #> 0.477494603612724, 0.835108466351104, 0.812955440961802, 1.55808733653707,  #> 0.731812889554696, -0.0257634108615526, -1.91159625485916, 0.104238748984917,  #> -1.52315330751757, 1.06376339759407, -1.063995790096, -0.50201171161602,  #> 0.949875757405771, -0.953163522811526, 0.570112716129359, -1.23322557207474,  #> -1.39852579549502, 0.69409456512966, 0.517915232390215, 0.0854673683675075,  #> -0.880899048171773, 0.345690061994213, 1.13047817536938, -0.1566369920129,  #> 0.779702337664761, 0.847500225198859, -0.0249207311928233, 0.220760310832671,  #> -0.420259577156681, -0.669533888903081, -0.283669632228415, -2.11418952815426,  #> 0.21977839301506, 1.21443148073391, 0.527999329635644, 1.46317686972762,  #> -0.0111845067085713, -1.95679295534256, -0.511859302775368, -0.569563382484848,  #> 0.971707142883362, 0.621715272964184, 1.68610528002971, -0.291558592629143,  #> 0.824113559706794, -0.341410519251814, -0.569466551041823, 0.409696682139431,  #> -0.835787506320189, 1.07051343412354, 0.355433893053369, -0.142978221674756,  #> -0.730629237269691, -1.00917676161737, -2.47958518678615, 0.577698062393795,  #> -0.34511943861078, -0.608792750035748, 0.995264897141866, 2.34260666490918,  #> -0.0299976334645358, 0.19360081783477, 0.862171857455774, 1.61717192220179,  #> 0.235777546303605, -0.0679699734023093, 0.0967374723829079, 0.180090661517436,  #> 0.355263416261737, -0.709245282150202, -0.255676391215682, -1.72210310357527,  #> -0.212700065228476, -0.510195605569313, 0.814581946912226, -0.0504018872979529,  #> -0.948283556117104, -0.532532945982023, -0.340119544340143, -1.08480630532372,  #> 0.991054065028495, 0.237585206633321, 0.446470712729314, -1.57366297675413,  #> -1.22677188408059, -0.54516685658107, 1.25642735856895, -0.371712521496065,  #> 1.14559357977779, 0.499228061248833, -0.178894886627235, -0.703852235850287,  #> 1.35748077932045, 0.599520931092549, -0.0242564473822581, 0.148604926243587,  #> -0.620386438350147, 1.86545895375075, 0.58730501013136, 0.906689612914435,  #> -0.996013331609461, -1.55327778907444, 1.96728781782323, 0.0705447443282023,  #> -0.546460681647045, -0.0705623553256341, -0.480849671786652,  #> 1.02761182856721, 0.709084791742593, 2.28627971693834, -1.34701059977147,  #> -0.338234644957803, 0.493785346149713, 1.66057709380822, -1.0179053258176,  #> 0.0203393874855062, -0.394056956106891, -1.5735488520784, -1.07397721181433,  #> -1.17427503521868, -1.79469060734184, 0.235202959804916, 0.162833264240433,  #> 0.730111548601155, 1.25648081810815, -1.94342966675057, -0.416804631217497,  #> -1.10932561558243, 0.15631645276249, 0.983513355332649, 0.377218945303655,  #> -0.0822356504247901, -0.360447277719158, 0.0468930558451447,  #> 0.853352785250156, 0.90844410404803, 0.393967140767055, 1.11691250320326,  #> 0.0505644472670064, 1.46846719223419, -1.00181310666634, 0.27359185895682,  #> -1.8138811030136, 0.46793244163027, -2.37493931053932, -0.285141248398594,  #> 0.0786518606871651, 0.505178084308333, -0.594983634888237, -0.563346023582651,  #> 0.0482345333314738, -0.571554212961943, 0.476412579684938, 0.543898532719131,  #> -1.22618575432074, -0.323213088156879, 1.24011158552942, -0.511593859853422,  #> -0.625383790731517, 0.968502687035329, -1.24481176699102, -0.404119062531442,  #> -0.657102254490212, -1.50479969225754, -0.259431489177697, 0.207809853611996,  #> -0.671847349352963, -0.0997780302387801, 0.442528022253766, 0.211079755579242,  #> -0.552541891532478, -0.823980056256254, 0.38826784349681, 0.940165729552551,  #> -0.179191089987125, -1.04390443265113, -2.3412256076372, -1.08298634837209,  #> -0.688114983585557, 1.20900119368882, 0.180280731619819, 0.316065040663179,  #> 0.0475899503950655, -0.774621002519825, 0.504408039574449, -0.845477993130379,  #> 0.673015639785362, -0.937224512270308, 0.779972756597278, 1.56379464799447,  #> -1.22364285358344, -1.07078458740436, 0.930433310285324, 1.80085577522635,  #> -0.530002428311286, -0.96174353918803, 0.48953043528765, 1.3413990929673,  #> -0.570409437209188, 0.12357782156381, -0.409128296504756, 0.789076718805993,  #> 0.0676628503470797, 0.852066988119507, 0.00937995601928646, 0.23179039661194,  #> 0.899096142635774, -0.719878698967203, 0.655275724260081, -1.69802979202566,  #> 0.515736838367744, 0.822579291659566, 0.00431627692573735, 0.568591654726228,  #> 0.587665201952279, -1.36217831347666, 0.145862069533514, 0.679776878804944,  #> 0.698208192734717, -0.28866006612553, -0.524198327876207, -0.671652296443827,  #> -1.35665196697364, -0.199230227088326, 0.5357917030652, 2.29661178751974,  #> -0.763991407382142, -1.39506151465728, 2.2291953671622, 1.14492387704781,  #> -0.0634341683177322, 0.716185522536329, 0.681452032873507, 0.190270298863864,  #> 1.20106804615788, -0.0700827885658656, 0.446053905736242, 1.3379033596748,  #> -1.50385801210272, -1.68538120890682, 1.31209768355239, 0.989695957478709,  #> 0.306674973601518, -0.239320270832471, 0.711933892110796, -1.65840766314361,  #> -0.421348934182495, -0.905149131545953, 2.22267033356162, -1.10818030225995,  #> -0.806423522222454, -1.073814760506, -1.77290110821893, 0.0778169003332036,  #> 0.867940851611249, -0.146637165289774, 2.15544250799429, -1.78502395299156,  #> 0.173455874131938, -0.158265988301165, 1.52332841227426, 0.131466774957259,  #> -1.01115161187817, 0.29624924820094, -0.126344476343334, 0.238151568801583,  #> -1.3998095954513, 0.624992702508636, 1.75823685884211), Z = c(-0.265038289644761,  #> 1.10411154208952, 1.39879927899385, 0.953782398780058, -0.706995628709424,  #> -2.47670237697113, 0.955613154506432, -0.314119875767996, -0.073865537668401,  #> -0.139868965988967, 0.0335818688606997, -1.24031770820019, 0.0733455189276521,  #> -0.32796844728054, 0.502649974122621, -1.93117022073743, -1.26474293231615,  #> 0.0232728867959947, -0.140407313576245, -0.219446027077848, 1.37966359657935,  #> -0.27944943608991, -0.29484035773855, -0.995157545531196, -0.592190111399739,  #> 1.12597936612626, 1.82104486463457, 1.61370064010678, -0.683810396568525,  #> 1.09522447880192, -1.33797423265482, -0.842447851360226, 0.3144110421338,  #> 1.94054789618644, 0.0674864722907044, 1.04442992432512, -0.0720423453536332,  #> 0.00679170433982687, 0.417020021200132, 1.62090441745504, -0.783548058116603,  #> -0.248546727277135, 0.316503473544306, 0.0726708402540267, -1.22967460767231,  #> -0.122073700718622, 0.686082567999056, -0.179962846790321, 0.0886433317400867,  #> -1.32919836118578, -0.453499905425832, -0.79686033714186, 0.299982215635398,  #> -0.410024381226544, -0.530619491433369, 0.880893395436459, -0.00783171776511641,  #> 1.98318266427192, -1.97975090847371, 1.07307388686296, 0.213112215973276,  #> -1.22756019775605, 0.195091386564223, 0.218291653763989, -0.214187129730795,  #> 0.0328567878428224, 1.24447715213026, 0.387895011310922, -1.07340895394553,  #> -0.819234602661552, -2.20293827532007, 0.604817523893798, -0.327420723259218,  #> 0.342492864778602, 0.228630777807538, -0.652017257045706, -0.0988755377469051,  #> 0.954113283586807, -0.446342080984687, 0.307129384184654, 0.0497200273926128,  #> -2.1578790060005, -1.36226712317483, -1.01941365565374, 1.09152961777667,  #> -0.810297334508969, -0.48949599049255, 0.815139339982471, 0.458051967892524,  #> -0.704509617076888, -2.47416643429031, 0.824805345551369, -2.71393736452177,  #> 0.80071389776031, 0.0971090933976922, 0.183976787766536, 0.0389264930209381,  #> 0.788821885728085, 2.34896515162539, 0.37029757489363, 1.76936254347424,  #> 1.0054755845814, -0.181069960894636, -0.783583009639351, 0.137072600485464,  #> 1.31762077175146, -0.347355179491965, -0.0339877084027468, -0.568004284109091,  #> -0.426058203341485, -0.776870853703552, -0.661220467185125, 0.328509779580263,  #> -1.96692292242093, 2.07069935893804, 0.070647078129588, 0.597776271002413,  #> 0.427520810702309, 0.473699030265739, 0.359331692154328, 1.32049409540156,  #> -0.642897665375245, 1.95733742509515, 0.227619472515405, -0.421331609273535,  #> 1.36227866497998, 0.196614961943781, -1.08215511418836, -2.5434977951333,  #> -0.0504188356800815, 0.979395002503944, -1.14286995198583, -2.58582834013408,  #> 0.992236898047514, -0.461951636576995, -1.59248625673503, -0.012052623474467,  #> -0.639942765823807, -0.571367903229495, -1.65588599747661, 1.33706365682341,  #> -0.447221384464935, 0.495726836489441, 1.39348954612539, -1.271889440388,  #> -0.24435191040044, 1.01071788617199, -1.702108477402, 1.17461752874927,  #> 0.564581770184412, -1.14342961100892, -2.40152751712695, -1.52198559293961,  #> -0.00323512458036847, -0.0506276269406068, -2.3602894523347,  #> 1.70619130187065, 0.150006957238226, -1.39184428084306, -1.12135054450261,  #> 0.82729842926274, -0.463533214182556, 1.42138054704986, -0.999130463161041,  #> 0.457746394988565, 1.08343771103642, -0.811773295202522, 0.349361602189789,  #> -0.718856387924988, 1.49604218421803, 0.523267141866726, 0.357498075451881,  #> 0.3632695682381, -1.07764352316643, 0.38573226799772, 1.78130509684571,  #> -0.297240408039245, 1.17010847051378, -0.791846386665954, -1.94171613480201,  #> -0.769809739592908, -1.89783008074948, -0.685475083562994, -0.772752627680968,  #> -0.314380801212135, -1.27879904618847, 1.56593988251416, -0.292996969324111,  #> -0.625598376728905, -0.0380713811730851, 1.48397692067758, 0.539096567965082,  #> 0.480690295164642, -1.49161618500265, 0.160889493890805, -1.36879298020091,  #> 1.41516546449867, 1.08270340646974, 0.440913508771325, 0.574311417388692,  #> -0.896054565881077, -0.738243249832206, 1.57789790542531, -1.26179584736495,  #> 0.244029888814223, -0.523904998852639, -0.0339210484857446, 0.815103313787,  #> 0.422048535154938, 1.96790598508654, 0.873984149285835, -0.0410649810829098,  #> -2.4447769325855, -0.0789991661160191, 0.72398271867211, -0.301965418133995,  #> 1.40259886204484, 0.294384318685352, -0.0937875121241208, -1.01713409785272,  #> -1.90854460856627, -1.30691750146161, 1.21289946769367, 0.913843026969423,  #> 0.661063665099507, -0.690599094312083, 0.381999074841227, -0.441422694544479,  #> 1.37108434018344, 1.0903116322813, -0.207636664541866, -1.31642536508465,  #> 3.08415774554656, 0.337554872204983, 0.511374398601648, -0.352973202649863,  #> 0.656176365012463, 0.506934757506943, 0.66179685611856, 0.181710276242585,  #> -1.05287199738537, -2.05174940419954, 0.512750479354296, -1.12335991914138,  #> 1.10213612969484, -0.84578331953827, -1.56364555416071, -0.0240792529448676,  #> 0.589463020469856, 0.83228004209541, 0.408114100765759, 0.149627455402642,  #> -0.160788433537456, -0.380000750743656, 1.74780842489629, -0.19499616208172,  #> -0.432441835123434, 0.179296346710815, -0.977802980110161, -0.715299631725843,  #> 0.60352370930233, -1.2730266467037, -1.09629658842314, 0.781630928477632,  #> 1.24816426171099, -1.48850681813894, 0.661273774677248, 0.591682623125743,  #> -0.0284859221133171, -0.243325146272422, -0.368957834029396,  #> 1.85489866258081, 0.951838549330393, 0.780671723702553, -0.028986909138335,  #> 0.744739943455629, 0.735613700426928, 0.592650189066823, -0.859605625135156,  #> -0.531181607061277, -1.83697616224805, -1.31399770601681, 2.67132596730103,  #> 0.210946705940009, -0.315965706253884, 0.311688440664329, -1.64052642914562,  #> -0.929763989050911, 2.19312552166613, 0.143240078612421, 0.142388038000806,  #> 1.19289047891881, -1.6689665029038, 0.879270312937958, 0.351718869057867,  #> -1.34400066381917, -0.980993151681696, -1.2768876279449, -0.521063337207679,  #> 0.678060606156058, 0.12443191208888, -1.79379050659342, 1.56924658780154,  #> -0.394227091178514, -0.545780035488028, -0.379690836268851, 1.53029410405619,  #> 0.0906635096071717, -1.64604396623653, 0.179539582167851, 2.74201600615358,  #> 1.27772993969188, -0.449014804047655, -0.679791737778043, 0.320503734360139,  #> -0.0519741045826275, -0.167225485067339, -1.97799383301598, 0.784621258713146,  #> 0.134896995219756, 0.619350572030873, -0.239459453867368, 0.354398957452416,  #> 0.352922969505923, -0.152621642236711, 0.0667659648015883, 1.13115306308418,  #> -0.448806782364122, 1.90043737358954, 1.02780843535006, -0.387880352285225,  #> 1.68197207204889, 1.18097668857052, 1.77672113085654, -0.532227877140781,  #> 0.566433778108637, -0.0724800951410291, -0.527245060354474, 0.962230418643762,  #> -0.816300609870718, 0.567097281868174, -1.18735387522512, -0.410132807673068,  #> 1.38088225510748, -1.87861203540351, -0.269735719176077, -1.21308125480774,  #> -0.340842072188317, -0.802559347900256, 0.602584171280716, 0.0707577049812887,  #> -1.03299842888902, 0.90742672240273, -0.416260753817435, -1.09651314143353,  #> 0.149328986856998, -1.25388835350833, -0.264406454556101, -0.200042985089742,  #> -1.43776600870493, 0.372326387612959, 0.0314963884379313, 0.0272790880042469,  #> 1.40148787800443, 1.04693561803795, -1.71720352980641, -1.84674322468024,  #> -1.73367077084265, -0.125239455085448, 0.135771117251419, -0.898093130883845,  #> -1.14658954695965, -0.110687419288357, 0.078733079272385, -2.63020804488352,  #> 0.952504216662522, 1.82733545280926, 0.347497874892146, -2.66812810222222,  #> -0.185064641366115, -0.612554184396984, -1.0386116293614, 1.32411787571842,  #> -1.51991987515797, -0.600738832984299, 0.634029176876658, -1.94378513151971,  #> -0.23397012854391, -0.244992272621204, -0.928379612451148, -0.269525889828864,  #> 0.65198663821998, -0.260884024218696, -0.150056573280396, 0.216957578238989,  #> 1.05862898234118, 0.150982004239416, -1.24665289039631, 2.12019332316106,  #> 0.361492966730684)), formula = Y_miss ~ X, response_predictors = \"Z\",  #>     auxiliary_means = c(X = 0), standardize = TRUE, trim_cap = Inf,  #>     control = list(), on_failure = \"return\", variance_method = \"delta\",  #>     variance_jacobian = \"auto\", solver_jacobian = \"auto\", variance_pseudoinverse = FALSE,  #>     bootstrap_reps = 500, suppress_warnings = FALSE, family = list( #>         name = \"logit\", linkinv = function (eta)  #>         stats::plogis(eta), mu.eta = function (eta)  #>         { #>             p <- stats::plogis(eta) #>             p * (1 - p) #>         }, d2mu.deta2 = function (eta)  #>         { #>             p <- stats::plogis(eta) #>             p * (1 - p) * (1 - 2 * p) #>         }, score_eta = function (eta, delta)  #>         { #>             if (missing(delta))  #>                 delta <- 1 #>             delta <- validate_delta(delta) #>             p <- stats::plogis(eta) #>             delta - p #>         })) #>  #> Response-model coefficients: #>                Estimate Std. Error    z value    Pr(>|z|) #> (Intercept) -0.85089950  0.2662728 -3.1955929 0.001395439 #> Y_miss       0.28631609  0.2429661  1.1784201 0.238629155 #> Z            0.05802273  0.1829562  0.3171401 0.751137329"},{"path":"https://ncn-foreigners.github.io/NMAR/articles/tutorial_empirical_likelihood.html","id":"survey-design-example-optional","dir":"Articles","previous_headings":"","what":"Survey design example (optional)","title":"Empirical Likelihood","text":"estimator supports complex surveys via survey::svydesign(). chunk runs survey package available.","code":"if (requireNamespace(\"survey\", quietly = TRUE)) {   library(survey)   data(api)    set.seed(42)   apiclus1$api00_miss <- apiclus1$api00   ystd <- scale(apiclus1$api00)[, 1]   prob <- plogis(-0.5 + 0.4 * ystd + 0.2 * scale(apiclus1$ell)[, 1])   miss <- runif(nrow(apiclus1)) > prob   apiclus1$api00_miss[miss] <- NA_real_    dclus1 <- svydesign(id = ~dnum, weights = ~pw, data = apiclus1, fpc = ~fpc)   pop_mean_ell <- mean(apiclus1$ell)   engine = el_engine(auxiliary_means = c(ell = pop_mean_ell), variance_method = \"delta\", standardize = TRUE)    fit_svy <- nmar(     formula = api00_miss ~ ell,     data = dclus1,     engine = engine,     response_predictors = NULL    )   summary(fit_svy) } #> Loading required package: grid #> Loading required package: Matrix #> Loading required package: survival #>  #> Attaching package: 'survey' #> The following object is masked from 'package:graphics': #>  #>     dotchart #> NMAR Model Summary #> ================= #> api00_miss estimate: 561.429381 #> Std. Error: 34.832435 #> 95% CI: (486.721237, 636.137525) #> Converged: TRUE  #> Variance method: delta  #> Variance notes: Calculation successful  #> Total units: 183  #> Respondents: 65  #> Call: #> el.survey.design(data = list(cluster = list(dnum = c(637L, 637L,  #> 637L, 637L, 637L, 637L, 637L, 637L, 637L, 637L, 637L, 437L, 437L,  #> 437L, 437L, 778L, 778L, 197L, 197L, 197L, 197L, 197L, 197L, 197L,  #> 197L, 197L, 197L, 197L, 197L, 197L, 406L, 406L, 815L, 815L, 815L,  #> 815L, 178L, 178L, 178L, 178L, 255L, 255L, 255L, 255L, 255L, 255L,  #> 255L, 255L, 255L, 255L, 255L, 255L, 255L, 255L, 255L, 255L, 568L,  #> 568L, 568L, 568L, 568L, 568L, 568L, 568L, 568L, 135L, 135L, 135L,  #> 135L, 135L, 135L, 135L, 135L, 135L, 135L, 135L, 135L, 135L, 135L,  #> 135L, 135L, 135L, 135L, 135L, 135L, 135L, 135L, 135L, 135L, 135L,  #> 135L, 135L, 135L, 135L, 135L, 135L, 135L, 135L, 135L, 510L, 510L,  #> 510L, 510L, 510L, 510L, 510L, 510L, 510L, 510L, 510L, 510L, 510L,  #> 510L, 510L, 510L, 510L, 510L, 510L, 510L, 510L, 716L, 716L, 716L,  #> 716L, 716L, 716L, 716L, 716L, 716L, 716L, 716L, 716L, 716L, 716L,  #> 716L, 716L, 716L, 716L, 716L, 716L, 716L, 716L, 716L, 716L, 716L,  #> 716L, 716L, 716L, 716L, 716L, 716L, 716L, 716L, 716L, 716L, 716L,  #> 716L, 61L, 61L, 61L, 61L, 61L, 61L, 61L, 61L, 61L, 61L, 61L,  #> 61L, 61L, 413L, 448L, 448L, 448L, 448L, 448L, 448L, 448L, 448L,  #> 448L, 448L, 448L, 448L)), strata = list(V1 = c(1, 1, 1, 1, 1,  #> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  #> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  #> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  #> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  #> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  #> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  #> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  #> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  #> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)), has.strata = FALSE, prob = c(`1` = 0.0295447191508147,  #> `2` = 0.0295447191508147, `3` = 0.0295447191508147, `4` = 0.0295447191508147,  #> `5` = 0.0295447191508147, `6` = 0.0295447191508147, `7` = 0.0295447191508147,  #> `8` = 0.0295447191508147, `9` = 0.0295447191508147, `10` = 0.0295447191508147,  #> `11` = 0.0295447191508147, `12` = 0.0295447191508147, `13` = 0.0295447191508147,  #> `14` = 0.0295447191508147, `15` = 0.0295447191508147, `16` = 0.0295447191508147,  #> `17` = 0.0295447191508147, `18` = 0.0295447191508147, `19` = 0.0295447191508147,  #> `20` = 0.0295447191508147, `21` = 0.0295447191508147, `22` = 0.0295447191508147,  #> `23` = 0.0295447191508147, `24` = 0.0295447191508147, `25` = 0.0295447191508147,  #> `26` = 0.0295447191508147, `27` = 0.0295447191508147, `28` = 0.0295447191508147,  #> `29` = 0.0295447191508147, `30` = 0.0295447191508147, `31` = 0.0295447191508147,  #> `32` = 0.0295447191508147, `33` = 0.0295447191508147, `34` = 0.0295447191508147,  #> `35` = 0.0295447191508147, `36` = 0.0295447191508147, `37` = 0.0295447191508147,  #> `38` = 0.0295447191508147, `39` = 0.0295447191508147, `40` = 0.0295447191508147,  #> `41` = 0.0295447191508147, `42` = 0.0295447191508147, `43` = 0.0295447191508147,  #> `44` = 0.0295447191508147, `45` = 0.0295447191508147, `46` = 0.0295447191508147,  #> `47` = 0.0295447191508147, `48` = 0.0295447191508147, `49` = 0.0295447191508147,  #> `50` = 0.0295447191508147, `51` = 0.0295447191508147, `52` = 0.0295447191508147,  #> `53` = 0.0295447191508147, `54` = 0.0295447191508147, `55` = 0.0295447191508147,  #> `56` = 0.0295447191508147, `57` = 0.0295447191508147, `58` = 0.0295447191508147,  #> `59` = 0.0295447191508147, `60` = 0.0295447191508147, `61` = 0.0295447191508147,  #> `62` = 0.0295447191508147, `63` = 0.0295447191508147, `64` = 0.0295447191508147,  #> `65` = 0.0295447191508147, `66` = 0.0295447191508147, `67` = 0.0295447191508147,  #> `68` = 0.0295447191508147, `69` = 0.0295447191508147, `70` = 0.0295447191508147,  #> `71` = 0.0295447191508147, `72` = 0.0295447191508147, `73` = 0.0295447191508147,  #> `74` = 0.0295447191508147, `75` = 0.0295447191508147, `76` = 0.0295447191508147,  #> `77` = 0.0295447191508147, `78` = 0.0295447191508147, `79` = 0.0295447191508147,  #> `80` = 0.0295447191508147, `81` = 0.0295447191508147, `82` = 0.0295447191508147,  #> `83` = 0.0295447191508147, `84` = 0.0295447191508147, `85` = 0.0295447191508147,  #> `86` = 0.0295447191508147, `87` = 0.0295447191508147, `88` = 0.0295447191508147,  #> `89` = 0.0295447191508147, `90` = 0.0295447191508147, `91` = 0.0295447191508147,  #> `92` = 0.0295447191508147, `93` = 0.0295447191508147, `94` = 0.0295447191508147,  #> `95` = 0.0295447191508147, `96` = 0.0295447191508147, `97` = 0.0295447191508147,  #> `98` = 0.0295447191508147, `99` = 0.0295447191508147, `100` = 0.0295447191508147,  #> `101` = 0.0295447191508147, `102` = 0.0295447191508147, `103` = 0.0295447191508147,  #> `104` = 0.0295447191508147, `105` = 0.0295447191508147, `106` = 0.0295447191508147,  #> `107` = 0.0295447191508147, `108` = 0.0295447191508147, `109` = 0.0295447191508147,  #> `110` = 0.0295447191508147, `111` = 0.0295447191508147, `112` = 0.0295447191508147,  #> `113` = 0.0295447191508147, `114` = 0.0295447191508147, `115` = 0.0295447191508147,  #> `116` = 0.0295447191508147, `117` = 0.0295447191508147, `118` = 0.0295447191508147,  #> `119` = 0.0295447191508147, `120` = 0.0295447191508147, `121` = 0.0295447191508147,  #> `122` = 0.0295447191508147, `123` = 0.0295447191508147, `124` = 0.0295447191508147,  #> `125` = 0.0295447191508147, `126` = 0.0295447191508147, `127` = 0.0295447191508147,  #> `128` = 0.0295447191508147, `129` = 0.0295447191508147, `130` = 0.0295447191508147,  #> `131` = 0.0295447191508147, `132` = 0.0295447191508147, `133` = 0.0295447191508147,  #> `134` = 0.0295447191508147, `135` = 0.0295447191508147, `136` = 0.0295447191508147,  #> `137` = 0.0295447191508147, `138` = 0.0295447191508147, `139` = 0.0295447191508147,  #> `140` = 0.0295447191508147, `141` = 0.0295447191508147, `142` = 0.0295447191508147,  #> `143` = 0.0295447191508147, `144` = 0.0295447191508147, `145` = 0.0295447191508147,  #> `146` = 0.0295447191508147, `147` = 0.0295447191508147, `148` = 0.0295447191508147,  #> `149` = 0.0295447191508147, `150` = 0.0295447191508147, `151` = 0.0295447191508147,  #> `152` = 0.0295447191508147, `153` = 0.0295447191508147, `154` = 0.0295447191508147,  #> `155` = 0.0295447191508147, `156` = 0.0295447191508147, `157` = 0.0295447191508147,  #> `158` = 0.0295447191508147, `159` = 0.0295447191508147, `160` = 0.0295447191508147,  #> `161` = 0.0295447191508147, `162` = 0.0295447191508147, `163` = 0.0295447191508147,  #> `164` = 0.0295447191508147, `165` = 0.0295447191508147, `166` = 0.0295447191508147,  #> `167` = 0.0295447191508147, `168` = 0.0295447191508147, `169` = 0.0295447191508147,  #> `170` = 0.0295447191508147, `171` = 0.0295447191508147, `172` = 0.0295447191508147,  #> `173` = 0.0295447191508147, `174` = 0.0295447191508147, `175` = 0.0295447191508147,  #> `176` = 0.0295447191508147, `177` = 0.0295447191508147, `178` = 0.0295447191508147,  #> `179` = 0.0295447191508147, `180` = 0.0295447191508147, `181` = 0.0295447191508147,  #> `182` = 0.0295447191508147, `183` = 0.0295447191508147), allprob = list( #>     pw = c(0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147,  #>     0.0295447191508147, 0.0295447191508147, 0.0295447191508147 #>     )), call = svydesign(id = ~dnum, weights = ~pw, data = apiclus1,  #>     fpc = ~fpc), variables = list(cds = c(\"01612910137588\", \"01612916002372\",  #> \"01612916002398\", \"01612916002414\", \"01612916002422\", \"01612916002430\",  #> \"01612916002448\", \"01612916002455\", \"01612916002463\", \"01612916057111\",  #> \"01612916066518\", \"10751271030493\", \"10751276006969\", \"10751276006977\",  #> \"10751276006985\", \"15638346010227\", \"15638346010235\", \"19644856012975\",  #> \"19644856012991\", \"19644856013007\", \"19644856013015\", \"19644856013023\",  #> \"19644856013031\", \"19644856013049\", \"19644856013072\", \"19644856013080\",  #> \"19644856013098\", \"19644856013106\", \"19644856013114\", \"19644856089148\",  #> \"19647586020085\", \"19647586020101\", \"23656232335487\", \"23656236025282\",  #> \"23656236025290\", \"23656236108369\", \"24753662430114\", \"24753666025407\",  #> \"24753666025415\", \"24753666115216\", \"30665066028005\", \"30665066028039\",  #> \"30665066028054\", \"30665066028062\", \"30665066028070\", \"30665066028088\",  #> \"30665066028104\", \"30665066028112\", \"30665066028120\", \"30665066028138\",  #> \"30665066028146\", \"30665066028153\", \"30665066028161\", \"30665066028179\",  #> \"30665066028195\", \"30665066085286\", \"32669693232006\", \"32669693233509\",  #> \"32669693235603\", \"32669693236007\", \"32669696031421\", \"32669696031454\",  #> \"32669696031470\", \"32669696109896\", \"32669696110308\", \"37680236037824\",  #> \"37680236037832\", \"37680236037840\", \"37680236037857\", \"37680236037865\",  #> \"37680236037873\", \"37680236037881\", \"37680236037899\", \"37680236037907\",  #> \"37680236037915\", \"37680236037923\", \"37680236037931\", \"37680236037949\",  #> \"37680236037956\", \"37680236037964\", \"37680236037972\", \"37680236037980\",  #> \"37680236037998\", \"37680236038004\", \"37680236038012\", \"37680236038020\",  #> \"37680236038038\", \"37680236038046\", \"37680236066971\", \"37680236069090\",  #> \"37680236070825\", \"37680236095020\", \"37680236095038\", \"37680236107775\",  #> \"37680236108492\", \"37680236109771\", \"37680236111322\", \"37680236113021\",  #> \"37680236115646\", \"37735693735206\", \"37735693739018\", \"37735696038822\",  #> \"37735696038830\", \"37735696038848\", \"37735696038855\", \"37735696038863\",  #> \"37735696038871\", \"37735696038889\", \"37735696038897\", \"37735696038905\",  #> \"37735696038913\", \"37735696038921\", \"37735696067011\", \"37735696069108\",  #> \"37735696070916\", \"37735696088991\", \"37735696108211\", \"37735696109995\",  #> \"37735696111777\", \"37735696115299\", \"39686763932100\", \"39686763932654\",  #> \"39686763937406\", \"39686766042501\", \"39686766042519\", \"39686766042535\",  #> \"39686766042543\", \"39686766042550\", \"39686766042568\", \"39686766042576\",  #> \"39686766042584\", \"39686766042600\", \"39686766042618\", \"39686766042626\",  #> \"39686766042634\", \"39686766042667\", \"39686766042683\", \"39686766042691\",  #> \"39686766042709\", \"39686766042717\", \"39686766042725\", \"39686766042741\",  #> \"39686766042758\", \"39686766042766\", \"39686766042782\", \"39686766042790\",  #> \"39686766042808\", \"39686766042824\", \"39686766059927\", \"39686766059935\",  #> \"39686766062087\", \"39686766065874\", \"39686766097794\", \"39686766098651\",  #> \"39686766098677\", \"39686766104665\", \"39686766115422\", \"43693776046361\",  #> \"43693776046379\", \"43693776046387\", \"43693776046395\", \"43693776046403\",  #> \"43693776067177\", \"43693776068928\", \"43693776089288\", \"43693776093033\",  #> \"43693776093041\", \"43693776095335\", \"43693776095343\", \"43693776095350\",  #> \"43695426047575\", \"43733874334470\", \"43733876047583\", \"43733876047591\",  #> \"43733876047609\", \"43733876047625\", \"43733876047633\", \"43733876047641\",  #> \"43733876047666\", \"43733876047674\", \"43733876047682\", \"43733876047690\",  #> \"43733876067219\"), stype = c(2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,  #> 1L, 3L, 3L, 2L, 1L, 3L, 1L, 3L, 1L, 1L, 3L, 1L, 3L, 3L, 1L, 1L,  #> 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 3L, 1L, 1L, 2L, 1L, 1L, 3L,  #> 1L, 1L, 1L, 1L, 3L, 1L, 3L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 3L,  #> 2L, 2L, 2L, 2L, 1L, 1L, 1L, 3L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,  #> 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,  #> 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 3L, 1L,  #> 1L, 3L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 3L, 1L,  #> 2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,  #> 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 3L, 3L, 3L, 3L,  #> 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 3L, 1L, 1L, 3L, 1L, 3L, 1L, 1L,  #> 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 3L, 1L, 3L, 1L, 1L),  #>     name = c(\"San Leandro Hig\", \"Garfield Elemen\", \"Jefferson Eleme\",  #>     \"Madison (James)\", \"McKinley Elemen\", \"Monroe Elementa\",  #>     \"Roosevelt Eleme\", \"Washington Elem\", \"Wilson Elementa\",  #>     \"Bancroft Middle\", \"Muir (John) Mid\", \"Mendota High\", \"McCabe Elementa\",  #>     \"McCabe Junior H\", \"Washington Elem\", \"Sunset Elementa\",  #>     \"Vineland Elemen\", \"Ceres Elementar\", \"East Whittier M\",  #>     \"Evergreen Eleme\", \"Granada Middle\", \"Hillview Middle\", \"La Colima Eleme\",  #>     \"Laurel Elementa\", \"Mulberry Elemen\", \"Murphy Ranch El\",  #>     \"Ocean View Elem\", \"Orchard Dale El\", \"Scott Avenue El\",  #>     \"Leffingwell Ele\", \"Aeolian Element\", \"Rancho Santa Ge\",  #>     \"Willits High\", \"Baechtel Grove \", \"Brookside Eleme\", \"Blosser Lane El\",  #>     \"Delhi High\", \"El Capitan Elem\", \"Schendel Elemen\", \"Delhi Middle\",  #>     \"Acacia Elementa\", \"Fern Drive Elem\", \"Golden Hill Ele\",  #>     \"Hermosa Drive E\", \"Ladera Vista Ju\", \"Laguna Road Ele\",  #>     \"Nicolas Junior \", \"Orangethorpe El\", \"Pacific Drive E\",  #>     \"Raymond Element\", \"Richman Element\", \"Rolling Hills E\",  #>     \"Sunset Lane Ele\", \"Valencia Park E\", \"Woodcrest Eleme\",  #>     \"Parks (D. Russe\", \"Chester Junior-\", \"Greenville Juni\",  #>     \"Portola High\", \"Quincy Junior-S\", \"Greenville Elem\", \"Pioneer Element\",  #>     \"Quincy Elementa\", \"Feather River M\", \"Carmichael (C.R\",  #>     \"Castle Park Ele\", \"Allen (Ella B.)\", \"Rohr (Fred H.) \",  #>     \"Rogers (Greg) E\", \"Halecrest Eleme\", \"Harborside Elem\",  #>     \"Cook (Hazel Goe\", \"Hilltop Drive E\", \"Lauderbach (J. \",  #>     \"Montgomery (Joh\", \"Kellogg (Karl H\", \"Rice (Lilian J.\",  #>     \"Loma Verde Elem\", \"Feaster-Edison \", \"Finney (Myrtle \",  #>     \"Palomar Element\", \"Mueller (Robert\", \"Rosebank Elemen\",  #>     \"Silver Wing Ele\", \"Sunnyside Eleme\", \"Valle Lindo Ele\",  #>     \"Valley Vista El\", \"Vista Square El\", \"Parkview Elemen\",  #>     \"Juarez-Lincoln \", \"Los Altos Eleme\", \"Tiffany (Burton\",  #>     \"Otay Elementary\", \"Chula Vista Hil\", \"Eastlake Elemen\",  #>     \"Clear View Elem\", \"Discovery Eleme\", \"Olympicview Ele\",  #>     \"Casillas (Josep\", \"Oceanside High\", \"El Camino High\", \"Ditmar Elementa\",  #>     \"Jefferson Middl\", \"Laurel Elementa\", \"Libby Elementar\",  #>     \"Lincoln Middle\", \"Mission Element\", \"North Terrace E\", \"Palmquist Eleme\",  #>     \"San Luis Rey El\", \"Santa Margarita\", \"South Oceanside\",  #>     \"San Rafael Elem\", \"E.G. Garrison E\", \"Pacifica Elemen\",  #>     \"Del Rio Element\", \"McAuliffe (Chri\", \"Ivey Ranch Elem\",  #>     \"King (Martin Lu\", \"Stuart Mesa Ele\", \"Edison Senior H\",  #>     \"Franklin Senior\", \"Stagg Senior Hi\", \"Adams Elementar\",  #>     \"August Elementa\", \"Cleveland Eleme\", \"El Dorado Eleme\",  #>     \"Elmwood Element\", \"King Elementary\", \"Fillmore Elemen\",  #>     \"Garfield Elemen\", \"Grunsky Element\", \"Harrison (Willi\",  #>     \"Hazelton Elemen\", \"Hoover Elementa\", \"Kennedy Element\",  #>     \"Madison Element\", \"McKinley Elemen\", \"Monroe Elementa\",  #>     \"Montezuma Eleme\", \"Nightingale Ele\", \"Pulliam Element\",  #>     \"Roosevelt Eleme\", \"Taft (William H\", \"Tyler Skills El\",  #>     \"Van Buren Eleme\", \"Victory Element\", \"Wilson (Woodrow\",  #>     \"Fremont Middle\", \"Marshall Middle\", \"Webster Middle\", \"Hamilton Middle\",  #>     \"Valenzuela (Ric\", \"Stockton (Commo\", \"Kohl (Herbert) \",  #>     \"Washington (Geo\", \"Rio Calaveras E\", \"Laneview Elemen\",  #>     \"Noble Elementar\", \"Northwood Eleme\", \"Piedmont Middle\",  #>     \"Toyon Elementar\", \"Ruskin Elementa\", \"Morrill Middle\", \"Cherrywood Elem\",  #>     \"Sierramont Midd\", \"Vinci Park Elem\", \"Brooktree Eleme\",  #>     \"Majestic Way El\", \"Summerdale Elem\", \"Luther Burbank \",  #>     \"Milpitas High\", \"Rose (Alexander\", \"Spangler (Antho\", \"Curtner Element\",  #>     \"Sinnott (John) \", \"Weller (Joseph)\", \"Pomeroy (Marsha\",  #>     \"Rancho Milpitas\", \"Randall (Robert\", \"Russell (Thomas\",  #>     \"Burnett (Willia\", \"Zanker (Pearl) \"), sname = c(\"San Leandro High\",  #>     \"Garfield Elementary\", \"Jefferson Elementary\", \"Madison (James) Elementary\",  #>     \"McKinley Elementary\", \"Monroe Elementary\", \"Roosevelt Elementary\",  #>     \"Washington Elementary\", \"Wilson Elementary\", \"Bancroft Middle\",  #>     \"Muir (John) Middle\", \"Mendota High\", \"McCabe Elementary\",  #>     \"McCabe Junior High\", \"Washington Elementary\", \"Sunset Elementary\",  #>     \"Vineland Elementary\", \"Ceres Elementary\", \"East Whittier Middle\",  #>     \"Evergreen Elementary\", \"Granada Middle\", \"Hillview Middle\",  #>     \"La Colima Elementary\", \"Laurel Elementary\", \"Mulberry Elementary\",  #>     \"Murphy Ranch Elementary\", \"Ocean View Elementary\", \"Orchard Dale Elementary\",  #>     \"Scott Avenue Elementary\", \"Leffingwell Elementary.\", \"Aeolian Elementary\",  #>     \"Rancho Santa Gertrudes Elementary\", \"Willits High\", \"Baechtel Grove Middle\",  #>     \"Brookside Elementary\", \"Blosser Lane Elementary\", \"Delhi High\",  #>     \"El Capitan Elementary\", \"Schendel Elementary\", \"Delhi Middle\",  #>     \"Acacia Elementary\", \"Fern Drive Elementary\", \"Golden Hill Elementary\",  #>     \"Hermosa Drive Elementary\", \"Ladera Vista Junior High\", \"Laguna Road Elementary\",  #>     \"Nicolas Junior High\", \"Orangethorpe Elementary\", \"Pacific Drive Elementary\",  #>     \"Raymond Elementary\", \"Richman Elementary\", \"Rolling Hills Elementary\",  #>     \"Sunset Lane Elementary\", \"Valencia Park Elementary\", \"Woodcrest Elementary\",  #>     \"Parks (D. Russell) Junior High\", \"Chester Junior-Senior High\",  #>     \"Greenville Junior-Senior High\", \"Portola High\", \"Quincy Junior-Senior High\",  #>     \"Greenville Elementary\", \"Pioneer Elementary\", \"Quincy Elementary\",  #>     \"Feather River Middle\", \"Carmichael (C.Roy) Elementary\",  #>     \"Castle Park Elementary\", \"Allen (Ella B.)/Daly (Ann) Elementary\",  #>     \"Rohr (Fred H.) Elementary\", \"Rogers (Greg) Elementary\",  #>     \"Halecrest Elementary\", \"Harborside Elementary\", \"Cook (Hazel Goes) Elementary\",  #>     \"Hilltop Drive Elementary\", \"Lauderbach (J. Calvin) Elementary\",  #>     \"Montgomery (John J.) Elementary\", \"Kellogg (Karl H.) Elementary\",  #>     \"Rice (Lilian J.) Elementary\", \"Loma Verde Elementary\", \"Feaster-Edison Charter\",  #>     \"Finney (Myrtle S.) Elementary\", \"Palomar Elementary\", \"Mueller (Robert L.) Elementary (Char)\",  #>     \"Rosebank Elementary\", \"Silver Wing Elementary\", \"Sunnyside Elementary\",  #>     \"Valle Lindo Elementary\", \"Valley Vista Elementary\", \"Vista Square Elementary YR\",  #>     \"Parkview Elementary\", \"Juarez-Lincoln Elementary YR\", \"Los Altos Elementary\",  #>     \"Tiffany (Burton C.) Elementary\", \"Otay Elementary\", \"Chula Vista Hills Elementary\",  #>     \"Eastlake Elementary\", \"Clear View Elementary (Char)\", \"Discovery Elementary (Char)\",  #>     \"Olympicview Elementary\", \"Casillas (Joseph) Elementary\",  #>     \"Oceanside High\", \"El Camino High\", \"Ditmar Elementary\",  #>     \"Jefferson Middle\", \"Laurel Elementary\", \"Libby Elementary\",  #>     \"Lincoln Middle\", \"Mission Elementary\", \"North Terrace Elementary\",  #>     \"Palmquist Elementary\", \"San Luis Rey Elementary\", \"Santa Margarita Elementary\",  #>     \"South Oceanside Elementary\", \"San Rafael Elementary\", \"E.G. Garrison Elementary\",  #>     \"Pacifica Elementary\", \"Del Rio Elementary\", \"McAuliffe (Christa) Elementary\",  #>     \"Ivey Ranch Elementary\", \"King (Martin Luther Jr.) Middle\",  #>     \"Stuart Mesa Elementary\", \"Edison Senior High\", \"Franklin Senior High\",  #>     \"Stagg Senior High\", \"Adams Elementary\", \"August Elementary\",  #>     \"Cleveland Elementary\", \"El Dorado Elementary\", \"Elmwood Elementary\",  #>     \"King Elementary\", \"Fillmore Elementary\", \"Garfield Elementary\",  #>     \"Grunsky Elementary\", \"Harrison (William) Elementary\", \"Hazelton Elementary\",  #>     \"Hoover Elementary\", \"Kennedy Elementary\", \"Madison Elementary\",  #>     \"McKinley Elementary\", \"Monroe Elementary\", \"Montezuma Elementary\",  #>     \"Nightingale Elementary\", \"Pulliam Elementary\", \"Roosevelt Elementary\",  #>     \"Taft (William Howard) Elementary\", \"Tyler Skills Elementary\",  #>     \"Van Buren Elementary\", \"Victory Elementary\", \"Wilson (Woodrow) Elementary\",  #>     \"Fremont Middle\", \"Marshall Middle\", \"Webster Middle\", \"Hamilton Middle\",  #>     \"Valenzuela (Richard) Spanish Immersion M\", \"Stockton (Commodore) Skills\",  #>     \"Kohl (Herbert) Open Elementary\", \"Washington (George) Elementary\",  #>     \"Rio Calaveras Elementary\", \"Laneview Elementary\", \"Noble Elementary\",  #>     \"Northwood Elementary\", \"Piedmont Middle\", \"Toyon Elementary\",  #>     \"Ruskin Elementary\", \"Morrill Middle\", \"Cherrywood Elementary\",  #>     \"Sierramont Middle\", \"Vinci Park Elementary\", \"Brooktree Elementary\",  #>     \"Majestic Way Elementary\", \"Summerdale Elementary\", \"Luther Burbank Elementary\",  #>     \"Milpitas High\", \"Rose (Alexander) Elementary\", \"Spangler (Anthony) Elementary\",  #>     \"Curtner Elementary\", \"Sinnott (John) Elementary\", \"Weller (Joseph) Elementary\",  #>     \"Pomeroy (Marshall) Elementary\", \"Rancho Milpitas Junior High\",  #>     \"Randall (Robert) Elementary\", \"Russell (Thomas) Junior High\",  #>     \"Burnett (William) Elementary\", \"Zanker (Pearl) Elementary\" #>     ), snum = c(236, 237, 238, 239, 240, 241, 242, 243, 244,  #>     245, 246, 754, 755, 756, 757, 1023, 1024, 1300, 1301, 1302,  #>     1303, 1304, 1305, 1306, 1307, 1308, 1309, 1310, 1311, 1312,  #>     2093, 2094, 2649, 2650, 2651, 2652, 2714, 2715, 2716, 2717,  #>     2943, 2944, 2945, 2946, 2947, 2948, 2949, 2950, 2951, 2952,  #>     2953, 2954, 2955, 2956, 2957, 2958, 3334, 3335, 3336, 3337,  #>     3338, 3339, 3340, 3341, 3342, 4291, 4292, 4293, 4294, 4295,  #>     4296, 4297, 4298, 4299, 4300, 4301, 4302, 4303, 4304, 4305,  #>     4306, 4307, 4308, 4309, 4310, 4311, 4312, 4313, 4314, 4315,  #>     4316, 4317, 4318, 4319, 4320, 4321, 4322, 4323, 4324, 4658,  #>     4659, 4660, 4661, 4662, 4663, 4664, 4665, 4666, 4667, 4668,  #>     4669, 4670, 4671, 4672, 4673, 4674, 4675, 4676, 4677, 4678,  #>     4856, 4857, 4858, 4859, 4860, 4861, 4862, 4863, 4864, 4865,  #>     4866, 4867, 4868, 4869, 4870, 4871, 4872, 4873, 4874, 4875,  #>     4876, 4877, 4878, 4879, 4880, 4881, 4882, 4883, 4884, 4885,  #>     4886, 4887, 4888, 4889, 4890, 4891, 4892, 5172, 5173, 5174,  #>     5175, 5176, 5177, 5178, 5179, 5180, 5181, 5182, 5183, 5184,  #>     5281, 5439, 5440, 5441, 5442, 5443, 5444, 5445, 5446, 5447,  #>     5448, 5449, 5450), dname = c(\"San Leandro Unified\", \"San Leandro Unified\",  #>     \"San Leandro Unified\", \"San Leandro Unified\", \"San Leandro Unified\",  #>     \"San Leandro Unified\", \"San Leandro Unified\", \"San Leandro Unified\",  #>     \"San Leandro Unified\", \"San Leandro Unified\", \"San Leandro Unified\",  #>     \"Mendota Unified\", \"Mendota Unified\", \"Mendota Unified\",  #>     \"Mendota Unified\", \"Vineland Elementary\", \"Vineland Elementary\",  #>     \"East Whittier City Elem\", \"East Whittier City Elem\", \"East Whittier City Elem\",  #>     \"East Whittier City Elem\", \"East Whittier City Elem\", \"East Whittier City Elem\",  #>     \"East Whittier City Elem\", \"East Whittier City Elem\", \"East Whittier City Elem\",  #>     \"East Whittier City Elem\", \"East Whittier City Elem\", \"East Whittier City Elem\",  #>     \"East Whittier City Elem\", \"Los Nietos Elementary\", \"Los Nietos Elementary\",  #>     \"Willits Unified\", \"Willits Unified\", \"Willits Unified\",  #>     \"Willits Unified\", \"Delhi Unified\", \"Delhi Unified\", \"Delhi Unified\",  #>     \"Delhi Unified\", \"Fullerton Elementary\", \"Fullerton Elementary\",  #>     \"Fullerton Elementary\", \"Fullerton Elementary\", \"Fullerton Elementary\",  #>     \"Fullerton Elementary\", \"Fullerton Elementary\", \"Fullerton Elementary\",  #>     \"Fullerton Elementary\", \"Fullerton Elementary\", \"Fullerton Elementary\",  #>     \"Fullerton Elementary\", \"Fullerton Elementary\", \"Fullerton Elementary\",  #>     \"Fullerton Elementary\", \"Fullerton Elementary\", \"Plumas Unified\",  #>     \"Plumas Unified\", \"Plumas Unified\", \"Plumas Unified\", \"Plumas Unified\",  #>     \"Plumas Unified\", \"Plumas Unified\", \"Plumas Unified\", \"Plumas Unified\",  #>     \"Chula Vista Elementary\", \"Chula Vista Elementary\", \"Chula Vista Elementary\",  #>     \"Chula Vista Elementary\", \"Chula Vista Elementary\", \"Chula Vista Elementary\",  #>     \"Chula Vista Elementary\", \"Chula Vista Elementary\", \"Chula Vista Elementary\",  #>     \"Chula Vista Elementary\", \"Chula Vista Elementary\", \"Chula Vista Elementary\",  #>     \"Chula Vista Elementary\", \"Chula Vista Elementary\", \"Chula Vista Elementary\",  #>     \"Chula Vista Elementary\", \"Chula Vista Elementary\", \"Chula Vista Elementary\",  #>     \"Chula Vista Elementary\", \"Chula Vista Elementary\", \"Chula Vista Elementary\",  #>     \"Chula Vista Elementary\", \"Chula Vista Elementary\", \"Chula Vista Elementary\",  #>     \"Chula Vista Elementary\", \"Chula Vista Elementary\", \"Chula Vista Elementary\",  #>     \"Chula Vista Elementary\", \"Chula Vista Elementary\", \"Chula Vista Elementary\",  #>     \"Chula Vista Elementary\", \"Chula Vista Elementary\", \"Chula Vista Elementary\",  #>     \"Chula Vista Elementary\", \"Oceanside Unified\", \"Oceanside Unified\",  #>     \"Oceanside Unified\", \"Oceanside Unified\", \"Oceanside Unified\",  #>     \"Oceanside Unified\", \"Oceanside Unified\", \"Oceanside Unified\",  #>     \"Oceanside Unified\", \"Oceanside Unified\", \"Oceanside Unified\",  #>     \"Oceanside Unified\", \"Oceanside Unified\", \"Oceanside Unified\",  #>     \"Oceanside Unified\", \"Oceanside Unified\", \"Oceanside Unified\",  #>     \"Oceanside Unified\", \"Oceanside Unified\", \"Oceanside Unified\",  #>     \"Oceanside Unified\", \"Stockton City Unified\", \"Stockton City Unified\",  #>     \"Stockton City Unified\", \"Stockton City Unified\", \"Stockton City Unified\",  #>     \"Stockton City Unified\", \"Stockton City Unified\", \"Stockton City Unified\",  #>     \"Stockton City Unified\", \"Stockton City Unified\", \"Stockton City Unified\",  #>     \"Stockton City Unified\", \"Stockton City Unified\", \"Stockton City Unified\",  #>     \"Stockton City Unified\", \"Stockton City Unified\", \"Stockton City Unified\",  #>     \"Stockton City Unified\", \"Stockton City Unified\", \"Stockton City Unified\",  #>     \"Stockton City Unified\", \"Stockton City Unified\", \"Stockton City Unified\",  #>     \"Stockton City Unified\", \"Stockton City Unified\", \"Stockton City Unified\",  #>     \"Stockton City Unified\", \"Stockton City Unified\", \"Stockton City Unified\",  #>     \"Stockton City Unified\", \"Stockton City Unified\", \"Stockton City Unified\",  #>     \"Stockton City Unified\", \"Stockton City Unified\", \"Stockton City Unified\",  #>     \"Stockton City Unified\", \"Stockton City Unified\", \"Berryessa Union Elem\",  #>     \"Berryessa Union Elem\", \"Berryessa Union Elem\", \"Berryessa Union Elem\",  #>     \"Berryessa Union Elem\", \"Berryessa Union Elem\", \"Berryessa Union Elem\",  #>     \"Berryessa Union Elem\", \"Berryessa Union Elem\", \"Berryessa Union Elem\",  #>     \"Berryessa Union Elem\", \"Berryessa Union Elem\", \"Berryessa Union Elem\",  #>     \"Luther Burbank Elem\", \"Milpitas Unified\", \"Milpitas Unified\",  #>     \"Milpitas Unified\", \"Milpitas Unified\", \"Milpitas Unified\",  #>     \"Milpitas Unified\", \"Milpitas Unified\", \"Milpitas Unified\",  #>     \"Milpitas Unified\", \"Milpitas Unified\", \"Milpitas Unified\",  #>     \"Milpitas Unified\"), dnum = c(637L, 637L, 637L, 637L, 637L,  #>     637L, 637L, 637L, 637L, 637L, 637L, 437L, 437L, 437L, 437L,  #>     778L, 778L, 197L, 197L, 197L, 197L, 197L, 197L, 197L, 197L,  #>     197L, 197L, 197L, 197L, 197L, 406L, 406L, 815L, 815L, 815L,  #>     815L, 178L, 178L, 178L, 178L, 255L, 255L, 255L, 255L, 255L,  #>     255L, 255L, 255L, 255L, 255L, 255L, 255L, 255L, 255L, 255L,  #>     255L, 568L, 568L, 568L, 568L, 568L, 568L, 568L, 568L, 568L,  #>     135L, 135L, 135L, 135L, 135L, 135L, 135L, 135L, 135L, 135L,  #>     135L, 135L, 135L, 135L, 135L, 135L, 135L, 135L, 135L, 135L,  #>     135L, 135L, 135L, 135L, 135L, 135L, 135L, 135L, 135L, 135L,  #>     135L, 135L, 135L, 135L, 510L, 510L, 510L, 510L, 510L, 510L,  #>     510L, 510L, 510L, 510L, 510L, 510L, 510L, 510L, 510L, 510L,  #>     510L, 510L, 510L, 510L, 510L, 716L, 716L, 716L, 716L, 716L,  #>     716L, 716L, 716L, 716L, 716L, 716L, 716L, 716L, 716L, 716L,  #>     716L, 716L, 716L, 716L, 716L, 716L, 716L, 716L, 716L, 716L,  #>     716L, 716L, 716L, 716L, 716L, 716L, 716L, 716L, 716L, 716L,  #>     716L, 716L, 61L, 61L, 61L, 61L, 61L, 61L, 61L, 61L, 61L,  #>     61L, 61L, 61L, 61L, 413L, 448L, 448L, 448L, 448L, 448L, 448L,  #>     448L, 448L, 448L, 448L, 448L, 448L), cname = c(\"Alameda\",  #>     \"Alameda\", \"Alameda\", \"Alameda\", \"Alameda\", \"Alameda\", \"Alameda\",  #>     \"Alameda\", \"Alameda\", \"Alameda\", \"Alameda\", \"Fresno\", \"Fresno\",  #>     \"Fresno\", \"Fresno\", \"Kern\", \"Kern\", \"Los Angeles\", \"Los Angeles\",  #>     \"Los Angeles\", \"Los Angeles\", \"Los Angeles\", \"Los Angeles\",  #>     \"Los Angeles\", \"Los Angeles\", \"Los Angeles\", \"Los Angeles\",  #>     \"Los Angeles\", \"Los Angeles\", \"Los Angeles\", \"Los Angeles\",  #>     \"Los Angeles\", \"Mendocino\", \"Mendocino\", \"Mendocino\", \"Mendocino\",  #>     \"Merced\", \"Merced\", \"Merced\", \"Merced\", \"Orange\", \"Orange\",  #>     \"Orange\", \"Orange\", \"Orange\", \"Orange\", \"Orange\", \"Orange\",  #>     \"Orange\", \"Orange\", \"Orange\", \"Orange\", \"Orange\", \"Orange\",  #>     \"Orange\", \"Orange\", \"Plumas\", \"Plumas\", \"Plumas\", \"Plumas\",  #>     \"Plumas\", \"Plumas\", \"Plumas\", \"Plumas\", \"Plumas\", \"San Diego\",  #>     \"San Diego\", \"San Diego\", \"San Diego\", \"San Diego\", \"San Diego\",  #>     \"San Diego\", \"San Diego\", \"San Diego\", \"San Diego\", \"San Diego\",  #>     \"San Diego\", \"San Diego\", \"San Diego\", \"San Diego\", \"San Diego\",  #>     \"San Diego\", \"San Diego\", \"San Diego\", \"San Diego\", \"San Diego\",  #>     \"San Diego\", \"San Diego\", \"San Diego\", \"San Diego\", \"San Diego\",  #>     \"San Diego\", \"San Diego\", \"San Diego\", \"San Diego\", \"San Diego\",  #>     \"San Diego\", \"San Diego\", \"San Diego\", \"San Diego\", \"San Diego\",  #>     \"San Diego\", \"San Diego\", \"San Diego\", \"San Diego\", \"San Diego\",  #>     \"San Diego\", \"San Diego\", \"San Diego\", \"San Diego\", \"San Diego\",  #>     \"San Diego\", \"San Diego\", \"San Diego\", \"San Diego\", \"San Diego\",  #>     \"San Diego\", \"San Diego\", \"San Diego\", \"San Diego\", \"San Joaquin\",  #>     \"San Joaquin\", \"San Joaquin\", \"San Joaquin\", \"San Joaquin\",  #>     \"San Joaquin\", \"San Joaquin\", \"San Joaquin\", \"San Joaquin\",  #>     \"San Joaquin\", \"San Joaquin\", \"San Joaquin\", \"San Joaquin\",  #>     \"San Joaquin\", \"San Joaquin\", \"San Joaquin\", \"San Joaquin\",  #>     \"San Joaquin\", \"San Joaquin\", \"San Joaquin\", \"San Joaquin\",  #>     \"San Joaquin\", \"San Joaquin\", \"San Joaquin\", \"San Joaquin\",  #>     \"San Joaquin\", \"San Joaquin\", \"San Joaquin\", \"San Joaquin\",  #>     \"San Joaquin\", \"San Joaquin\", \"San Joaquin\", \"San Joaquin\",  #>     \"San Joaquin\", \"San Joaquin\", \"San Joaquin\", \"San Joaquin\",  #>     \"Santa Clara\", \"Santa Clara\", \"Santa Clara\", \"Santa Clara\",  #>     \"Santa Clara\", \"Santa Clara\", \"Santa Clara\", \"Santa Clara\",  #>     \"Santa Clara\", \"Santa Clara\", \"Santa Clara\", \"Santa Clara\",  #>     \"Santa Clara\", \"Santa Clara\", \"Santa Clara\", \"Santa Clara\",  #>     \"Santa Clara\", \"Santa Clara\", \"Santa Clara\", \"Santa Clara\",  #>     \"Santa Clara\", \"Santa Clara\", \"Santa Clara\", \"Santa Clara\",  #>     \"Santa Clara\", \"Santa Clara\"), cnum = c(1L, 1L, 1L, 1L, 1L,  #>     1L, 1L, 1L, 1L, 1L, 1L, 9L, 9L, 9L, 9L, 14L, 14L, 18L, 18L,  #>     18L, 18L, 18L, 18L, 18L, 18L, 18L, 18L, 18L, 18L, 18L, 18L,  #>     18L, 22L, 22L, 22L, 22L, 23L, 23L, 23L, 23L, 29L, 29L, 29L,  #>     29L, 29L, 29L, 29L, 29L, 29L, 29L, 29L, 29L, 29L, 29L, 29L,  #>     29L, 31L, 31L, 31L, 31L, 31L, 31L, 31L, 31L, 31L, 36L, 36L,  #>     36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L,  #>     36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L,  #>     36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L,  #>     36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L,  #>     36L, 36L, 36L, 36L, 36L, 38L, 38L, 38L, 38L, 38L, 38L, 38L,  #>     38L, 38L, 38L, 38L, 38L, 38L, 38L, 38L, 38L, 38L, 38L, 38L,  #>     38L, 38L, 38L, 38L, 38L, 38L, 38L, 38L, 38L, 38L, 38L, 38L,  #>     38L, 38L, 38L, 38L, 38L, 38L, 42L, 42L, 42L, 42L, 42L, 42L,  #>     42L, 42L, 42L, 42L, 42L, 42L, 42L, 42L, 42L, 42L, 42L, 42L,  #>     42L, 42L, 42L, 42L, 42L, 42L, 42L, 42L), flag = c(NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_, NA_integer_, NA_integer_, NA_integer_,  #>     NA_integer_, NA_integer_), pcttest = c(97L, 100L, 100L, 100L,  #>     99L, 100L, 99L, 99L, 100L, 100L, 99L, 94L, 96L, 99L, 88L,  #>     100L, 99L, 96L, 98L, 99L, 100L, 99L, 100L, 100L, 99L, 98L,  #>     100L, 100L, 99L, 100L, 99L, 100L, 93L, 97L, 100L, 98L, 100L,  #>     100L, 98L, 100L, 100L, 100L, 100L, 100L, 100L, 99L, 100L,  #>     100L, 100L, 100L, 100L, 100L, 100L, 100L, 100L, 99L, 99L,  #>     100L, 99L, 97L, 100L, 100L, 99L, 100L, 100L, 99L, 99L, 100L,  #>     100L, 100L, 100L, 99L, 98L, 99L, 98L, 100L, 99L, 99L, 98L,  #>     100L, 99L, 97L, 100L, 100L, 99L, 100L, 100L, 99L, 99L, 99L,  #>     97L, 100L, 99L, 100L, 99L, 99L, 100L, 100L, 100L, 99L, 98L,  #>     99L, 100L, 100L, 100L, 99L, 100L, 99L, 99L, 100L, 100L, 100L,  #>     98L, 99L, 99L, 100L, 100L, 100L, 99L, 99L, 95L, 89L, 97L,  #>     99L, 96L, 97L, 100L, 99L, 98L, 99L, 99L, 100L, 100L, 98L,  #>     99L, 98L, 96L, 99L, 100L, 99L, 98L, 98L, 100L, 100L, 99L,  #>     99L, 99L, 99L, 97L, 93L, 100L, 96L, 100L, 99L, 100L, 100L,  #>     99L, 98L, 100L, 100L, 100L, 100L, 100L, 99L, 100L, 100L,  #>     100L, 98L, 100L, 99L, 100L, 97L, 100L, 99L, 100L, 99L, 99L,  #>     99L, 99L, 100L, 99L, 100L, 100L), api00 = c(608L, 684L, 612L,  #>     710L, 729L, 714L, 759L, 585L, 625L, 664L, 669L, 443L, 467L,  #>     482L, 496L, 411L, 494L, 493L, 592L, 550L, 689L, 598L, 628L,  #>     652L, 628L, 832L, 777L, 709L, 709L, 736L, 561L, 555L, 696L,  #>     631L, 564L, 602L, 529L, 491L, 510L, 547L, 814L, 806L, 715L,  #>     785L, 720L, 905L, 617L, 630L, 629L, 696L, 476L, 757L, 825L,  #>     595L, 552L, 847L, 714L, 724L, 687L, 723L, 662L, 699L, 807L,  #>     679L, 691L, 622L, 754L, 655L, 764L, 795L, 505L, 638L, 733L,  #>     523L, 511L, 710L, 657L, 602L, 490L, 664L, 651L, 603L, 698L,  #>     511L, 814L, 669L, 711L, 538L, 705L, 595L, 551L, 762L, 521L,  #>     709L, 780L, 780L, 722L, 828L, 737L, 595L, 661L, 502L, 614L,  #>     585L, 582L, 642L, 536L, 746L, 667L, 629L, 745L, 674L, 637L,  #>     696L, 632L, 639L, 745L, 789L, 656L, 789L, 517L, 478L, 582L,  #>     592L, 587L, 553L, 516L, 535L, 566L, 481L, 472L, 559L, 610L,  #>     599L, 551L, 554L, 561L, 505L, 492L, 504L, 487L, 627L, 465L,  #>     529L, 625L, 436L, 542L, 515L, 461L, 528L, 512L, 508L, 670L,  #>     760L, 652L, 546L, 717L, 701L, 748L, 735L, 699L, 685L, 827L,  #>     711L, 677L, 759L, 697L, 742L, 691L, 700L, 551L, 703L, 676L,  #>     714L, 842L, 824L, 717L, 836L, 733L, 719L, 817L, 749L, 781L #>     ), api99 = c(562L, 554L, 528L, 669L, 660L, 673L, 693L, 567L,  #>     576L, 598L, 619L, 414L, 420L, 404L, 365L, 408L, 404L, 469L,  #>     601L, 464L, 679L, 594L, 560L, 608L, 565L, 779L, 739L, 645L,  #>     716L, 710L, 508L, 496L, 706L, 641L, 545L, 587L, 469L, 423L,  #>     454L, 575L, 762L, 785L, 682L, 779L, 700L, 890L, 591L, 599L,  #>     615L, 648L, 454L, 750L, 802L, 534L, 553L, 827L, 696L, 715L,  #>     687L, 693L, 601L, 730L, 805L, 662L, 664L, 609L, 748L, 632L,  #>     664L, 758L, 452L, 632L, 688L, 441L, 480L, 692L, 579L, 586L,  #>     431L, 669L, 621L, 520L, 680L, 493L, 801L, 658L, 745L, 502L,  #>     655L, 555L, 484L, 744L, 473L, 701L, 747L, 769L, 684L, 806L,  #>     698L, 593L, 648L, 413L, 607L, 465L, 512L, 618L, 515L, 669L,  #>     648L, 631L, 637L, 657L, 566L, 662L, 553L, 593L, 710L, 759L,  #>     615L, 712L, 495L, 443L, 551L, 556L, 518L, 490L, 433L, 509L,  #>     541L, 469L, 386L, 512L, 520L, 549L, 531L, 513L, 550L, 505L,  #>     494L, 451L, 443L, 582L, 440L, 482L, 578L, 415L, 525L, 526L,  #>     427L, 499L, 479L, 479L, 650L, 736L, 613L, 452L, 659L, 691L,  #>     718L, 695L, 701L, 668L, 812L, 669L, 639L, 764L, 668L, 725L,  #>     660L, 635L, 502L, 668L, 644L, 617L, 790L, 801L, 687L, 785L,  #>     703L, 619L, 755L, 676L, 733L), target = c(12L, 12L, 14L,  #>     7L, 7L, 6L, 5L, 12L, 11L, 10L, 9L, 19L, 19L, 20L, 22L, 20L,  #>     20L, 17L, 10L, 17L, 6L, 10L, 12L, 10L, 12L, 1L, 3L, 8L, 4L,  #>     5L, 15L, 15L, 5L, 8L, 13L, 11L, 17L, 19L, 17L, 11L, 2L, 1L,  #>     6L, 1L, 5L, NA, 10L, 10L, 9L, 8L, 17L, 3L, NA, 13L, 12L,  #>     NA, 5L, 4L, 6L, 5L, 10L, 4L, NA, 7L, 7L, 10L, 3L, 8L, 7L,  #>     2L, 17L, 8L, 6L, 18L, 16L, 5L, 11L, 11L, 18L, 7L, 9L, 14L,  #>     6L, 15L, NA, 7L, 3L, 15L, 7L, 12L, 16L, 3L, 16L, 5L, 3L,  #>     2L, 6L, NA, 5L, 10L, 8L, 19L, 10L, 17L, 14L, 9L, 14L, 7L,  #>     8L, 8L, 8L, 7L, 12L, 7L, 12L, 10L, 5L, 2L, 9L, 4L, 15L, 18L,  #>     12L, 12L, 14L, 16L, 18L, 15L, 13L, 17L, 21L, 14L, 14L, 13L,  #>     13L, 14L, 13L, 15L, 15L, 17L, 18L, 11L, 18L, 16L, 11L, 19L,  #>     14L, 14L, 19L, 15L, 16L, 16L, 8L, 3L, 9L, 17L, 7L, 5L, 4L,  #>     5L, 5L, 7L, NA, 7L, 8L, 2L, 7L, 4L, 7L, 8L, 15L, 7L, 8L,  #>     9L, 1L, NA, 6L, 1L, 5L, 9L, 2L, 6L, 3L), growth = c(46L,  #>     130L, 84L, 41L, 69L, 41L, 66L, 18L, 49L, 66L, 50L, 29L, 47L,  #>     78L, 131L, 3L, 90L, 24L, -9L, 86L, 10L, 4L, 68L, 44L, 63L,  #>     53L, 38L, 64L, -7L, 26L, 53L, 59L, -10L, -10L, 19L, 15L,  #>     60L, 68L, 56L, -28L, 52L, 21L, 33L, 6L, 20L, 15L, 26L, 31L,  #>     14L, 48L, 22L, 7L, 23L, 61L, -1L, 20L, 18L, 9L, 0L, 30L,  #>     61L, -31L, 2L, 17L, 27L, 13L, 6L, 23L, 100L, 37L, 53L, 6L,  #>     45L, 82L, 31L, 18L, 78L, 16L, 59L, -5L, 30L, 83L, 18L, 18L,  #>     13L, 11L, -34L, 36L, 50L, 40L, 67L, 18L, 48L, 8L, 33L, 11L,  #>     38L, 22L, 39L, 2L, 13L, 89L, 7L, 120L, 70L, 24L, 21L, 77L,  #>     19L, -2L, 108L, 17L, 71L, 34L, 79L, 46L, 35L, 30L, 41L, 77L,  #>     22L, 35L, 31L, 36L, 69L, 63L, 83L, 26L, 25L, 12L, 86L, 47L,  #>     90L, 50L, 20L, 41L, 11L, 0L, -2L, 53L, 44L, 45L, 25L, 47L,  #>     47L, 21L, 17L, -11L, 34L, 29L, 33L, 29L, 20L, 24L, 39L, 94L,  #>     58L, 10L, 30L, 40L, -2L, 17L, 15L, 42L, 38L, -5L, 29L, 17L,  #>     31L, 65L, 49L, 35L, 32L, 97L, 52L, 23L, 30L, 51L, 30L, 100L,  #>     62L, 73L, 48L), sch.wide = c(2L, 2L, 2L, 2L, 2L, 2L, 2L,  #>     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 1L,  #>     2L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, 1L, 2L, 2L, 2L,  #>     2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,  #>     2L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L,  #>     2L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L,  #>     2L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,  #>     2L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L,  #>     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,  #>     2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 2L,  #>     2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,  #>     2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 2L,  #>     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L), comp.imp = c(2L,  #>     2L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 1L,  #>     2L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L,  #>     2L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, 2L,  #>     2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, 1L, 2L, 2L,  #>     1L, 1L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 1L,  #>     2L, 1L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, 2L,  #>     2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 2L,  #>     1L, 2L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 1L,  #>     2L, 1L, 2L, 2L, 2L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 2L, 1L, 2L,  #>     1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 1L, 2L, 2L, 2L,  #>     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, 2L, 1L,  #>     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L,  #>     2L, 2L), both = c(2L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, 2L,  #>     2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 2L,  #>     2L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 1L,  #>     2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 1L,  #>     2L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 2L, 2L, 2L,  #>     2L, 1L, 2L, 2L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 2L, 2L, 2L, 2L,  #>     1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 1L,  #>     1L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, 2L, 2L,  #>     2L, 2L, 1L, 2L, 2L, 1L, 2L, 1L, 2L, 2L, 2L, 2L, 1L, 2L, 1L,  #>     2L, 1L, 2L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L,  #>     1L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 1L,  #>     1L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,  #>     2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L), awards = c(2L, 2L, 2L, 1L,  #>     2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 2L, 2L, 1L,  #>     2L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, 1L,  #>     1L, 1L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L,  #>     2L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, 1L,  #>     2L, 2L, 1L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, 1L, 2L,  #>     1L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,  #>     2L, 2L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, 1L,  #>     1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 2L,  #>     2L, 2L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 2L, 1L, 2L, 1L, 1L, 1L,  #>     2L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 2L, 2L, 2L,  #>     2L, 2L, 2L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 2L,  #>     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L),  #>     meals = c(19L, 39L, 39L, 23L, 43L, 36L, 17L, 43L, 48L, 28L,  #>     37L, 84L, 96L, 98L, 98L, 97L, 97L, 61L, 35L, 84L, 17L, 30L,  #>     53L, 50L, 50L, 6L, 9L, 23L, 23L, 15L, 87L, 78L, 29L, 46L,  #>     55L, 52L, 72L, 85L, 81L, 75L, 19L, 16L, 34L, 26L, 33L, 9L,  #>     45L, 53L, 52L, 52L, 89L, 18L, 10L, 69L, 66L, 10L, 21L, 33L,  #>     21L, 25L, 68L, 35L, 41L, 35L, 41L, 65L, 25L, 65L, 29L, 26L,  #>     75L, 49L, 36L, 74L, 79L, 36L, 67L, 68L, 71L, 54L, 51L, 71L,  #>     44L, 67L, 12L, 47L, 30L, 79L, 46L, 60L, 70L, 18L, 74L, 18L,  #>     15L, 18L, 11L, 5L, 16L, 48L, 32L, 90L, 55L, 83L, 75L, 44L,  #>     86L, 53L, 44L, 49L, 52L, 48L, 58L, 71L, 67L, 58L, 42L, 26L,  #>     45L, 51L, 40L, 42L, 36L, 80L, 90L, 100L, 100L, 78L, 100L,  #>     91L, 100L, 100L, 84L, 80L, 68L, 84L, 71L, 89L, 99L, 90L,  #>     86L, 86L, 90L, 83L, 59L, 100L, 76L, 80L, 65L, 58L, 58L, 53L,  #>     46L, 29L, 37L, 100L, 58L, 35L, 18L, 36L, 18L, 25L, 13L, 22L,  #>     26L, 17L, 30L, 26L, 19L, 23L, 76L, 24L, 46L, 31L, 18L, 15L,  #>     41L, 18L, 33L, 47L, 23L, 29L, 26L), ell = c(22L, 23L, 27L,  #>     17L, 27L, 24L, 10L, 33L, 36L, 21L, 26L, 52L, 70L, 73L, 72L,  #>     42L, 53L, 38L, 25L, 67L, 12L, 14L, 29L, 29L, 25L, 4L, 2L,  #>     8L, 13L, 4L, 39L, 22L, 3L, 4L, 8L, 4L, 28L, 38L, 45L, 37L,  #>     11L, 27L, 27L, 8L, 12L, 12L, 27L, 22L, 26L, 35L, 70L, 12L,  #>     26L, 42L, 46L, 5L, 0L, 1L, 2L, 1L, 0L, 1L, 0L, 0L, 6L, 32L,  #>     25L, 44L, 13L, 14L, 59L, 16L, 18L, 52L, 61L, 18L, 36L, 37L,  #>     54L, 32L, 26L, 54L, 18L, 46L, 8L, 23L, 25L, 48L, 42L, 34L,  #>     50L, 16L, 63L, 16L, 25L, 23L, 21L, 13L, 21L, 11L, 7L, 72L,  #>     19L, 64L, 39L, 21L, 59L, 8L, 29L, 26L, 1L, 20L, 44L, 44L,  #>     32L, 37L, 16L, 8L, 14L, 1L, 23L, 25L, 14L, 33L, 34L, 55L,  #>     35L, 31L, 49L, 30L, 39L, 37L, 34L, 36L, 26L, 24L, 30L, 43L,  #>     42L, 46L, 26L, 35L, 27L, 28L, 8L, 49L, 20L, 26L, 25L, 27L,  #>     23L, 27L, 3L, 6L, 9L, 39L, 21L, 35L, 24L, 20L, 25L, 18L,  #>     25L, 29L, 34L, 17L, 41L, 56L, 27L, 55L, 38L, 21L, 39L, 25L,  #>     17L, 21L, 26L, 24L, 29L, 48L, 13L, 31L, 30L), yr.rnd = c(1L,  #>     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,  #>     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,  #>     1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,  #>     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,  #>     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L,  #>     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,  #>     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,  #>     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,  #>     1L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L,  #>     1L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L,  #>     1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,  #>     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,  #>     1L, 1L), mobility = c(15L, 23L, 25L, 39L, 23L, 17L, 14L,  #>     18L, 17L, 16L, 18L, 98L, 12L, 2L, 9L, 18L, 18L, 17L, 9L,  #>     15L, 10L, 15L, 17L, 18L, 13L, 15L, 16L, 14L, 13L, 17L, 10L,  #>     13L, 9L, 15L, 11L, 19L, 99L, 15L, 14L, 10L, 10L, 13L, 15L,  #>     15L, 12L, 20L, 14L, 20L, 18L, 14L, 17L, 25L, 21L, 13L, 21L,  #>     9L, 10L, 19L, 10L, 5L, 9L, 12L, 17L, 14L, 14L, 14L, 18L,  #>     21L, 23L, 23L, 27L, 18L, 12L, 23L, 38L, 16L, 17L, 19L, 25L,  #>     13L, 14L, 19L, 21L, 18L, 16L, 19L, 14L, 24L, 32L, 21L, 15L,  #>     15L, 15L, 20L, 21L, 17L, 20L, 11L, 49L, 15L, 12L, 16L, 42L,  #>     19L, 29L, 31L, 28L, 27L, 18L, 16L, 26L, 15L, 15L, 29L, 27L,  #>     19L, 21L, 28L, 27L, 26L, 17L, 11L, 10L, 22L, 20L, 23L, 33L,  #>     14L, 17L, 22L, 19L, 22L, 27L, 26L, 24L, 23L, 23L, 30L, 17L,  #>     19L, 26L, 16L, 21L, 16L, 19L, 19L, 26L, 31L, 13L, 10L, 14L,  #>     11L, 5L, 5L, 3L, 16L, 20L, 6L, 4L, 12L, 9L, 11L, 2L, 10L,  #>     0L, 10L, 10L, 4L, 14L, 16L, 16L, 8L, 7L, 10L, 12L, 10L, 10L,  #>     12L, 11L, 11L, 5L, 12L, 11L), acs.k3 = c(NA, 19L, 21L, 19L,  #>     22L, 21L, 21L, 21L, 21L, NA, NA, NA, 18L, NA, 20L, NA, 18L,  #>     17L, NA, 18L, NA, NA, 18L, 19L, 18L, 18L, 19L, 18L, 18L,  #>     18L, 17L, 17L, NA, NA, 18L, 20L, NA, 20L, 20L, NA, 23L, 22L,  #>     23L, 24L, NA, 23L, NA, 23L, 23L, 24L, 23L, 22L, 23L, 24L,  #>     24L, NA, NA, NA, NA, NA, 21L, 18L, 16L, NA, 19L, 20L, 20L,  #>     20L, 20L, 19L, 19L, 19L, 20L, 19L, 20L, 19L, 19L, 19L, 23L,  #>     20L, 20L, 19L, 19L, 18L, 18L, 18L, 19L, 20L, 17L, 19L, 18L,  #>     20L, 19L, 17L, 19L, 19L, 20L, 19L, 18L, NA, NA, 21L, NA,  #>     23L, 23L, NA, 24L, 19L, 24L, 24L, 22L, 22L, 23L, 24L, 23L,  #>     24L, 23L, 21L, NA, 23L, NA, NA, NA, 18L, 21L, 19L, 18L, 19L,  #>     20L, 20L, 21L, 19L, 20L, 19L, 20L, 19L, 19L, 19L, 19L, 20L,  #>     18L, 20L, 21L, 18L, 19L, 19L, 20L, 19L, NA, NA, NA, NA, 17L,  #>     20L, 21L, 16L, 21L, 20L, 20L, 20L, NA, 19L, 19L, NA, 19L,  #>     NA, 20L, 20L, 19L, 20L, 18L, NA, 21L, 21L, 20L, 21L, 21L,  #>     22L, NA, 20L, NA, 21L, 21L), acs.46 = c(NA, 30L, 30L, 26L,  #>     30L, 28L, 30L, 31L, 28L, 30L, 30L, NA, 29L, NA, NA, 30L,  #>     29L, 29L, 29L, 30L, 29L, 30L, 27L, 30L, 28L, 27L, 30L, 28L,  #>     30L, 30L, 31L, 30L, NA, 22L, NA, 27L, NA, 28L, 28L, NA, 27L,  #>     30L, 30L, 26L, NA, 31L, NA, 33L, 29L, 32L, 31L, 31L, 31L,  #>     31L, 29L, NA, NA, NA, NA, NA, 26L, 28L, 28L, 24L, 28L, 29L,  #>     27L, 29L, 29L, 28L, 30L, 30L, 28L, 28L, 29L, 30L, 30L, 29L,  #>     30L, 30L, 29L, 30L, 29L, 31L, 29L, 29L, 29L, 31L, 27L, 31L,  #>     29L, 30L, 31L, 27L, 30L, 29L, 28L, 29L, 29L, NA, NA, 23L,  #>     30L, 32L, 32L, 32L, 32L, 31L, 32L, 33L, 26L, 32L, 27L, 35L,  #>     30L, 26L, 32L, 30L, 31L, 29L, NA, NA, NA, 27L, 31L, 24L,  #>     25L, 32L, 23L, 30L, 21L, 30L, 27L, 29L, 31L, 26L, 32L, 33L,  #>     29L, 26L, 21L, 25L, 26L, 23L, 28L, 24L, 33L, 25L, NA, NA,  #>     NA, NA, 27L, 30L, 27L, 19L, 26L, 32L, 30L, 30L, 30L, 28L,  #>     30L, 27L, 31L, 29L, 30L, 32L, 29L, 30L, 29L, NA, 32L, 33L,  #>     30L, 30L, 32L, 31L, NA, 35L, 32L, 30L, 32L), acs.core = c(27L,  #>     NA, NA, NA, NA, NA, NA, NA, NA, 28L, 26L, 27L, NA, 28L, NA,  #>     32L, NA, NA, 29L, NA, 28L, 30L, NA, NA, NA, NA, NA, NA, NA,  #>     NA, NA, NA, 22L, 23L, NA, NA, 24L, NA, NA, NA, NA, NA, NA,  #>     NA, 27L, NA, 29L, NA, NA, NA, NA, NA, NA, NA, NA, 28L, 20L,  #>     17L, 21L, 25L, NA, NA, NA, 29L, NA, NA, NA, NA, NA, NA, NA,  #>     NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,  #>     NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 29L,  #>     31L, NA, 31L, NA, NA, 31L, NA, NA, NA, NA, NA, NA, NA, NA,  #>     NA, NA, NA, NA, 32L, NA, 30L, 31L, 30L, NA, NA, NA, NA, NA,  #>     NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,  #>     NA, NA, NA, NA, NA, 28L, 29L, 30L, 29L, NA, 28L, NA, NA,  #>     NA, NA, NA, NA, 29L, NA, NA, 28L, NA, 29L, NA, NA, NA, NA,  #>     NA, 31L, NA, NA, NA, NA, NA, NA, 30L, NA, 31L, NA, NA), pct.resp = c(90L,  #>     85L, 95L, 92L, 85L, 97L, 95L, 70L, 93L, 85L, 94L, 53L, 95L,  #>     98L, 98L, 94L, 97L, 96L, 55L, 91L, 92L, 93L, 98L, 100L, 99L,  #>     82L, 95L, 98L, 99L, 93L, 70L, 68L, 94L, 91L, 80L, 72L, 61L,  #>     93L, 90L, 97L, 95L, 96L, 93L, 98L, 92L, 93L, 85L, 92L, 95L,  #>     96L, 99L, 86L, 95L, 97L, 98L, 96L, 89L, 84L, 89L, 87L, 77L,  #>     86L, 96L, 92L, 68L, 0L, 5L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  #>     0L, 2L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  #>     0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 96L, 92L, 91L, 84L, 82L,  #>     62L, 91L, 69L, 85L, 78L, 95L, 98L, 71L, 99L, 96L, 100L, 88L,  #>     85L, 78L, 83L, 98L, 66L, 73L, 94L, 60L, 98L, 96L, 41L, 5L,  #>     93L, 47L, 0L, 38L, 30L, 16L, 46L, 61L, 58L, 6L, 18L, 5L,  #>     1L, 26L, 11L, 68L, 74L, 11L, 99L, 37L, 53L, 55L, 75L, 64L,  #>     61L, 53L, 69L, 0L, 7L, 0L, 5L, 0L, 1L, 7L, 1L, 0L, 2L, 0L,  #>     4L, 1L, 2L, 3L, 89L, 94L, 95L, 78L, 89L, 92L, 84L, 90L, 98L,  #>     99L, 91L, 88L, 91L), not.hsg = c(14L, 8L, 12L, 4L, 11L, 10L,  #>     3L, 6L, 13L, 13L, 10L, 66L, 57L, 74L, 63L, 63L, 66L, 19L,  #>     18L, 40L, 4L, 11L, 13L, 16L, 13L, 1L, 2L, 7L, 4L, 2L, 28L,  #>     23L, 7L, 9L, 12L, 11L, 49L, 45L, 44L, 54L, 7L, 4L, 16L, 12L,  #>     14L, 4L, 24L, 24L, 22L, 27L, 63L, 4L, 2L, 33L, 36L, 4L, 2L,  #>     9L, 7L, 3L, 13L, 4L, 8L, 6L, 8L, 0L, 13L, 0L, 0L, 0L, 0L,  #>     0L, 0L, 0L, 0L, 100L, 22L, 0L, 0L, 0L, 0L, 50L, 100L, 0L,  #>     0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  #>     31L, 13L, 66L, 16L, 54L, 44L, 24L, 51L, 5L, 17L, 28L, 1L,  #>     9L, 51L, 35L, 36L, 23L, 10L, 6L, 12L, 2L, 31L, 36L, 34L,  #>     22L, 81L, 62L, 32L, 67L, 46L, 29L, 0L, 21L, 27L, 46L, 47L,  #>     75L, 13L, 13L, 14L, 33L, 50L, 41L, 13L, 31L, 18L, 40L, 41L,  #>     5L, 31L, 22L, 22L, 33L, 3L, 6L, 2L, 0L, 15L, 0L, 10L, 0L,  #>     20L, 4L, 0L, 100L, 11L, 50L, 10L, 33L, 40L, 18L, 20L, 9L,  #>     17L, 8L, 4L, 6L, 11L, 4L, 12L, 21L, 5L, 5L, 4L), hsg = c(22L,  #>     22L, 24L, 26L, 37L, 30L, 16L, 18L, 31L, 25L, 25L, 15L, 23L,  #>     21L, 17L, 26L, 21L, 40L, 19L, 45L, 22L, 31L, 32L, 41L, 35L,  #>     4L, 13L, 22L, 20L, 20L, 31L, 24L, 23L, 28L, 26L, 29L, 22L,  #>     30L, 22L, 18L, 14L, 13L, 17L, 11L, 19L, 6L, 27L, 26L, 34L,  #>     22L, 19L, 11L, 8L, 37L, 27L, 10L, 17L, 23L, 15L, 16L, 27L,  #>     49L, 23L, 24L, 40L, 0L, 40L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  #>     0L, 0L, 44L, 0L, 0L, 0L, 0L, 25L, 0L, 0L, 0L, 0L, 0L, 0L,  #>     0L, 0L, 0L, 100L, 0L, 0L, 60L, 0L, 0L, 0L, 100L, 19L, 17L,  #>     18L, 22L, 24L, 20L, 19L, 31L, 41L, 20L, 29L, 73L, 29L, 34L,  #>     32L, 44L, 31L, 17L, 28L, 19L, 40L, 25L, 25L, 19L, 31L, 16L,  #>     21L, 26L, 20L, 25L, 32L, 0L, 36L, 39L, 20L, 25L, 9L, 32L,  #>     40L, 32L, 17L, 0L, 26L, 25L, 23L, 44L, 20L, 42L, 27L, 26L,  #>     25L, 24L, 24L, 19L, 31L, 20L, 0L, 18L, 0L, 55L, 0L, 0L, 13L,  #>     25L, 0L, 33L, 0L, 30L, 17L, 10L, 18L, 39L, 18L, 31L, 26L,  #>     13L, 13L, 36L, 14L, 22L, 37L, 16L, 23L, 21L), some.col = c(27L,  #>     38L, 40L, 38L, 26L, 33L, 24L, 27L, 32L, 28L, 35L, 11L, 16L,  #>     4L, 17L, 6L, 9L, 31L, 31L, 13L, 37L, 37L, 40L, 31L, 36L,  #>     25L, 36L, 41L, 45L, 44L, 28L, 37L, 30L, 34L, 35L, 35L, 19L,  #>     21L, 25L, 23L, 22L, 27L, 25L, 22L, 24L, 10L, 25L, 25L, 25L,  #>     27L, 12L, 23L, 19L, 20L, 23L, 16L, 33L, 41L, 36L, 39L, 40L,  #>     29L, 33L, 30L, 24L, 100L, 33L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  #>     0L, 0L, 33L, 0L, 0L, 0L, 0L, 25L, 0L, 100L, 0L, 0L, 0L, 0L,  #>     0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 29L, 29L, 9L,  #>     34L, 16L, 24L, 27L, 11L, 33L, 27L, 31L, 18L, 31L, 9L, 22L,  #>     17L, 28L, 35L, 31L, 32L, 41L, 21L, 20L, 26L, 29L, 2L, 14L,  #>     25L, 10L, 23L, 17L, 0L, 31L, 15L, 19L, 21L, 10L, 32L, 13L,  #>     22L, 20L, 0L, 22L, 40L, 29L, 25L, 13L, 13L, 61L, 28L, 26L,  #>     30L, 19L, 44L, 29L, 36L, 0L, 18L, 0L, 0L, 0L, 40L, 38L, 25L,  #>     0L, 22L, 0L, 10L, 17L, 10L, 18L, 28L, 22L, 28L, 30L, 25L,  #>     24L, 29L, 29L, 26L, 21L, 26L, 33L, 34L), col.grad = c(30L,  #>     24L, 18L, 18L, 22L, 19L, 34L, 33L, 19L, 24L, 24L, 6L, 3L,  #>     1L, 4L, 5L, 3L, 10L, 22L, 3L, 25L, 15L, 12L, 10L, 14L, 36L,  #>     32L, 20L, 22L, 22L, 8L, 10L, 29L, 22L, 23L, 17L, 10L, 4L,  #>     7L, 3L, 31L, 38L, 24L, 31L, 26L, 40L, 19L, 18L, 13L, 15L,  #>     5L, 31L, 46L, 9L, 11L, 47L, 39L, 23L, 34L, 32L, 11L, 15L,  #>     26L, 33L, 23L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 100L, 0L,  #>     0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 100L,  #>     0L, 0L, 0L, 0L, 0L, 40L, 0L, 0L, 0L, 0L, 17L, 32L, 5L, 23L,  #>     6L, 10L, 21L, 6L, 18L, 24L, 9L, 7L, 26L, 5L, 9L, 3L, 15L,  #>     27L, 27L, 28L, 14L, 20L, 17L, 17L, 16L, 0L, 3L, 13L, 3L,  #>     4L, 20L, 0L, 9L, 18L, 15L, 7L, 5L, 19L, 35L, 28L, 20L, 50L,  #>     8L, 17L, 14L, 13L, 28L, 5L, 7L, 12L, 24L, 22L, 20L, 18L,  #>     31L, 42L, 0L, 48L, 0L, 15L, 0L, 40L, 42L, 25L, 0L, 33L, 50L,  #>     50L, 33L, 30L, 45L, 10L, 39L, 19L, 30L, 41L, 36L, 17L, 31L,  #>     28L, 18L, 38L, 32L, 31L), grad.sch = c(6L, 8L, 6L, 14L, 4L,  #>     7L, 23L, 16L, 5L, 11L, 6L, 2L, 1L, 0L, 0L, 1L, 0L, 1L, 10L,  #>     0L, 12L, 6L, 4L, 2L, 3L, 35L, 17L, 9L, 9L, 11L, 5L, 6L, 10L,  #>     6L, 4L, 8L, 1L, 1L, 2L, 2L, 26L, 19L, 18L, 25L, 18L, 39L,  #>     6L, 6L, 6L, 9L, 1L, 30L, 25L, 1L, 4L, 23L, 8L, 5L, 8L, 11L,  #>     9L, 3L, 9L, 7L, 4L, 0L, 13L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  #>     0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,  #>     0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 4L, 9L, 1L, 4L, 1L,  #>     1L, 8L, 1L, 3L, 12L, 2L, 1L, 5L, 1L, 2L, 1L, 3L, 11L, 8L,  #>     9L, 3L, 2L, 2L, 3L, 2L, 0L, 0L, 4L, 0L, 2L, 2L, 0L, 3L, 1L,  #>     1L, 1L, 1L, 4L, 0L, 4L, 10L, 0L, 2L, 4L, 4L, 1L, 0L, 0L,  #>     0L, 3L, 2L, 2L, 5L, 15L, 4L, 0L, 0L, 0L, 0L, 20L, 0L, 0L,  #>     4L, 25L, 0L, 0L, 0L, 0L, 0L, 10L, 0L, 4L, 12L, 4L, 6L, 17L,  #>     21L, 6L, 22L, 12L, 4L, 15L, 6L, 9L), avg.ed = c(2.9300000667572,  #>     3.01999998092651, 2.82999992370605, 3.11999988555908, 2.71000003814697,  #>     2.84999990463257, 3.5699999332428, 3.33999991416931, 2.70000004768372,  #>     2.96000003814697, 2.91000008583069, 1.62999999523163, 1.69000005722046,  #>     1.33000004291534, 1.61000001430511, 1.55999994277954, 1.49000000953674,  #>     2.33999991416931, 2.86999988555908, 1.79999995231628, 3.19000005722046,  #>     2.72000002861023, 2.60999989509583, 2.40000009536743, 2.57999992370605,  #>     4, 3.49000000953674, 3.01999998092651, 3.11999988555908,  #>     3.20000004768372, 2.32999992370605, 2.50999999046326, 3.10999989509583,  #>     2.89000010490417, 2.80999994277954, 2.80999994277954, 1.92999994754791,  #>     1.87000000476837, 2.00999999046326, 1.80999994277954, 3.55999994277954,  #>     3.55999994277954, 3.10999989509583, 3.46000003814697, 3.13000011444092,  #>     4.03999996185303, 2.5699999332428, 2.5699999332428, 2.47000002861023,  #>     2.57999992370605, 1.62999999523163, 3.73000001907349, 3.8199999332428,  #>     2.07999992370605, 2.21000003814697, 3.75, 3.33999991416931,  #>     2.9300000667572, 3.20000004768372, 3.3199999332428, 2.75,  #>     2.65000009536743, 3.04999995231628, 3.11999988555908, 2.75,  #>     3, 2.59999990463257, NA, NA, NA, NA, NA, NA, 4, NA, 1, 2.10999989509583,  #>     NA, NA, NA, NA, 1.75, 1, 3, NA, NA, NA, NA, 4, NA, NA, 2,  #>     NA, NA, 2.79999995231628, NA, NA, NA, 2, 2.4300000667572,  #>     3.08999991416931, 1.58000004291534, 2.76999998092651, 1.75999999046326,  #>     2.03999996185303, 2.71000003814697, 1.73000001907349, 2.71000003814697,  #>     2.9300000667572, 2.26999998092651, 2.34999990463257, 2.89000010490417,  #>     1.72000002861023, 2.10999989509583, 1.88999998569489, 2.44000005722046,  #>     3.13000011444092, 3.03999996185303, 3.03999996185303, 2.76999998092651,  #>     2.36999988555908, 2.23000001907349, 2.35999989509583, 2.45000004768372,  #>     1.21000003814697, 1.60000002384186, 2.30999994277954, 1.5,  #>     1.9099999666214, 2.33999991416931, NA, 2.34999990463257,  #>     2.26999998092651, 2.05999994277954, 1.89999997615814, 1.47000002861023,  #>     2.70000004768372, 2.70000004768372, 2.75999999046326, 2.5699999332428,  #>     2.5, 2.02999997138977, 2.73000001907349, 2.36999988555908,  #>     2.35999989509583, 2.27999997138977, 1.82000005245209, 2.70000004768372,  #>     2.3199999332428, 2.57999992370605, 2.57999992370605, 2.40000009536743,  #>     3.24000000953674, 2.97000002861023, 3.17000007629395, NA,  #>     3, NA, 2.79999995231628, NA, 3, 3.28999996185303, 3.5, 1,  #>     2.77999997138977, 2.5, 3, 2.5, 2.59999990463257, 2.91000008583069,  #>     2.40000009536743, 3.27999997138977, 2.61999988555908, 3,  #>     3.55999994277954, 3.53999996185303, 2.70000004768372, 3.53999996185303,  #>     3.04999995231628, 2.47000002861023, 3.41000008583069, 3.10999989509583,  #>     3.20000004768372), full = c(82L, 79L, 72L, 75L, 100L, 89L,  #>     90L, 78L, 96L, 76L, 85L, 54L, 90L, 64L, 81L, 81L, 62L, 61L,  #>     76L, 63L, 79L, 97L, 79L, 74L, 54L, 95L, 75L, 73L, 84L, 65L,  #>     64L, 76L, 97L, 100L, 94L, 100L, 94L, 84L, 94L, 94L, 100L,  #>     83L, 93L, 100L, 94L, 100L, 80L, 96L, 92L, 100L, 83L, 96L,  #>     83L, 98L, 84L, 94L, 81L, 82L, 88L, 96L, 100L, 100L, 100L,  #>     100L, 100L, 93L, 100L, 100L, 92L, 97L, 94L, 100L, 97L, 87L,  #>     86L, 96L, 100L, 100L, 65L, 100L, 95L, 88L, 100L, 90L, 100L,  #>     96L, 94L, 87L, 96L, 81L, 85L, 100L, 94L, 96L, 97L, 100L,  #>     95L, 100L, 95L, 100L, 94L, 94L, 96L, 94L, 83L, 95L, 91L,  #>     100L, 97L, 95L, 100L, 97L, 93L, 100L, 97L, 100L, 98L, 98L,  #>     98L, 97L, 89L, 87L, 89L, 92L, 88L, 85L, 72L, 93L, 84L, 86L,  #>     72L, 74L, 82L, 87L, 74L, 83L, 88L, 73L, 52L, 83L, 80L, 80L,  #>     74L, 80L, 93L, 80L, 92L, 90L, 86L, 86L, 77L, 85L, 82L, 94L,  #>     100L, 71L, 70L, 90L, 93L, 81L, 93L, 85L, 81L, 88L, 88L, 77L,  #>     97L, 84L, 82L, 93L, 52L, 89L, 84L, 94L, 97L, 94L, 86L, 96L,  #>     81L, 84L, 82L, 88L, 73L), emer = c(23L, 21L, 31L, 25L, 0L,  #>     7L, 10L, 17L, 4L, 24L, 15L, 35L, 0L, 29L, 15L, 19L, 38L,  #>     36L, 16L, 22L, 18L, 8L, 24L, 23L, 49L, 0L, 25L, 27L, 13L,  #>     32L, 43L, 24L, 6L, 3L, 6L, 0L, 11L, 16L, 2L, 6L, 0L, 21L,  #>     7L, 0L, 6L, 0L, 22L, 4L, 8L, 4L, 12L, 9L, 17L, 0L, 16L, 0L,  #>     19L, 0L, 0L, 4L, 0L, 0L, 0L, 0L, 0L, 7L, 4L, 0L, 18L, 3L,  #>     6L, 0L, 3L, 13L, 14L, 4L, 0L, 3L, 43L, 0L, 9L, 15L, 0L, 10L,  #>     0L, 0L, 9L, 13L, 0L, 19L, 15L, 0L, 3L, 7L, 6L, 7L, 5L, 3L,  #>     11L, 0L, 6L, 6L, 4L, 6L, 14L, 5L, 6L, 0L, 3L, 5L, 0L, 0L,  #>     3L, 0L, 0L, 0L, 2L, 0L, 2L, 3L, 10L, 11L, 10L, 8L, 6L, 6L,  #>     21L, 2L, 10L, 12L, 22L, 26L, 12L, 7L, 15L, 12L, 5L, 27L,  #>     30L, 17L, 8L, 9L, 15L, 13L, 5L, 17L, 8L, 5L, 5L, 13L, 20L,  #>     8L, 18L, 4L, 0L, 21L, 19L, 6L, 4L, 14L, 5L, 12L, 16L, 13L,  #>     12L, 16L, 3L, 13L, 18L, 11L, 48L, 12L, 13L, 6L, 3L, 6L, 11L,  #>     0L, 19L, 16L, 15L, 6L, 23L), enroll = c(1689L, 288L, 294L,  #>     143L, 307L, 311L, 362L, 263L, 583L, 886L, 955L, 418L, 574L,  #>     286L, 158L, 372L, 308L, 358L, 921L, 375L, 962L, 954L, 370L,  #>     596L, 485L, 254L, 465L, 481L, 425L, 312L, 360L, 323L, 442L,  #>     508L, 166L, 525L, 388L, 266L, 671L, 343L, 466L, 516L, 489L,  #>     300L, 728L, 512L, 972L, 619L, 562L, 358L, 626L, 396L, 571L,  #>     715L, 345L, 850L, 258L, 170L, 210L, 467L, 117L, 196L, 205L,  #>     233L, 324L, 370L, 309L, 414L, 303L, 407L, 504L, 371L, 374L,  #>     631L, 432L, 299L, 500L, 499L, 748L, 356L, 302L, 594L, 527L,  #>     446L, 436L, 381L, 464L, 462L, 320L, 437L, 295L, 512L, 343L,  #>     404L, 504L, 411L, 637L, 555L, 491L, 1585L, 1855L, 385L, 1015L,  #>     483L, 576L, 1405L, 549L, 352L, 564L, 540L, 290L, 523L, 379L,  #>     391L, 403L, 613L, 596L, 520L, 1573L, 371L, 1908L, 2181L,  #>     2106L, 532L, 381L, 624L, 704L, 602L, 686L, 607L, 209L, 643L,  #>     331L, 641L, 479L, 535L, 561L, 695L, 426L, 657L, 300L, 612L,  #>     466L, 352L, 559L, 363L, 558L, 257L, 1243L, 1260L, 1306L,  #>     1344L, 119L, 818L, 118L, 145L, 486L, 371L, 377L, 265L, 930L,  #>     336L, 448L, 1023L, 387L, 940L, 525L, 427L, 390L, 358L, 274L,  #>     2147L, 479L, 441L, 476L, 511L, 385L, 443L, 696L, 332L, 738L,  #>     425L, 302L), api.stu = c(1358L, 223L, 220L, 110L, 239L, 265L,  #>     309L, 224L, 469L, 705L, 773L, 358L, 439L, 260L, 127L, 291L,  #>     241L, 294L, 801L, 297L, 845L, 803L, 310L, 504L, 423L, 203L,  #>     404L, 427L, 368L, 256L, 314L, 296L, 350L, 434L, 136L, 453L,  #>     359L, 235L, 563L, 304L, 431L, 448L, 439L, 256L, 618L, 410L,  #>     792L, 512L, 444L, 314L, 540L, 307L, 454L, 619L, 263L, 726L,  #>     222L, 134L, 184L, 419L, 106L, 177L, 175L, 187L, 273L, 315L,  #>     269L, 357L, 215L, 353L, 412L, 310L, 338L, 519L, 363L, 277L,  #>     431L, 420L, 592L, 313L, 265L, 480L, 432L, 374L, 379L, 322L,  #>     407L, 379L, 231L, 360L, 253L, 457L, 310L, 349L, 428L, 357L,  #>     523L, 497L, 331L, 1342L, 1565L, 316L, 784L, 407L, 417L, 1167L,  #>     447L, 262L, 491L, 476L, 229L, 462L, 314L, 292L, 289L, 538L,  #>     472L, 385L, 1350L, 287L, 1516L, 1743L, 1701L, 456L, 321L,  #>     547L, 600L, 544L, 651L, 540L, 189L, 582L, 285L, 584L, 409L,  #>     449L, 491L, 640L, 409L, 587L, 246L, 551L, 417L, 315L, 469L,  #>     328L, 490L, 217L, 1137L, 1092L, 1151L, 1204L, 119L, 795L,  #>     118L, 139L, 420L, 345L, 378L, 223L, 809L, 313L, 442L, 872L,  #>     384L, 794L, 455L, 401L, 344L, 287L, 199L, 1884L, 442L, 369L,  #>     412L, 456L, 327L, 374L, 595L, 273L, 665L, 370L, 264L), fpc = c(757,  #>     757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #>     757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #>     757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #>     757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #>     757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #>     757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #>     757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #>     757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #>     757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #>     757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #>     757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #>     757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #>     757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #>     757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #>     757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #>     757, 757), pw = c(33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373,  #>     33.846996307373, 33.846996307373, 33.846996307373, 33.846996307373 #>     ), api00_miss = c(NA, NA, 612, NA, NA, NA, NA, 585, NA, NA,  #>     NA, NA, NA, 482, NA, NA, NA, 493, NA, NA, NA, 598, NA, NA,  #>     628, NA, 777, NA, NA, NA, NA, NA, NA, NA, 564, NA, 529, 491,  #>     NA, NA, 814, 806, 715, NA, NA, NA, NA, NA, NA, NA, 476, 757,  #>     825, NA, 552, NA, NA, 724, 687, NA, NA, NA, NA, NA, NA, 622,  #>     754, NA, NA, 795, 505, 638, 733, NA, 511, NA, 657, NA, NA,  #>     664, NA, 603, 698, NA, NA, NA, 711, 538, 705, 595, NA, 762,  #>     521, NA, NA, NA, 722, NA, NA, NA, NA, 502, 614, 585, NA,  #>     NA, NA, NA, NA, 629, NA, NA, NA, 696, NA, NA, 745, 789, NA,  #>     NA, NA, NA, NA, NA, NA, NA, NA, NA, 566, NA, NA, NA, NA,  #>     NA, NA, NA, NA, 505, NA, NA, 487, 627, NA, NA, NA, NA, 542,  #>     NA, NA, 528, NA, NA, NA, 760, NA, NA, 717, 701, 748, NA,  #>     NA, NA, NA, 711, NA, 759, 697, 742, 691, 700, NA, 703, 676,  #>     NA, 842, 824, NA, NA, NA, NA, NA, NA, 781)), fpc = list(popsize = c(757,  #> 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #> 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #> 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #> 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #> 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #> 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #> 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #> 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #> 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #> 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #> 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #> 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #> 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757,  #> 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757, 757 #> ), sampsize = c(15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L,  #> 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L,  #> 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L,  #> 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L,  #> 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L,  #> 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L,  #> 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L,  #> 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L,  #> 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L,  #> 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L,  #> 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L,  #> 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L,  #> 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L,  #> 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L,  #> 15L, 15L, 15L, 15L, 15L), pps = FALSE), pps = FALSE), formula = api00_miss ~  #>     ell, response_predictors = NULL, auxiliary_means = c(ell = 27.6120218579235),  #>     standardize = TRUE, trim_cap = Inf, control = list(), on_failure = \"return\",  #>     variance_method = \"delta\", variance_jacobian = \"auto\", solver_jacobian = \"auto\",  #>     variance_pseudoinverse = FALSE, bootstrap_reps = 500, suppress_warnings = FALSE,  #>     family = list(name = \"logit\", linkinv = function (eta)  #>     stats::plogis(eta), mu.eta = function (eta)  #>     { #>         p <- stats::plogis(eta) #>         p * (1 - p) #>     }, d2mu.deta2 = function (eta)  #>     { #>         p <- stats::plogis(eta) #>         p * (1 - p) * (1 - 2 * p) #>     }, score_eta = function (eta, delta)  #>     { #>         if (missing(delta))  #>             delta <- 1 #>         delta <- validate_delta(delta) #>         p <- stats::plogis(eta) #>         delta - p #>     })) #>  #> Response-model coefficients: #>                 Estimate  Std. Error   z value     Pr(>|z|) #> (Intercept) -19.67790829 4.350556756 -4.523078 0.0004776363 #> api00_miss    0.03520924 0.008837221  3.984198 0.0013574811"},{"path":"https://ncn-foreigners.github.io/NMAR/articles/tutorial_empirical_likelihood.html","id":"practical-guidance","dir":"Articles","previous_headings":"","what":"Practical guidance","title":"Empirical Likelihood","text":"Variance method: delta method fast asymptotic; bootstrap often preferred moderate samples, trimming, near-boundary cases. Trimming: Use finite trim_cap improve robustness large weights occur; prefer bootstrap variance trimming. Standardization: standardize = TRUE typically improves numerical stability comparability across predictors auxiliary means. Diagnostics: Inspect fit$diagnostics (Jacobian condition number, max equation residuals, trimming fraction) assess numerical health identification strength. Response-predictors: Variables covariates_missingness need appear RHS outcome formula; enter response model. Auxiliary means must supplied variables outcome RHS. Inconsistent auxiliaries: provided auxiliary means grossly inconsistent sample, EL weights may go negative solver may fail. Consider revisiting constraints, relaxing , using trim_cap bootstrap variance. Troubleshooting: Negative extreme weights: set finite trim_cap; prefer variance_method = \"bootstrap\" SE. Ill-conditioned Jacobian (large fit$diagnostics$jacobian_condition_number): try variance_ridge = TRUE variance_pseudoinverse = TRUE el_engine(...). Convergence issues: check fit$diagnostics$max_equation_residual, rescale predictors (standardize = TRUE), reduce number constraints.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/tutorial_empirical_likelihood.html","id":"references-and-further-reading","dir":"Articles","previous_headings":"","what":"References and further reading","title":"Empirical Likelihood","text":"Qin, J., Leung, D., Shao, J. (2002). Estimation survey data nonignorable nonresponse informative sampling. Journal American Statistical Association, 97(457), 193â€“200. doi:10.1198/016214502753479338 practical scripts experiments informed implementation, see packageâ€™s development materials validation script inst/validation/mc-el.R.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/articles/tutorial_empirical_likelihood.html","id":"families-and-numerical-stability","dir":"Articles","previous_headings":"","what":"Families and numerical stability","title":"Empirical Likelihood","text":"Family: el_engine(family = \"logit\") (default) family = \"probit\". Probit stability: response-model score uses stable log-ratio Ï•/Î¦\\phi/\\Phi hood. Theory mapping: see companion article â€œEmpirical Likelihood Theory NMARâ€ equations, Jacobian blocks, variance details.","code":"sessionInfo() #> R version 4.5.1 (2025-06-13) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] grid      stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #> [1] survey_4.4-8   survival_3.8-3 Matrix_1.7-3   NMAR_0.0.0.1   #>  #> loaded via a namespace (and not attached): #>  [1] jsonlite_2.0.0      dplyr_1.1.4         compiler_4.5.1      #>  [4] Rcpp_1.1.0          tidyselect_1.2.1    nleqslv_3.3.5       #>  [7] tidyr_1.3.1         jquerylib_0.1.4     splines_4.5.1       #> [10] systemfonts_1.3.1   textshaping_1.0.3   yaml_2.3.10         #> [13] fastmap_1.2.0       lattice_0.22-7      R6_2.6.1            #> [16] generics_0.1.4      knitr_1.50          htmlwidgets_1.6.4   #> [19] backports_1.5.0     tibble_3.3.0        desc_1.4.3          #> [22] DBI_1.2.3           bslib_0.9.0         pillar_1.11.1       #> [25] rlang_1.1.6         cachem_1.1.0        broom_1.0.10        #> [28] xfun_0.53           fs_1.6.6            sass_0.4.10         #> [31] cli_3.6.5           pkgdown_2.1.3       magrittr_2.0.4      #> [34] digest_0.6.37       lifecycle_1.0.4     vctrs_0.6.5         #> [37] evaluate_1.0.5      glue_1.8.0          numDeriv_2016.8-1.1 #> [40] mitools_2.4         ragg_1.5.0          rmarkdown_2.30      #> [43] purrr_1.1.0         tools_4.5.1         pkgconfig_2.0.3     #> [46] htmltools_0.5.8.1"},{"path":"https://ncn-foreigners.github.io/NMAR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Maciej BerÄ™sewicz. Author, maintainer. Igor KoÅ‚odziej. Author. Mateusz Iwaniuk. Author.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"BerÄ™sewicz M, KoÅ‚odziej , Iwaniuk M (2025). NMAR: Missing Random. R package version 0.0.0.1, https://github.com/ncn-foreigners/NMAR.","code":"@Manual{,   title = {NMAR: Not Missing at Random},   author = {Maciej BerÄ™sewicz and Igor KoÅ‚odziej and Mateusz Iwaniuk},   year = {2025},   note = {R package version 0.0.0.1},   url = {https://github.com/ncn-foreigners/NMAR}, }"},{"path":"https://ncn-foreigners.github.io/NMAR/index.html","id":"nmar","dir":"","previous_headings":"","what":"Not Missing at Random","title":"Not Missing at Random","text":"goal NMAR provide set functions estimate population mean data subject Missing Random (NMAR) mechanisms using advanced statistical methods","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Not Missing at Random","text":"NNMAR library provides functions estimate mean Missing Random (NMAR) data. estimation functions built upon following engine functions, implementing distinct method: exptilt_engine: Exponential Tilting Estimator (Riddles et al, 2016, DOI:10.xxxx/xxxx) exptilt_nonparam_engine: Nonparametric Exponential Tilting Estimator (Riddles et al, 2016, Appendix 2, DOI:10.xxxx/xxxx) el_engine: Empirical Likelihood Estimator (Kim Yu, 2011, DOI:10.xxxx/xxxx) main user-facing function nmar(), acts unified wrapper around engine functions.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Not Missing at Random","text":"can install development version NMAR GitHub : ","code":"# install.packages(\"pak\") pak::pak(\"ncn-foreigners/NMAR\") remotes::install_github(\"ncn-foreigners/NMAR@main\", force = T, build = T, build_manual = T, build_vignettes = T)"},{"path":"https://ncn-foreigners.github.io/NMAR/index.html","id":"project-branches","dir":"","previous_headings":"Installation","what":"Project branches:","title":"Not Missing at Random","text":"main - stable production branch. version install general use package-pre_prod - pre-production development branch. stable, installable version reflecting latest features. (1:1 clone package-dev) package-dev - internal development branch. branch uses non-R package structure internal development purposes. download install branch. contribution guidelines, please see CONTRIBUTING.md file [project webpage (TODO: add link webpage)]","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/NMAR/index.html","id":"general-naming","dir":"","previous_headings":"Usage","what":"General naming","title":"Not Missing at Random","text":"outcome_var (f.e Y): outcome variable (missing values). covariates_for_outcome(f.e x1,x2): Predictors outcome_var value (used response model). covariates_for_missingness(f.e x3): Predictor outcome_var missingness (used missingness model). formula = outcome_var ~ covariates_for_outcome","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/index.html","id":"example","dir":"","previous_headings":"Usage","what":"Example","title":"Not Missing at Random","text":", salary survey, richer people less likely answer, Y salary, x1 x2 experience education, x3 might gender (assume gender affects likelihood responding salary value ).","code":"generate_test_data <- function(n_rows = 400, n_cols = 2, case = 2, x_var = 0.5, eps_var = 0.5, a = 0.8, b = -0.2) {   X <- as.data.frame(replicate(n_cols, rnorm(n_rows, 0, x_var)^1))   colnames(X) <- paste0(\"x\", 1:n_cols)   coefs <- runif(n_cols, 0.95, 1.05)   eps <- rnorm(n_rows, 0, eps_var)   if (case == 1) {   X$Y <- as.vector(-1 + as.matrix(X) %*% coefs + eps)   }   X <- X[order(X$Y), ]   Y_original = X$Y   pi_obs <- 1 / (1 + exp(-(a + b * X$Y)))   mask <- runif(nrow(X)) > pi_obs   mask[1] <- FALSE   X$Y[mask] <- NA   return(list(X = X, Y_original = Y_original)) }  library(NMAR, quietly = T) res_test_data <- generate_test_data(n_rows = 500, n_cols = 3, case = 1) data <- res_test_data$X  exptilt_config <- exptilt_engine(   y_dens = 'normal',   family = 'probit', # or logit   variance_method='delta', #or delta )  formula = Y ~ x1 + x2 res <- nmar(formula = formula, data = data, engine = exptilt_config, response_predictors = c('x3'))  print(res) #> NMAR Result #> ------------ #> Y: -1.022341 #> Std. Error: 0.088009 #> Converged: TRUE  #> Variance method: delta  #> Estimator: exponential_tilting  #> Sample size: 500 (respondents: 362)"},{"path":"https://ncn-foreigners.github.io/NMAR/index.html","id":"getting-help","dir":"","previous_headings":"","what":"Getting help","title":"Not Missing at Random","text":"encounter clear bug, please file issue minimal reproducible example GitHub","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/index.html","id":"authors-and-acknowledgments","dir":"","previous_headings":"","what":"Authors and acknowledgments","title":"Not Missing at Random","text":"Research grant: OPUS 20 #2020/39/B/HS4/00941 Maciej BerÄ™sewicz Igor KoÅ‚odziej Mateusz Iwaniuk","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/apply_nmar_scaling.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply scaling to a matrix using a recipe â€” apply_nmar_scaling","title":"Apply scaling to a matrix using a recipe â€” apply_nmar_scaling","text":"Apply scaling matrix using recipe","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/apply_nmar_scaling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply scaling to a matrix using a recipe â€” apply_nmar_scaling","text":"","code":"apply_nmar_scaling(matrix_to_scale, recipe)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/apply_nmar_scaling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply scaling to a matrix using a recipe â€” apply_nmar_scaling","text":"matrix_to_scale numeric matrix column names present `recipe`. recipe object class `nmar_scaling_recipe`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/apply_nmar_scaling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply scaling to a matrix using a recipe â€” apply_nmar_scaling","text":"matrix named column centered scaled using recipe.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/autoplot.html","id":null,"dir":"Reference","previous_headings":"","what":"ggplot2 autoplot generic â€” autoplot","title":"ggplot2 autoplot generic â€” autoplot","text":"Generic autoplot; methods provide plotting NMAR results.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/autoplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggplot2 autoplot generic â€” autoplot","text":"","code":"autoplot(object, ...)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/autoplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ggplot2 autoplot generic â€” autoplot","text":"object object. ... Passed methods.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/autoplot.nmar_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Default ggplot2 autoplot for NMAR results â€” autoplot.nmar_result","title":"Default ggplot2 autoplot for NMAR results â€” autoplot.nmar_result","text":"Quick ggplot2 visualizations result objects.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/autoplot.nmar_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default ggplot2 autoplot for NMAR results â€” autoplot.nmar_result","text":"","code":"# S3 method for class 'nmar_result' autoplot(object, type = c(\"weights\", \"fitted\", \"constraints\"), ...)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/autoplot.nmar_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Default ggplot2 autoplot for NMAR results â€” autoplot.nmar_result","text":"object object class `nmar_result` subclass. type One \"weights\", \"fitted\", \"constraints\". ... Ignored.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/autoplot.nmar_result.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Default ggplot2 autoplot for NMAR results â€” autoplot.nmar_result","text":"`ggplot` object.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/bootstrap_variance.data.frame.html","id":null,"dir":"Reference","previous_headings":"","what":"Bootstrap for i.i.d. data.frames â€” bootstrap_variance.data.frame","title":"Bootstrap for i.i.d. data.frames â€” bootstrap_variance.data.frame","text":"Bootstrap ..d. data.frames","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/bootstrap_variance.data.frame.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bootstrap for i.i.d. data.frames â€” bootstrap_variance.data.frame","text":"","code":"# S3 method for class 'data.frame' bootstrap_variance(   data,   estimator_func,   point_estimate,   bootstrap_reps = 500,   ... )"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/bootstrap_variance.data.frame.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bootstrap for i.i.d. data.frames â€” bootstrap_variance.data.frame","text":"data `data.frame` `survey.design`. estimator_func function returns S3 result object; primary estimate extracted via `$estimate` convergence via `$converged`. point_estimate numeric; point estimate used survey variance formulas. bootstrap_reps integer; number resamples. ... passed `estimator_func`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/bootstrap_variance.data.frame.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bootstrap for i.i.d. data.frames â€” bootstrap_variance.data.frame","text":"list `se`, `variance`, vector `replicates`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/bootstrap_variance.html","id":null,"dir":"Reference","previous_headings":"","what":"Shared bootstrap variance helpers â€” bootstrap_variance","title":"Shared bootstrap variance helpers â€” bootstrap_variance","text":"S3 generic + methods estimate variance estimator   via resampling (IID) replicate weights (survey). Designed reused   across NMAR engines.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/bootstrap_variance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Shared bootstrap variance helpers â€” bootstrap_variance","text":"","code":"bootstrap_variance(data, estimator_func, point_estimate, ...)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/bootstrap_variance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Shared bootstrap variance helpers â€” bootstrap_variance","text":"data `data.frame` `survey.design`. estimator_func function returns S3 result object; primary estimate extracted via `$estimate` convergence via `$converged`. point_estimate numeric; point estimate used survey variance formulas. ... passed `estimator_func`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/bootstrap_variance.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Shared bootstrap variance helpers â€” bootstrap_variance","text":"- `data.frame` inputs, performs ..d. bootstrap resampling rows     rerunning `estimator_func`.   - `survey.design` inputs, converts bootstrap replicateâ€‘weight     design (`svrep::as_bootstrap_design`) uses `survey::withReplicates`     compute replicate estimates; variance computed `survey::svrVar`.   `estimator_func` typically engine method (e.g., `el()`), called   arguments used point estimate, except `data`   argument replaced resampled data replicate design.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/bootstrap_variance.survey.design.html","id":null,"dir":"Reference","previous_headings":"","what":"Bootstrap for survey designs via replicate weights â€” bootstrap_variance.survey.design","title":"Bootstrap for survey designs via replicate weights â€” bootstrap_variance.survey.design","text":"Bootstrap survey designs via replicate weights","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/bootstrap_variance.survey.design.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bootstrap for survey designs via replicate weights â€” bootstrap_variance.survey.design","text":"","code":"# S3 method for class 'survey.design' bootstrap_variance(   data,   estimator_func,   point_estimate,   bootstrap_reps = 500,   ... )"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/bootstrap_variance.survey.design.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bootstrap for survey designs via replicate weights â€” bootstrap_variance.survey.design","text":"data `data.frame` `survey.design`. estimator_func function returns S3 result object; primary estimate extracted via `$estimate` convergence via `$converged`. point_estimate numeric; point estimate used survey variance formulas. bootstrap_reps integer; number bootstrap replicates. ... passed `estimator_func`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/bootstrap_variance.survey.design.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bootstrap for survey designs via replicate weights â€” bootstrap_variance.survey.design","text":"list `se`, `variance`, vector `replicates`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/bootstrap_variance.survey.design.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bootstrap for survey designs via replicate weights â€” bootstrap_variance.survey.design","text":"path constructs replicate-weight design using   [svrep::as_bootstrap_design()] rebuilds original sampling design   replicate weight vector. supplied design must created   directly [survey::svydesign()].","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/build_el_jacobian.html","id":null,"dir":"Reference","previous_headings":"","what":"Analytical Jacobian for empirical likelihood â€” build_el_jacobian","title":"Analytical Jacobian for empirical likelihood â€” build_el_jacobian","text":"Analytical Jacobian empirical likelihood","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/build_el_jacobian.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Analytical Jacobian for empirical likelihood â€” build_el_jacobian","text":"","code":"build_el_jacobian(   family,   response_model_matrix,   auxiliary_matrix,   respondent_weights,   N_pop,   n_resp_weighted,   mu_x_scaled )"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/build_el_jacobian.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Analytical Jacobian for empirical likelihood â€” build_el_jacobian","text":"Builds block Jacobian \\(=\\partial F/\\partial \\theta\\)   EL estimating system (\\(\\beta\\), \\(W\\), auxiliary multipliers).   responseâ€‘model score \\(\\partial\\log p(\\eta)/\\partial\\eta =   \\mu_\\eta(\\eta)/p(\\eta)\\), generalizes logit probit   families. Aligned Qin, Leung Shao (2002).","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/choose_jacobian.html","id":null,"dir":"Reference","previous_headings":"","what":"Select between analytic and numeric Jacobians at a solution. â€” choose_jacobian","title":"Select between analytic and numeric Jacobians at a solution. â€” choose_jacobian","text":"Evaluates supplied analytic numeric Jacobian functions target parameter vector, reports preferred matrix, summarises diagnostic metrics condition number relative difference.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/choose_jacobian.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select between analytic and numeric Jacobians at a solution. â€” choose_jacobian","text":"","code":"choose_jacobian(analytic_fun, numeric_fun, at)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/choose_jacobian.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select between analytic and numeric Jacobians at a solution. â€” choose_jacobian","text":"analytic_fun Function returning analytic Jacobian; may `NULL`. numeric_fun Function returning numerical Jacobian. Numeric vector Jacobians evaluated.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/choose_jacobian.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select between analytic and numeric Jacobians at a solution. â€” choose_jacobian","text":"list entries `` (chosen matrix), `A_analytic`, `A_numeric`,   `source`, `kappa`, `rel_diff`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/coef.nmar_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Default coefficients for NMAR results â€” coef.nmar_result","title":"Default coefficients for NMAR results â€” coef.nmar_result","text":"Returns response-model coefficients available.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/coef.nmar_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default coefficients for NMAR results â€” coef.nmar_result","text":"","code":"# S3 method for class 'nmar_result' coef(object, ...)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/coef.nmar_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Default coefficients for NMAR results â€” coef.nmar_result","text":"object `nmar_result` object. ... Ignored.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/coef.nmar_result.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Default coefficients for NMAR results â€” coef.nmar_result","text":"named numeric vector `NULL`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/confint.nmar_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Wald confidence interval for base NMAR results â€” confint.nmar_result","title":"Wald confidence interval for base NMAR results â€” confint.nmar_result","text":"Wald confidence interval base NMAR results","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/confint.nmar_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wald confidence interval for base NMAR results â€” confint.nmar_result","text":"","code":"# S3 method for class 'nmar_result' confint(object, parm, level = 0.95, ...)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/confint.nmar_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wald confidence interval for base NMAR results â€” confint.nmar_result","text":"object object class `nmar_result`. parm Ignored. level Confidence level. ... Ignored.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/constraint_summaries.html","id":null,"dir":"Reference","previous_headings":"","what":"Constraint summaries for EL diagnostics â€” constraint_summaries","title":"Constraint summaries for EL diagnostics â€” constraint_summaries","text":"Constraint summaries EL diagnostics","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/constraint_summaries.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Constraint summaries for EL diagnostics â€” constraint_summaries","text":"","code":"constraint_summaries(w_i_hat, W_hat, p_untrim, X_centered)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/convergenceError.html","id":null,"dir":"Reference","previous_headings":"","what":"Error/condition helpers â€” convergenceError","title":"Error/condition helpers â€” convergenceError","text":"Developer note: - Add lightweight condition constructors common error types keep   signaling consistent across engines shared utilities. - Keep unexported; meant internal flow control clear   diagnostics (e.g., `convergenceError`). - Prefer simple S3 condition classes like `c(\"<type>\", \"error\", \"condition\")`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/convergenceError.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Error/condition helpers â€” convergenceError","text":"","code":"convergenceError(message, call = NULL)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/create_nmar_scaling_recipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Build a scaling recipe from one or more design matrices â€” create_nmar_scaling_recipe","title":"Build a scaling recipe from one or more design matrices â€” create_nmar_scaling_recipe","text":"Build scaling recipe one design matrices","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/create_nmar_scaling_recipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build a scaling recipe from one or more design matrices â€” create_nmar_scaling_recipe","text":"","code":"create_nmar_scaling_recipe(   ...,   intercept_col = \"(Intercept)\",   weights = NULL,   weight_mask = NULL,   tol_constant = 1e-08,   warn_on_constant = TRUE )"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/create_nmar_scaling_recipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build a scaling recipe from one or more design matrices â€” create_nmar_scaling_recipe","text":"... one matrices named columns. intercept_col Intercept column name remain unscaled. weights Optional numeric vector weights used compute weighted means/standard deviations. weight_mask Optional logical/ numeric mask applied `weights` computing moments (useful respondents-scaling). tol_constant Numeric tolerance columns treated constant left unscaled. warn_on_constant Logical; emit warning column treated constant.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el.data.frame.html","id":null,"dir":"Reference","previous_headings":"","what":"Empirical likelihood for data frames (NMAR) â€” el.data.frame","title":"Empirical likelihood for data frames (NMAR) â€” el.data.frame","text":"Method `el()` `data` `data.frame` NMAR missingness.   Returns `c('nmar_result_el','nmar_result')` estimate, standard error, weights,   coefficients, diagnostics metadata.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el.data.frame.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Empirical likelihood for data frames (NMAR) â€” el.data.frame","text":"","code":"# S3 method for class 'data.frame' el(   data,   formula,   response_predictors = NULL,   auxiliary_means = NULL,   standardize = TRUE,   trim_cap = Inf,   control = list(),   on_failure = c(\"return\", \"error\"),   variance_method = c(\"delta\", \"bootstrap\"),   variance_jacobian = c(\"auto\", \"analytic\", \"numeric\"),   solver_jacobian = c(\"auto\", \"analytic\", \"none\"),   variance_pseudoinverse = FALSE,   variance_ridge = FALSE,   bootstrap_reps = 500,   suppress_warnings = FALSE,   ... )"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el.data.frame.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Empirical likelihood for data frames (NMAR) â€” el.data.frame","text":"data `data.frame` outcome column contains `NA` nonrespondents. formula list formulas: `list(outcome = ~ Y_miss, covariates_outcome = ~ X, covariates_missingness = ~ NULL)`. response_predictors Optional character vector naming predictors response model. may include variables present RHS outcome formula; variables enter response model (auxiliary moment constraint). `NULL`, defaults using outcome response model. auxiliary_means Named numeric vector population means auxiliary variables (names must match RHS outcome formula). standardize Logical; whether standardize predictors prior estimation. trim_cap Numeric; cap EL weights (`Inf` = trimming). control List; optional solver control parameters. on_failure Character; one `\"return\"` `\"error\"` solver failure. variance_method Character; one `\"delta\"` `\"bootstrap\"`. variance_jacobian Character; one `\"auto\"`, `\"analytic\"`, `\"numeric\"`. solver_jacobian Character; one `\"auto\"`, `\"analytic\"`, `\"none\"`. variance_pseudoinverse Logical; allow pseudo-inverse variance needed. variance_ridge Logical numeric; TRUE, apply adaptive ridge Jacobian inversion; numeric, treated ridge epsilon. bootstrap_reps Integer; number bootstrap reps `variance_method = \"bootstrap\"`. suppress_warnings Logical; suppress variance-related warnings. ... Additional arguments passed solver.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el.data.frame.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Empirical likelihood for data frames (NMAR) â€” el.data.frame","text":"Implements empirical likelihood estimator Qin, Leung Shao (2002) IID data. responseâ€‘model score derivative logâ€‘likelihood respect linear predictor, generalizes correctly across families (logit/probit). Auxiliary moment constraints optional.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el.data.frame.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Empirical likelihood for data frames (NMAR) â€” el.data.frame","text":"Qin, J., Leung, D., Shao, J. (2002). Estimation survey data nonignorable nonresponse informative sampling. Journal American Statistical Association, 97(457), 193â€“200.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el.html","id":null,"dir":"Reference","previous_headings":"","what":"Empirical likelihood estimator â€” el","title":"Empirical likelihood estimator â€” el","text":"Generic empirical likelihood (EL) estimator NMAR.   Methods provided `data.frame` `survey.design`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Empirical likelihood estimator â€” el","text":"","code":"el(data, ...)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Empirical likelihood estimator â€” el","text":"data `data.frame` `survey.design`. ... Passed class-specific methods.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el.survey.design.html","id":null,"dir":"Reference","previous_headings":"","what":"Empirical likelihood for survey designs (NMAR) â€” el.survey.design","title":"Empirical likelihood for survey designs (NMAR) â€” el.survey.design","text":"Method `el()` `data` `survey.design`. Uses designâ€‘based   covariance variance estimation `variance_method = 'delta'`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el.survey.design.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Empirical likelihood for survey designs (NMAR) â€” el.survey.design","text":"","code":"# S3 method for class 'survey.design' el(   data,   formula,   response_predictors = NULL,   auxiliary_means = NULL,   standardize = TRUE,   trim_cap = Inf,   control = list(),   on_failure = c(\"return\", \"error\"),   variance_method = c(\"delta\", \"bootstrap\"),   variance_jacobian = c(\"auto\", \"analytic\", \"numeric\"),   solver_jacobian = c(\"auto\", \"analytic\", \"none\"),   variance_pseudoinverse = FALSE,   variance_ridge = FALSE,   bootstrap_reps = 500,   suppress_warnings = FALSE,   ... )"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el.survey.design.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Empirical likelihood for survey designs (NMAR) â€” el.survey.design","text":"data `survey.design` created [survey::svydesign()]. formula Two-sided formula: NA-valued outcome LHS; auxiliaries RHS. response_predictors Optional character vector response model RHS. may include variables RHS outcome formula; variables enter response model (auxiliary constraint). auxiliary_means Named numeric vector population means auxiliaries. standardize Logical; standardize predictors. trim_cap Numeric; cap EL weights (Inf = trimming). control List; solver control. on_failure Character; \"return\" \"error\" solver failure. variance_method Character; \"delta\" \"bootstrap\". variance_jacobian Character; \"auto\", \"analytic\", \"numeric\". solver_jacobian Character; \"auto\", \"analytic\", \"none\". variance_pseudoinverse Logical; allow pseudo-inverse variance. variance_ridge Logical numeric; TRUE, apply adaptive ridge Jacobian inversion; numeric, treated ridge epsilon. bootstrap_reps Integer; reps `variance_method = \"bootstrap\"`. suppress_warnings Logical; suppress variance method warnings. ... Passed solver.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el.survey.design.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Empirical likelihood for survey designs (NMAR) â€” el.survey.design","text":"`c('nmar_result_el','nmar_result')`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el.survey.design.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Empirical likelihood for survey designs (NMAR) â€” el.survey.design","text":"Implements empirical likelihood estimator Qin, Leung Shao (2002) design weights designâ€‘based covariance total scores delta variance. Bootstrap variance via replicate weights also supported.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el.survey.design.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Empirical likelihood for survey designs (NMAR) â€” el.survey.design","text":"Qin, J., Leung, D., Shao, J. (2002). Estimation survey data nonignorable nonresponse informative sampling. Journal American Statistical Association, 97(457), 193â€“200.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el_build_equation_system.html","id":null,"dir":"Reference","previous_headings":"","what":"Empirical likelihood estimating equations â€” el_build_equation_system","title":"Empirical likelihood estimating equations â€” el_build_equation_system","text":"Empirical likelihood estimating equations","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el_build_equation_system.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Empirical likelihood estimating equations â€” el_build_equation_system","text":"","code":"el_build_equation_system(   family,   response_model_matrix,   auxiliary_matrix,   respondent_weights,   N_pop,   n_resp_weighted,   mu_x_scaled )"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el_build_equation_system.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Empirical likelihood estimating equations â€” el_build_equation_system","text":"Returns function evaluating stacked EL equations   \\(\\beta\\), \\(W\\) (optionally) auxiliary multipliers.   responseâ€‘model score uses derivative Bernoulli logâ€‘likelihood   respect linear predictor, \\(\\partial\\log p(\\eta)/\\partial\\eta   = \\mu_\\eta(\\eta)/p(\\eta)\\), valid logit probit links.   matches semiparametric EL system Qin, Leung Shao (2002).","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el_compute_score_contrib.html","id":null,"dir":"Reference","previous_headings":"","what":"EL variance components and sandwich assembly â€” el_compute_score_contrib","title":"EL variance components and sandwich assembly â€” el_compute_score_contrib","text":"EL variance components sandwich assembly","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el_compute_score_contrib.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"EL variance components and sandwich assembly â€” el_compute_score_contrib","text":"","code":"el_compute_score_contrib(   family,   response_model_matrix_scaled,   auxiliary_matrix_scaled,   mu_x_scaled,   eta_i_hat,   w_i_hat,   W_hat,   denominator_hat,   lambda_W_hat )"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el_compute_score_contrib.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"EL variance components and sandwich assembly â€” el_compute_score_contrib","text":"Assembles respondent score matrix, computes covariance   total scores (IID crossproduct survey design-based), constructs   delta variance \\(\\hat Y\\) via \\(\\nabla g\\,^{-1} B ^{-T}\\,\\nabla g^T\\).   Consistent asymptotic results Qin, Leung Shao (2002).","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el_engine.html","id":null,"dir":"Reference","previous_headings":"","what":"Empirical likelihood (EL) engine for NMAR â€” el_engine","title":"Empirical likelihood (EL) engine for NMAR â€” el_engine","text":"Constructs configuration empirical likelihood estimator nonignorable nonresponse (NMAR), following Qin, Leung Shao (2002). Pass returned object `nmar()` together formula data.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el_engine.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Empirical likelihood (EL) engine for NMAR â€” el_engine","text":"","code":"el_engine(   standardize = TRUE,   trim_cap = Inf,   on_failure = c(\"return\", \"error\"),   variance_method = c(\"delta\", \"bootstrap\"),   variance_jacobian = c(\"auto\", \"analytic\", \"numeric\"),   solver_jacobian = c(\"auto\", \"analytic\", \"none\"),   variance_pseudoinverse = FALSE,   variance_ridge = FALSE,   bootstrap_reps = 500,   suppress_warnings = FALSE,   auxiliary_means = NULL,   control = list(),   family = c(\"logit\", \"probit\") )"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el_engine.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Empirical likelihood (EL) engine for NMAR â€” el_engine","text":"standardize Logical; standardize predictors. Default TRUE. trim_cap Numeric; cap EL weights (Inf = trimming). on_failure Character; \"return\" \"error\" solver failure. variance_method Character; \"delta\" \"bootstrap\". variance_jacobian Character; \"auto\", \"analytic\", \"numeric\". solver_jacobian Character; \"auto\", \"analytic\", \"none\". variance_pseudoinverse Logical; allow pseudo-inverse variance. variance_ridge Logical numeric; TRUE, apply adaptive ridge stabilize Jacobian inversion; numeric, treated ridge epsilon. bootstrap_reps Integer; reps variance_method = \"bootstrap\". suppress_warnings Logical; suppress variance method warnings. auxiliary_means Named numeric vector; population means auxiliaries (names must match RHS outcome formula). Optional. control List; optional solver control (passed ). family Response model family; string (\"logit\" \"probit\") family object created `logit_family()` / `probit_family()`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el_engine.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Empirical likelihood (EL) engine for NMAR â€” el_engine","text":"engine object class `c('nmar_engine_el','nmar_engine')`.   configuration list; fit. Pass `nmar()`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el_engine.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Empirical likelihood (EL) engine for NMAR â€” el_engine","text":"EL estimator uses weights satisfy estimating equations response mechanism optional auxiliary moment constraints. response model score derivative Bernoulli logâ€‘likelihood respect linear predictor, .e. `mu.eta(eta)/linkinv(eta)`, valid logit probit links. Response predictors need coincide auxiliary predictors; auxiliaries require known population moments. See theory note Qin, Leung Shao (2002) derivations.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el_engine.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Empirical likelihood (EL) engine for NMAR â€” el_engine","text":"Qin, J., Leung, D., Shao, J. (2002). Estimation survey data nonignorable nonresponse informative sampling. Journal American Statistical Association, 97(457), 193â€“200.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el_estimator_core.html","id":null,"dir":"Reference","previous_headings":"","what":"Core Empirical Likelihood Estimator â€” el_estimator_core","title":"Core Empirical Likelihood Estimator â€” el_estimator_core","text":"Implements core computational engine empirical likelihood estimation nonignorable nonresponse, including parameter solving, variance calculation, diagnostic computation.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el_estimator_core.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Core Empirical Likelihood Estimator â€” el_estimator_core","text":"","code":"el_estimator_core(   full_data,   respondent_data,   respondent_weights,   N_pop,   internal_formula,   auxiliary_means,   standardize,   trim_cap,   control,   compute_score_variance_func,   on_failure,   family = logit_family(),   variance_method,   bootstrap_reps,   variance_jacobian = c(\"auto\", \"analytic\", \"numeric\"),   solver_jacobian = c(\"auto\", \"analytic\", \"none\"),   variance_pseudoinverse = FALSE,   variance_ridge = FALSE,   user_args,   ... )"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el_estimator_core.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Core Empirical Likelihood Estimator â€” el_estimator_core","text":"full_data Data frame survey design object containing units. respondent_data Data frame containing responding units. respondent_weights Numeric vector base sampling weights respondents. N_pop Numeric. Total population size (weighted survey design). internal_formula List internal formulas outcome, response, auxiliary models. auxiliary_means Named numeric vector known population means. standardize Logical. Whether standardize predictors estimation. trim_cap Numeric. Upper bound empirical likelihood weight trimming. control List control parameters nonlinear equation solver. compute_score_variance_func Function compute covariance score totals. on_failure Character. Action solver fails: \"return\" \"error\". family List. Link function specification (typically logit). variance_method Character. Variance estimation method. bootstrap_reps Integer. Number bootstrap replications. variance_jacobian Character. Jacobian method variance computation. solver_jacobian Character. Jacobian method equation solving. variance_pseudoinverse Logical. Use pseudoinverse singular matrices. variance_ridge Logical. Use ridge regularization variance. user_args List. Original user arguments bootstrap replication. ... Additional arguments passed solver.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el_estimator_core.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Core Empirical Likelihood Estimator â€” el_estimator_core","text":"List containing estimation results, diagnostics, metadata.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/el_estimator_core.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Core Empirical Likelihood Estimator â€” el_estimator_core","text":"function implements complete empirical likelihood estimation algorithm: 1. Data preparation scaling 2. Equation system construction 3. Multi-stage nonlinear equation solving robust fallback strategies 4. Weight computation trimming 5. Variance estimation (delta method bootstrap) 6. Comprehensive diagnostic computation","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/engine_traits.html","id":null,"dir":"Reference","previous_headings":"","what":"Engine trait declarations â€” engine_traits","title":"Engine trait declarations â€” engine_traits","text":"Engines can override generic relax tighten validation checks. defaults match historical behavior exponential tilting engines.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/engine_traits.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Engine trait declarations â€” engine_traits","text":"","code":"engine_traits(engine)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/exptilt.html","id":null,"dir":"Reference","previous_headings":"","what":"Exponential tilting estimator â€” exptilt","title":"Exponential tilting estimator â€” exptilt","text":"Generic exponential tilting (ET) estimator NMAR.   Methods provided `data.frame` `survey.design`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/exptilt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Exponential tilting estimator â€” exptilt","text":"","code":"exptilt(data, ...)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/exptilt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Exponential tilting estimator â€” exptilt","text":"data `data.frame` `survey.design`. ... Passed class-specific methods.","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/NMAR/reference/exptilt_engine.html","id":null,"dir":"Reference","previous_headings":"","what":"Exponential tilting engine for NMAR estimation â€” exptilt_engine","title":"Exponential tilting engine for NMAR estimation â€” exptilt_engine","text":"Build configuration object exponential tilting (ET) estimator -missing--random (NMAR) missingness. configuration controls missingness link, outcome density model, scaling, variance computation, solver behaviour. Pass resulting engine [nmar()] fit ET estimator.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/exptilt_engine.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Exponential tilting engine for NMAR estimation â€” exptilt_engine","text":"","code":"exptilt_engine(   standardize = TRUE,   on_failure = c(\"return\", \"error\"),   variance_method = c(\"delta\", \"bootstrap\"),   bootstrap_reps = 10,   supress_warnings = FALSE,   auxiliary_means = NULL,   control = list(),   family = c(\"logit\", \"probit\"),   y_dens = c(\"auto\", \"normal\", \"lognormal\", \"exponential\"),   min_iter = 10,   max_iter = 100,   optim_method = c(\"Newton\", \"Broyden\"),   tol_value = 1e-05 )"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/exptilt_engine.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Exponential tilting engine for NMAR estimation â€” exptilt_engine","text":"standardize Logical; standardise covariates prior optimisation. on_failure One `\"return\"` `\"error\"`; governs happens solver fails converge. variance_method Variance estimator use (`\"delta\"` `\"bootstrap\"`). bootstrap_reps Integer number bootstrap replications `variance_method = \"bootstrap\"`. supress_warnings Logical; suppress variance-related warnings. auxiliary_means Optional named numeric vector population moments auxiliary covariates. control Optional list additional solver controls. family Missingness link function (`\"logit\"` `\"probit\"`). y_dens Outcome density model (`\"auto\"`, `\"normal\"`, `\"lognormal\"`, `\"exponential\"`). min_iter Minimum number solver iterations. (migrated `control` future release.) max_iter Maximum number solver iterations. (migrated `control` future release.) optim_method Solver used response model (`\"Newton\"` `\"Broyden\"`). (migrated `control` future release.) tol_value Convergence tolerance optimisation routine. (migrated `control` future release.)","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/exptilt_engine.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Exponential tilting engine for NMAR estimation â€” exptilt_engine","text":"list class `c(\"nmar_engine_exptilt\", \"nmar_engine\")`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/exptilt_nonparam_engine.html","id":null,"dir":"Reference","previous_headings":"","what":"Nonparametric exponential tilting engine â€” exptilt_nonparam_engine","title":"Nonparametric exponential tilting engine â€” exptilt_nonparam_engine","text":"Build configuration nonparametric exponential-tilting EM estimator used NMAR problems grouped outcomes refusal counts. Pass resulting engine [nmar()] together appropriate formula data.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/exptilt_nonparam_engine.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Nonparametric exponential tilting engine â€” exptilt_nonparam_engine","text":"","code":"exptilt_nonparam_engine(refusal_col, max_iter = 100, tol_value = 1e-06)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/exptilt_nonparam_engine.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Nonparametric exponential tilting engine â€” exptilt_nonparam_engine","text":"refusal_col Column name `data` containing refusal counts. max_iter Maximum number EM iterations. tol_value Convergence tolerance EM updates.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/exptilt_nonparam_engine.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Nonparametric exponential tilting engine â€” exptilt_nonparam_engine","text":"list class `c(\"nmar_engine_exptilt_nonparam\", \"nmar_engine\")`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/fitted.nmar_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Default fitted values for NMAR results â€” fitted.nmar_result","title":"Default fitted values for NMAR results â€” fitted.nmar_result","text":"Returns fitted response probabilities available.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/fitted.nmar_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default fitted values for NMAR results â€” fitted.nmar_result","text":"","code":"# S3 method for class 'nmar_result' fitted(object, ...)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/fitted.nmar_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Default fitted values for NMAR results â€” fitted.nmar_result","text":"object `nmar_result` object. ... Ignored.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/fitted.nmar_result.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Default fitted values for NMAR results â€” fitted.nmar_result","text":"numeric vector (possibly length 0).","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/formula.nmar_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Default formula for NMAR results â€” formula.nmar_result","title":"Default formula for NMAR results â€” formula.nmar_result","text":"Returns estimation formula available.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/formula.nmar_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default formula for NMAR results â€” formula.nmar_result","text":"","code":"# S3 method for class 'nmar_result' formula(x, ...)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/formula.nmar_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Default formula for NMAR results â€” formula.nmar_result","text":"x `nmar_result` object. ... Ignored.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/formula.nmar_result.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Default formula for NMAR results â€” formula.nmar_result","text":"formula `NULL`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/get_eta_cap.html","id":null,"dir":"Reference","previous_headings":"","what":"Numerical helpers â€” get_eta_cap","title":"Numerical helpers â€” get_eta_cap","text":"Numerical helpers","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/get_eta_cap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Numerical helpers â€” get_eta_cap","text":"","code":"get_eta_cap()"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/glance.nmar_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Glance summary for NMAR results â€” glance.nmar_result","title":"Glance summary for NMAR results â€” glance.nmar_result","text":"One-row diagnostics NMAR fits.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/glance.nmar_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Glance summary for NMAR results â€” glance.nmar_result","text":"","code":"glance.nmar_result(x, ...)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/glance.nmar_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Glance summary for NMAR results â€” glance.nmar_result","text":"x object class `nmar_result`. ... Ignored.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/invert_jacobian.html","id":null,"dir":"Reference","previous_headings":"","what":"Invert a Jacobian matrix with numerically robust fallbacks. â€” invert_jacobian","title":"Invert a Jacobian matrix with numerically robust fallbacks. â€” invert_jacobian","text":"Attempts plain inverse matrix well conditioned, otherwise applies ridge regularisation pseudo-inverse requested.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/invert_jacobian.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Invert a Jacobian matrix with numerically robust fallbacks. â€” invert_jacobian","text":"","code":"invert_jacobian(   A_matrix,   variance_ridge = FALSE,   variance_pseudoinverse = FALSE,   kappa_threshold = 1e+08,   ridge_scale = NULL,   svd_tol = NULL )"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/invert_jacobian.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Invert a Jacobian matrix with numerically robust fallbacks. â€” invert_jacobian","text":"A_matrix Numeric square matrix invert. variance_ridge Logical positive numeric: apply ridge stabilisation (`TRUE` selects adaptive ridge, numeric values supply ridge size). variance_pseudoinverse Logical; `TRUE`, compute SVD-based pseudo-inverse. kappa_threshold Numeric tolerance controlling plain inverse attempted. ridge_scale Optional numeric multiplier adaptive ridge. svd_tol Optional numeric tolerance singular values truncated forming pseudo-inverse.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/logit_family.html","id":null,"dir":"Reference","previous_headings":"","what":"Logit family functions (link and derivatives) â€” logit_family","title":"Logit family functions (link and derivatives) â€” logit_family","text":"Logit family functions (link derivatives)","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/logit_family.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logit family functions (link and derivatives) â€” logit_family","text":"","code":"logit_family()"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/new_nmar_engine_el.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct EL Engine Object â€” new_nmar_engine_el","title":"Construct EL Engine Object â€” new_nmar_engine_el","text":"Construct EL Engine Object","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/new_nmar_engine_el.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct EL Engine Object â€” new_nmar_engine_el","text":"","code":"new_nmar_engine_el(engine)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/new_nmar_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct Result Object (parent helper) â€” new_nmar_result","title":"Construct Result Object (parent helper) â€” new_nmar_result","text":"Builds normalized `nmar_result` list using modern schema. Engines must pass named fields; legacy positional signature supported.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/new_nmar_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct Result Object (parent helper) â€” new_nmar_result","text":"","code":"new_nmar_result(...)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/new_nmar_result_el.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct EL Result Object â€” new_nmar_result_el","title":"Construct EL Result Object â€” new_nmar_result_el","text":"Construct EL Result Object","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/new_nmar_result_el.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct EL Result Object â€” new_nmar_result_el","text":"","code":"new_nmar_result_el(   y_hat,   se,   weights,   coefficients,   vcov,   converged,   diagnostics,   data_info,   nmar_scaling_recipe,   fitted_values,   call )"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/new_nmar_task.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a normalized NMAR task object â€” new_nmar_task","title":"Create a normalized NMAR task object â€” new_nmar_task","text":"Create normalized NMAR task object","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/new_nmar_task.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a normalized NMAR task object â€” new_nmar_task","text":"","code":"new_nmar_task(spec, traits)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/new_nmar_task.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a normalized NMAR task object â€” new_nmar_task","text":"spec Parsed NMAR specification produced [parse_nmar_spec()]. traits Engine traits returned [engine_traits()].","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/nmar.html","id":null,"dir":"Reference","previous_headings":"","what":"Not Missing at Random (NMAR) Estimation â€” nmar","title":"Not Missing at Random (NMAR) Estimation â€” nmar","text":"Provides unified interface Missing Random (NMAR) estimation.   function orchestrates estimation process validating inputs   dispatching appropriate engine based provided `engine` object.   ensures necessary data model specifications correctly   formatted computation begins.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/nmar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Not Missing at Random (NMAR) Estimation â€” nmar","text":"","code":"nmar(formula, data, engine, response_predictors = NULL)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/nmar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Not Missing at Random (NMAR) Estimation â€” nmar","text":"formula two-sided formula form `y_miss ~ x1 + x2 + ...` specifying outcome (`NA` values indicating nonresponse) auxiliary variables used stabilise estimation. data data frame `survey.design` containing variables referenced formula. engine engine configuration object, typically created engine constructor function like `exptilt()`. object defines specific NMAR estimation method parameters. must inherit class `nmar_engine`. response_predictors Optional character vector naming additional predictors response (missingness) model. variables need appear right-hand side `formula` interpreted chosen engine.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/nmar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Not Missing at Random (NMAR) Estimation â€” nmar","text":"object containing estimation results, whose structure   specific `engine` used. might include estimated parameters,   convergence information, relevant output chosen NMAR method.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/nmar_result_get_estimate.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal helpers for nmar_result objects â€” nmar_result_get_estimate","title":"Internal helpers for nmar_result objects â€” nmar_result_get_estimate","text":"Internal helpers nmar_result objects","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/nmar_result_get_estimate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Internal helpers for nmar_result objects â€” nmar_result_get_estimate","text":"","code":"nmar_result_get_estimate(x)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/nmar_result_s3_parent.html","id":null,"dir":"Reference","previous_headings":"","what":"Parent S3 surface for NMAR results â€” nmar_result_s3_parent","title":"Parent S3 surface for NMAR results â€” nmar_result_s3_parent","text":"Methods apply parent `nmar_result` class   specific particular engine (e.g., EL). Engines return child class   (e.g., `nmar_result_el`) inherits `nmar_result` may override   extend behavior.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/nmar_result_s3_parent.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Parent S3 surface for NMAR results â€” nmar_result_s3_parent","text":"S3 surface base `nmar_result` Result objects expose universal schema:   - `estimate`, `estimate_name`, `std_error`, `converged`.   - `model`: list `coefficients`, `vcov`, plus optional extras.   - `weights_info`: list respondent weights trimming metadata.   - `sample`: list total units, respondent count, survey flag, `design`.   - `inference`: variance metadata (`variance_method`, `df`, diagnostic flags).   - `diagnostics`, `meta`, `extra` estimator-specific details. New engines populate components constructors rely   `nmar_result_get_*` utilities implementing child-specific S3   methods.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/parse_nmar_spec.html","id":null,"dir":"Reference","previous_headings":"","what":"NMAR input parsing and validation helpers â€” parse_nmar_spec","title":"NMAR input parsing and validation helpers â€” parse_nmar_spec","text":"developer-facing utilities centralize parsing user supplied formulas/data allow engines declare small trait lists control validation strictness. Keeping argument checks one place ensures consistent error messages makes easier extend package additional engines.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/parse_nmar_spec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"NMAR input parsing and validation helpers â€” parse_nmar_spec","text":"","code":"parse_nmar_spec(   formula,   data,   response_predictors = NULL,   env = parent.frame() )"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/plot.nmar_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Base plotting for NMAR results â€” plot.nmar_result","title":"Base plotting for NMAR results â€” plot.nmar_result","text":"Quick base plots weights, fitted probabilities, constraints diagnostics.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/plot.nmar_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Base plotting for NMAR results â€” plot.nmar_result","text":"","code":"# S3 method for class 'nmar_result' plot(x, which = c(\"weights\", \"fitted\", \"constraints\", \"diagnostics\"), ...)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/plot.nmar_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Base plotting for NMAR results â€” plot.nmar_result","text":"x object class `nmar_result`. plot: one `\"weights\"`, `\"fitted\"`, `\"constraints\"`, `\"diagnostics\"`. ... Ignored.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/prepare_el_inputs.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare inputs for EL estimation â€” prepare_el_inputs","title":"Prepare inputs for EL estimation â€” prepare_el_inputs","text":"Prepare inputs EL estimation","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/prepare_el_inputs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare inputs for EL estimation â€” prepare_el_inputs","text":"","code":"prepare_el_inputs(formula, data, response_predictors)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/prepare_el_inputs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prepare inputs for EL estimation â€” prepare_el_inputs","text":"Validates two-sided outcome formula constructs three   internal formulas: outcome (~ outcome_var), response (missingness   model), auxiliary (RHS , intercept). `response_predictors`   may include variables outcome RHS; variables enter   response model (auxiliary moment constraint). variables   outcome RHS treated auxiliaries , provided, must match   names `auxiliary_means`. See Qin, Leung Shao (2002) EL   formulation.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/prepare_nmar_design.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare common NMAR design components â€” prepare_nmar_design","title":"Prepare common NMAR design components â€” prepare_nmar_design","text":"Prepare common NMAR design components","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/prepare_nmar_design.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare common NMAR design components â€” prepare_nmar_design","text":"","code":"prepare_nmar_design(   task,   standardize = TRUE,   auxiliary_means = NULL,   include_response = TRUE,   include_auxiliary = TRUE,   data = task$data,   design_weights = NULL )"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/prepare_nmar_design.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare common NMAR design components â€” prepare_nmar_design","text":"task object created [new_nmar_task()]. standardize Logical flag forwarded engines. auxiliary_means Optional named vector auxiliary means. include_response Logical; include response predictors. include_auxiliary Logical; include auxiliary predictors. data Optional override data-frame backing task. design_weights Optional numeric vector design weights.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/prepare_nmar_design.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare common NMAR design components â€” prepare_nmar_design","text":"list containing trimmed data, predictor sets, weights, survey   design (applicable), formula, standardization settings.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/prepare_nmar_scaling.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare scaled matrices and moments (low-level) â€” prepare_nmar_scaling","title":"Prepare scaled matrices and moments (low-level) â€” prepare_nmar_scaling","text":"Prepare scaled matrices moments (low-level)","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/prepare_nmar_scaling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare scaled matrices and moments (low-level) â€” prepare_nmar_scaling","text":"","code":"prepare_nmar_scaling(   Z_un,   X_un,   mu_x_un,   standardize,   weights = NULL,   weight_mask = NULL )"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/prepare_nmar_scaling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare scaled matrices and moments (low-level) â€” prepare_nmar_scaling","text":"Z_un response model matrix (intercept column). X_un auxiliary model matrix (intercept), NULL. mu_x_un named numeric vector auxiliary means original scale (names must match `colnames(X_un)`), NULL. standardize logical; apply standardization TRUE. weights Optional numeric vector used weighted scaling. weight_mask Optional logical/numeric mask applied `weights`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/prepare_nmar_scaling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare scaled matrices and moments (low-level) â€” prepare_nmar_scaling","text":"list `Z`, `X`, `mu_x`, `recipe`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/print.nmar_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for nmar_result â€” print.nmar_result","title":"Print method for nmar_result â€” print.nmar_result","text":"Print method nmar_result","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/print.nmar_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for nmar_result â€” print.nmar_result","text":"","code":"# S3 method for class 'nmar_result' print(x, ...)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/print.nmar_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for nmar_result â€” print.nmar_result","text":"x nmar_result object ... Additional parameters","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/print.nmar_result_el.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for EL results â€” print.nmar_result_el","title":"Print method for EL results â€” print.nmar_result_el","text":"Compact print objects class `nmar_result_el`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/print.nmar_result_el.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for EL results â€” print.nmar_result_el","text":"","code":"# S3 method for class 'nmar_result_el' print(x, ...)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/print.nmar_result_el.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for EL results â€” print.nmar_result_el","text":"x object class `nmar_result_el`. ... Ignored.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/print.summary_nmar_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for summary.nmar_result â€” print.summary_nmar_result","title":"Print method for summary.nmar_result â€” print.summary_nmar_result","text":"Print method summary.nmar_result","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/print.summary_nmar_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for summary.nmar_result â€” print.summary_nmar_result","text":"","code":"# S3 method for class 'summary_nmar_result' print(x, ...)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/print.summary_nmar_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for summary.nmar_result â€” print.summary_nmar_result","text":"x summary_nmar_result object ... Additional parameters","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/probit_family.html","id":null,"dir":"Reference","previous_headings":"","what":"Probit family functions (link and derivatives) â€” probit_family","title":"Probit family functions (link and derivatives) â€” probit_family","text":"Probit family functions (link derivatives)","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/probit_family.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Probit family functions (link and derivatives) â€” probit_family","text":"","code":"probit_family()"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/run_engine.nmar_engine_el.html","id":null,"dir":"Reference","previous_headings":"","what":"Run method for EL engine â€” run_engine.nmar_engine_el","title":"Run method for EL engine â€” run_engine.nmar_engine_el","text":"Run method EL engine","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/run_engine.nmar_engine_el.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run method for EL engine â€” run_engine.nmar_engine_el","text":"","code":"# S3 method for class 'nmar_engine_el' run_engine(engine, task)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/summary.nmar_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for nmar_result â€” summary.nmar_result","title":"Summary method for nmar_result â€” summary.nmar_result","text":"Summary method nmar_result","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/summary.nmar_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for nmar_result â€” summary.nmar_result","text":"","code":"# S3 method for class 'nmar_result' summary(object, conf.level = 0.95, ...)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/summary.nmar_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for nmar_result â€” summary.nmar_result","text":"object nmar_result object conf.level Confidence level intervals. ... Additional parameters","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/summary.nmar_result_el.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for EL results â€” summary.nmar_result_el","title":"Summary method for EL results â€” summary.nmar_result_el","text":"Summarize estimation, standard error response-model coefficients.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/summary.nmar_result_el.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for EL results â€” summary.nmar_result_el","text":"","code":"# S3 method for class 'nmar_result_el' summary(object, ...)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/summary.nmar_result_el.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for EL results â€” summary.nmar_result_el","text":"object object class `nmar_result_el`. ... Ignored.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/tidy.nmar_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Tidy summary for NMAR results â€” tidy.nmar_result","title":"Tidy summary for NMAR results â€” tidy.nmar_result","text":"Return data frame primary estimate (available) response-model coefficients.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/tidy.nmar_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tidy summary for NMAR results â€” tidy.nmar_result","text":"","code":"tidy.nmar_result(x, conf.level = 0.95, ...)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/tidy.nmar_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tidy summary for NMAR results â€” tidy.nmar_result","text":"x object class `nmar_result`. conf.level Confidence level primary estimate. ... Ignored.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/trim_weights.html","id":null,"dir":"Reference","previous_headings":"","what":"Weight utilities â€” trim_weights","title":"Weight utilities â€” trim_weights","text":"Weight utilities","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/trim_weights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Weight utilities â€” trim_weights","text":"","code":"trim_weights(weights, cap)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/unscale_coefficients.html","id":null,"dir":"Reference","previous_headings":"","what":"Unscale regression coefficients and covariance â€” unscale_coefficients","title":"Unscale regression coefficients and covariance â€” unscale_coefficients","text":"Unscale regression coefficients covariance","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/unscale_coefficients.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Unscale regression coefficients and covariance â€” unscale_coefficients","text":"","code":"unscale_coefficients(scaled_coeffs, scaled_vcov, recipe)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/unscale_coefficients.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Unscale regression coefficients and covariance â€” unscale_coefficients","text":"scaled_coeffs named numeric vector coefficients estimated scaled space. scaled_vcov covariance matrix `scaled_coeffs`. recipe `nmar_scaling_recipe` produced scaling applied.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/unscale_coefficients.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Unscale regression coefficients and covariance â€” unscale_coefficients","text":"list unscaled `coefficients` `vcov`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validate_and_apply_nmar_scaling.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate and apply scaling (engine-friendly) â€” validate_and_apply_nmar_scaling","title":"Validate and apply scaling (engine-friendly) â€” validate_and_apply_nmar_scaling","text":"Validate apply scaling (engine-friendly)","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validate_and_apply_nmar_scaling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate and apply scaling (engine-friendly) â€” validate_and_apply_nmar_scaling","text":"","code":"validate_and_apply_nmar_scaling(   standardize,   has_aux,   response_model_matrix_unscaled,   auxiliary_matrix_unscaled,   mu_x_unscaled,   weights = NULL,   weight_mask = NULL )"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validate_and_apply_nmar_scaling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate and apply scaling (engine-friendly) â€” validate_and_apply_nmar_scaling","text":"standardize logical; apply standardization TRUE. has_aux logical; whether engine uses auxiliary constraints. response_model_matrix_unscaled response model matrix (intercept). auxiliary_matrix_unscaled auxiliary matrix (intercept) empty matrix. mu_x_unscaled named auxiliary means original scale, NULL. weights Optional numeric vector used weighted scaling. weight_mask Optional logical/numeric mask applied `weights`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validate_and_apply_nmar_scaling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate and apply scaling (engine-friendly) â€” validate_and_apply_nmar_scaling","text":"list `nmar_scaling_recipe`, `response_model_matrix_scaled`,   `auxiliary_matrix_scaled`, `mu_x_scaled`.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validate_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate Data for NMAR Analysis â€” validate_data","title":"Validate Data for NMAR Analysis â€” validate_data","text":"robust function validate data frame survey object performing NMAR analysis. function checks common errors like missing variables, data type inconsistencies, inappropriate variable overlaps. provides detailed, actionable error messages facilitate debugging.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validate_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate Data for NMAR Analysis â€” validate_data","text":"","code":"validate_data(   data,   outcome_variable,   covariates_for_outcome,   covariates_for_missingness = character(),   allow_outcome_in_missingness = FALSE,   allow_covariate_overlap = FALSE )"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validate_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate Data for NMAR Analysis â€” validate_data","text":"data data frame survey object. outcome_variable string specifying outcome variable, expected contain NA values. covariates_for_outcome character vector covariates explaining outcome. covariates_for_missingness character vector covariates explaining missingness. allow_outcome_in_missingness Logical; allow outcome also appear response-model covariates (default `FALSE`). allow_covariate_overlap Logical; allow overlap outcome response covariate sets (default `FALSE`).","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validate_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate Data for NMAR Analysis â€” validate_data","text":"Returns `invisible(NULL)` success, stopping descriptive error failure.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validate_nmar_args.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate parsed NMAR inputs â€” validate_nmar_args","title":"Validate parsed NMAR inputs â€” validate_nmar_args","text":"Validate parsed NMAR inputs","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validate_nmar_args.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate parsed NMAR inputs â€” validate_nmar_args","text":"","code":"validate_nmar_args(spec, traits = list())"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validate_nmar_args.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate parsed NMAR inputs â€” validate_nmar_args","text":"spec Object produced [parse_nmar_spec()]. traits List engine traits produced [engine_traits()].","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validate_nmar_engine_el.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate EL Engine Settings â€” validate_nmar_engine_el","title":"Validate EL Engine Settings â€” validate_nmar_engine_el","text":"Validate EL Engine Settings","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validate_nmar_engine_el.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate EL Engine Settings â€” validate_nmar_engine_el","text":"","code":"validate_nmar_engine_el(engine)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validate_nmar_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate nmar_result structure â€” validate_nmar_result","title":"Validate nmar_result structure â€” validate_nmar_result","text":"Ensures child class parent schema satisfied. validator also back-fills defaults downstream code can rely presence optional components without defensive checks.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validate_nmar_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate nmar_result structure â€” validate_nmar_result","text":"","code":"validate_nmar_result(x, class_name)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validator.html","id":null,"dir":"Reference","previous_headings":"","what":"Custom Validation Module â€” validator","title":"Custom Validation Module â€” validator","text":"module provides set internal helper functions argument validation. functions designed throw clear error message validation check fails.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validator.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Custom Validation Module â€” validator","text":"","code":"validator"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validator.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Custom Validation Module â€” validator","text":"object class environment length 4.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validator_assert_choice.html","id":null,"dir":"Reference","previous_headings":"","what":"Assert Choice â€” validator_assert_choice","title":"Assert Choice â€” validator_assert_choice","text":"Checks value one allowed choices.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validator_assert_choice.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assert Choice â€” validator_assert_choice","text":"x value check. choices vector allowed choices. name string representing name argument checked.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validator_assert_choice.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assert Choice â€” validator_assert_choice","text":"Returns nothing success, stops error failure.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validator_assert_logical.html","id":null,"dir":"Reference","previous_headings":"","what":"Assert Logical â€” validator_assert_logical","title":"Assert Logical â€” validator_assert_logical","text":"Checks value single logical value.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validator_assert_logical.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assert Logical â€” validator_assert_logical","text":"x value check. name string representing name argument checked.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validator_assert_logical.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assert Logical â€” validator_assert_logical","text":"Returns nothing success, stops error failure.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validator_assert_number.html","id":null,"dir":"Reference","previous_headings":"","what":"Assert Number â€” validator_assert_number","title":"Assert Number â€” validator_assert_number","text":"Checks value number within specified range.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validator_assert_number.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assert Number â€” validator_assert_number","text":"x value check. name string representing name argument checked. min minimum allowed value (inclusive). Defaults -Inf. max maximum allowed value (inclusive). Defaults Inf.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validator_assert_number.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assert Number â€” validator_assert_number","text":"Returns nothing success, stops error failure.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validator_assert_positive_integer.html","id":null,"dir":"Reference","previous_headings":"","what":"Assert Positive Integer â€” validator_assert_positive_integer","title":"Assert Positive Integer â€” validator_assert_positive_integer","text":"Checks value single, positive, optionally finite integer.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validator_assert_positive_integer.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assert Positive Integer â€” validator_assert_positive_integer","text":"x value check. name string representing name argument checked. .finite logical value. TRUE (default), checks number finite.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validator_assert_positive_integer.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assert Positive Integer â€” validator_assert_positive_integer","text":"Returns nothing success. Stops clear error failure.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validator_is_positive.html","id":null,"dir":"Reference","previous_headings":"","what":"Checks if a value is a single positive number. â€” validator_is_positive","title":"Checks if a value is a single positive number. â€” validator_is_positive","text":"Checks value single positive number.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validator_is_positive.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Checks if a value is a single positive number. â€” validator_is_positive","text":"","code":"is_positive(x)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validator_is_positive.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Checks if a value is a single positive number. â€” validator_is_positive","text":"x numeric value.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/validator_is_positive.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Checks if a value is a single positive number. â€” validator_is_positive","text":"logical value.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/vcov.nmar_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Variance-covariance for base NMAR results â€” vcov.nmar_result","title":"Variance-covariance for base NMAR results â€” vcov.nmar_result","text":"Variance-covariance base NMAR results","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/vcov.nmar_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variance-covariance for base NMAR results â€” vcov.nmar_result","text":"","code":"# S3 method for class 'nmar_result' vcov(object, ...)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/vcov.nmar_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variance-covariance for base NMAR results â€” vcov.nmar_result","text":"object object class `nmar_result`. ... Ignored.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/weights.nmar_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Default weights for NMAR results â€” weights.nmar_result","title":"Default weights for NMAR results â€” weights.nmar_result","text":"Returns respondent weights trimmed_fraction attribute present.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/weights.nmar_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default weights for NMAR results â€” weights.nmar_result","text":"","code":"# S3 method for class 'nmar_result' weights(object, ...)"},{"path":"https://ncn-foreigners.github.io/NMAR/reference/weights.nmar_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Default weights for NMAR results â€” weights.nmar_result","text":"object `nmar_result` object. ... Ignored.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/reference/weights.nmar_result.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Default weights for NMAR results â€” weights.nmar_result","text":"numeric vector (possibly length 0); attribute `trimmed_fraction` may set.","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/news/index.html","id":"nmar-development-version","dir":"Changelog","previous_headings":"","what":"NMAR (development version)","title":"NMAR (development version)","text":"Preparing CRAN deploy","code":""},{"path":[]},{"path":"https://ncn-foreigners.github.io/NMAR/news/index.html","id":"major-changes-0-0-0-1","dir":"Changelog","previous_headings":"","what":"Major changes","title":"NMAR 0.0.0.1","text":"Exptilt, el share similar structure design (#27)","code":""},{"path":"https://ncn-foreigners.github.io/NMAR/news/index.html","id":"minor-improvements-and-bug-fixes-0-0-0-1","dir":"Changelog","previous_headings":"","what":"Minor improvements and bug fixes","title":"NMAR 0.0.0.1","text":"feature 1 feature 2","code":""}]
