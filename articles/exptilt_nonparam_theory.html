<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Nonparametric Exponential Tilting Theory • NMAR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Nonparametric Exponential Tilting Theory">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">NMAR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/tutorial_empirical_likelihood.html">Empirical Likelihood</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial_exptilt.html">Exponential Tilting</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial_exptilt_nonparam.html">Exponential Tilting (Nonparametric)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Theory</h6></li>
    <li><a class="dropdown-item" href="../articles/el_empirical_likelihood_theory.html">Empirical Likelihood Theory for NMAR</a></li>
    <li><a class="dropdown-item" href="../articles/exptilt_theory.html">Exponential Tilting Theory</a></li>
    <li><a class="dropdown-item" href="../articles/exptilt_nonparam_theory.html">Nonparametric Exponential Tilting Theory</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ncn-foreigners/NMAR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Nonparametric Exponential Tilting Theory</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ncn-foreigners/NMAR/blob/package-dev/vignettes/exptilt_nonparam_theory.Rmd" class="external-link"><code>vignettes/exptilt_nonparam_theory.Rmd</code></a></small>
      <div class="d-none name"><code>exptilt_nonparam_theory.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette explains the matrix-vectorized implementation of the
<strong>fully nonparametric</strong> exponential tilting (EXPTILT)
estimator, as described in <strong>Appendix 2</strong> of Riddles et
al. (2016). This method is designed for <strong>fully categorical
data</strong>, where the outcomes
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>),
the response-model covariates
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math>),
and the instrumental-variable covariates
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_2</annotation></semantics></math>)
are all discrete.</p>
<p>Unlike the parametric method, which estimates the parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>
of a response probability function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>;</mo><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi(x, y; \phi)</annotation></semantics></math>,
the nonparametric approach directly estimates the <strong>nonresponse
odds</strong> for each stratum. This is achieved using an
<strong>Expectation-Maximization (EM) algorithm</strong> to find the
maximum likelihood estimates of these odds.</p>
<p>The implementation (<code>exptilt_nonparam.data.frame</code>) assumes
the input <code>data</code> is an <strong>aggregated data
frame</strong>, where each row represents a unique stratum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo>*</mo></msup><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">x^* = (x_1, x_2)</annotation></semantics></math>
and contains the <em>counts</em> of respondents for each outcome
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>y</mi><mo>*</mo></msup><annotation encoding="application/x-tex">y^*</annotation></semantics></math>
and the <em>total count</em> of nonrespondents.</p>
</div>
<div class="section level2">
<h2 id="notation-and-main-objects">Notation and Main Objects<a class="anchor" aria-label="anchor" href="#notation-and-main-objects"></a>
</h2>
<p>The implementation maps directly to the notation in Appendix 2. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>1</mn></msub><annotation encoding="application/x-tex">x_1</annotation></semantics></math>
be the covariates for the response model and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>2</mn></msub><annotation encoding="application/x-tex">x_2</annotation></semantics></math>
be the nonresponse instrumental variable. A full stratum is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo>*</mo></msup><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">x^* = (x_1, x_2)</annotation></semantics></math>,
and a response-model-only stratum is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>1</mn></msub><annotation encoding="application/x-tex">x_1</annotation></semantics></math>.</p>
<p>The algorithm is built from a set of fixed matrices (computed once)
and one matrix that is iteratively updated.</p>
<div class="section level3">
<h3 id="fixed-objects-pre-computed">Fixed Objects (Pre-computed)<a class="anchor" aria-label="anchor" href="#fixed-objects-pre-computed"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Respondent Counts
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mrow><msup><mi>y</mi><mo>*</mo></msup><msup><mi>x</mi><mo>*</mo></msup></mrow></msub><annotation encoding="application/x-tex">N_{y^*x^*}</annotation></semantics></math></strong>
(code: <code>n_y_x_matrix</code>)
<ul>
<li>
<strong>Source:</strong> <code>data[, outcome_cols]</code>
</li>
<li>
<strong>Dimensions:</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mtext mathvariant="normal">strata</mtext></msub><mo>×</mo><msub><mi>K</mi><mtext mathvariant="normal">outcomes</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(N_{\text{strata}} \times K_{\text{outcomes}})</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mtext mathvariant="normal">strata</mtext></msub><annotation encoding="application/x-tex">N_{\text{strata}}</annotation></semantics></math>
is the number of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_1, x_2)</annotation></semantics></math>
rows and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mtext mathvariant="normal">outcomes</mtext></msub><annotation encoding="application/x-tex">K_{\text{outcomes}}</annotation></semantics></math>
is the number of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
categories.</li>
<li>
<strong>Definition:</strong> The observed (weighted) count of
respondents for stratum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>x</mi><mo>*</mo></msup><annotation encoding="application/x-tex">x^*</annotation></semantics></math>
and outcome
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>y</mi><mo>*</mo></msup><annotation encoding="application/x-tex">y^*</annotation></semantics></math>.
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mrow><msup><mi>y</mi><mo>*</mo></msup><msup><mi>x</mi><mo>*</mo></msup></mrow></msub><mo>=</mo><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>A</mi></mrow></munder><msub><mi>d</mi><mi>i</mi></msub><msub><mi>δ</mi><mi>i</mi></msub><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msup><mi>y</mi><mo>*</mo></msup><mo>,</mo><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><msup><mi>x</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N_{y^*x^*} = \sum_{i \in A} d_i \delta_i I(y_i = y^*, x_i = x^*)</annotation></semantics></math>
(Note: The implementation assumes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">d_i=1</annotation></semantics></math>
unless the input <code>data</code> is pre-weighted).</li>
</ul>
</li>
<li>
<strong>Nonrespondent Counts
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>M</mi><msup><mi>x</mi><mo>*</mo></msup></msub><annotation encoding="application/x-tex">M_{x^*}</annotation></semantics></math></strong>
(code: <code>m_x_vec</code>)
<ul>
<li>
<strong>Source:</strong> <code>data[, refusal_col]</code>
</li>
<li>
<strong>Dimensions:</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mtext mathvariant="normal">strata</mtext></msub><mo>×</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(N_{\text{strata}} \times 1)</annotation></semantics></math>
</li>
<li>
<strong>Definition:</strong> The observed (weighted) total count of
nonrespondents for stratum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>x</mi><mo>*</mo></msup><annotation encoding="application/x-tex">x^*</annotation></semantics></math>.
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><msup><mi>x</mi><mo>*</mo></msup></msub><mo>=</mo><msub><mi>m</mi><msup><mi>x</mi><mo>*</mo></msup></msub></mrow><annotation encoding="application/x-tex">M_{x^*} = m_{x^*}</annotation></semantics></math>
</li>
</ul>
</li>
<li>
<strong>Respondent Proportions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>P</mi><mo accent="true">̂</mo></mover><mrow><msup><mi>y</mi><mo>*</mo></msup><mo stretchy="false" form="prefix">|</mo><msup><mi>x</mi><mo>*</mo></msup></mrow></msub><annotation encoding="application/x-tex">\hat{P}_{y^*|x^*}</annotation></semantics></math></strong>
(code: <code>p_hat_matrix</code>)
<ul>
<li>
<strong>Source:</strong>
<code>n_y_x_matrix / rowSums(n_y_x_matrix)</code>
</li>
<li>
<strong>Dimensions:</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mtext mathvariant="normal">strata</mtext></msub><mo>×</mo><msub><mi>K</mi><mtext mathvariant="normal">outcomes</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(N_{\text{strata}} \times K_{\text{outcomes}})</annotation></semantics></math>
</li>
<li>
<strong>Definition:</strong> The conditional probability
(proportion) of observing outcome
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>y</mi><mo>*</mo></msup><annotation encoding="application/x-tex">y^*</annotation></semantics></math>
given stratum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>x</mi><mo>*</mo></msup><annotation encoding="application/x-tex">x^*</annotation></semantics></math>,
<em>among respondents</em>. This is a fixed, observed quantity used in
the E-Step.
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mrow><msup><mi>y</mi><mo>*</mo></msup><mo stretchy="false" form="prefix">|</mo><msup><mi>x</mi><mo>*</mo></msup></mrow></msub><mo>=</mo><mfrac><msub><mi>N</mi><mrow><msup><mi>y</mi><mo>*</mo></msup><msup><mi>x</mi><mo>*</mo></msup></mrow></msub><mrow><munder><mo>∑</mo><mi>y</mi></munder><msub><mi>N</mi><mrow><mi>y</mi><msup><mi>x</mi><mo>*</mo></msup></mrow></msub></mrow></mfrac><mo>=</mo><mi>p</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo>=</mo><msup><mi>y</mi><mo>*</mo></msup><mo stretchy="false" form="prefix">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><msubsup><mi>x</mi><mn>1</mn><mo>*</mo></msubsup><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><msubsup><mi>x</mi><mn>2</mn><mo>*</mo></msubsup><mo>,</mo><mi>δ</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{p}_{y^*|x^*} = \frac{N_{y^*x^*}}{\sum_{y} N_{yx^*}} = pr(y=y^* | x_1=x_1^*, x_2=x_2^*, \delta=1)</annotation></semantics></math>
</li>
</ul>
</li>
<li>
<strong>Aggregated Respondent Counts
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mrow><msup><mi>y</mi><mo>*</mo></msup><msubsup><mi>x</mi><mn>1</mn><mo>*</mo></msubsup></mrow></msub><annotation encoding="application/x-tex">N_{y^*x_1^*}</annotation></semantics></math></strong>
(code: <code>n_y_x1_matrix</code>)
<ul>
<li>
<strong>Source:</strong>
<code>aggregate(n_y_x_matrix ~ data$x1_key, ...)</code>
</li>
<li>
<strong>Dimensions:</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><msub><mi>x</mi><mn>1</mn></msub></msub><mo>×</mo><msub><mi>K</mi><mtext mathvariant="normal">outcomes</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(N_{x_1} \times K_{\text{outcomes}})</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><msub><mi>x</mi><mn>1</mn></msub></msub><annotation encoding="application/x-tex">N_{x_1}</annotation></semantics></math>
is the number of unique
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>1</mn></msub><annotation encoding="application/x-tex">x_1</annotation></semantics></math>
strata.</li>
<li>
<strong>Definition:</strong> The observed (weighted) count of
respondents for outcome
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>y</mi><mo>*</mo></msup><annotation encoding="application/x-tex">y^*</annotation></semantics></math>
in stratum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>1</mn></msub><annotation encoding="application/x-tex">x_1</annotation></semantics></math>,
summed over the instrument
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>2</mn></msub><annotation encoding="application/x-tex">x_2</annotation></semantics></math>.
This is the denominator of the M-Step.
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mrow><msup><mi>y</mi><mo>*</mo></msup><msubsup><mi>x</mi><mn>1</mn><mo>*</mo></msubsup></mrow></msub><mo>=</mo><munder><mo>∑</mo><msub><mi>x</mi><mn>2</mn></msub></munder><msub><mi>N</mi><mrow><msup><mi>y</mi><mo>*</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>x</mi><mn>1</mn><mo>*</mo></msubsup><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mo>=</mo><msub><mi>n</mi><mrow><msup><mi>y</mi><mo>*</mo></msup><msubsup><mi>x</mi><mn>1</mn><mo>*</mo></msubsup></mrow></msub></mrow><annotation encoding="application/x-tex">N_{y^*x_1^*} = \sum_{x_2} N_{y^*(x_1^*, x_2)} = n_{y^*x_1^*}</annotation></semantics></math>
</li>
</ul>
</li>
</ol>
</div>
<div class="section level3">
<h3 id="iterative-objects-the-em-algorithm">Iterative Objects (The EM Algorithm)<a class="anchor" aria-label="anchor" href="#iterative-objects-the-em-algorithm"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Odds Matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O^{(t)}(x_1, y)</annotation></semantics></math></strong>
(code: <code>odds_matrix</code>)
<ul>
<li>
<strong>Dimensions:</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><msub><mi>x</mi><mn>1</mn></msub></msub><mo>×</mo><msub><mi>K</mi><mtext mathvariant="normal">outcomes</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(N_{x_1} \times K_{\text{outcomes}})</annotation></semantics></math>
</li>
<li>
<strong>Definition:</strong> The <strong>parameter</strong> being
estimated. It represents the odds of nonresponse for a given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>1</mn></msub><annotation encoding="application/x-tex">x_1</annotation></semantics></math>
stratum and outcome
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>.
This is updated in the M-Step.</li>
<li>
<strong>Initialization (Step 0):</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">O^{(0)}(x_1, y) = 1</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_1, y)</annotation></semantics></math>.</li>
</ul>
</li>
<li>
<strong>Expected Nonrespondent Counts
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>M</mi><mrow><msup><mi>y</mi><mo>*</mo></msup><msup><mi>x</mi><mo>*</mo></msup></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">M_{y^*x^*}^{(t)}</annotation></semantics></math></strong>
(code: <code>m_y_x_matrix</code>)
<ul>
<li>
<strong>Dimensions:</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mtext mathvariant="normal">strata</mtext></msub><mo>×</mo><msub><mi>K</mi><mtext mathvariant="normal">outcomes</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(N_{\text{strata}} \times K_{\text{outcomes}})</annotation></semantics></math>
</li>
<li>
<strong>Definition:</strong> The <em>expected</em> count of
nonrespondents for stratum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>x</mi><mo>*</mo></msup><annotation encoding="application/x-tex">x^*</annotation></semantics></math>
and outcome
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>y</mi><mo>*</mo></msup><annotation encoding="application/x-tex">y^*</annotation></semantics></math>,
given the current odds
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">O^{(t)}</annotation></semantics></math>.
This is computed in the E-Step.</li>
</ul>
</li>
<li>
<strong>Aggregated Expected Nonrespondent Counts
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>M</mi><mrow><msup><mi>y</mi><mo>*</mo></msup><msubsup><mi>x</mi><mn>1</mn><mo>*</mo></msubsup></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">M_{y^*x_1^*}^{(t)}</annotation></semantics></math></strong>
(code: <code>m_y_x1_matrix</code>)
<ul>
<li>
<strong>Dimensions:</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><msub><mi>x</mi><mn>1</mn></msub></msub><mo>×</mo><msub><mi>K</mi><mtext mathvariant="normal">outcomes</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(N_{x_1} \times K_{\text{outcomes}})</annotation></semantics></math>
</li>
<li>
<strong>Definition:</strong> The <em>expected</em> count of
nonrespondents for outcome
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>y</mi><mo>*</mo></msup><annotation encoding="application/x-tex">y^*</annotation></semantics></math>
in stratum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>1</mn></msub><annotation encoding="application/x-tex">x_1</annotation></semantics></math>,
summed over the instrument
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>2</mn></msub><annotation encoding="application/x-tex">x_2</annotation></semantics></math>.
This is the numerator of the M-Step.</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="the-expectation-maximization-em-algorithm">The Expectation-Maximization (EM) Algorithm<a class="anchor" aria-label="anchor" href="#the-expectation-maximization-em-algorithm"></a>
</h2>
<p>The function <code>exptilt_nonparam.data.frame</code> is a direct
implementation of the EM algorithm in Appendix 2. The goal is to find
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">argmax</mtext><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{argmax} O(x_1, y)</annotation></semantics></math>
that maximizes the observed data likelihood, which is solved by
iterating two steps.</p>
<div class="section level3">
<h3 id="step-1-1-e-step-compute-expected-nonrespondent-counts">Step 1.1 (E-Step): Compute Expected Nonrespondent Counts<a class="anchor" aria-label="anchor" href="#step-1-1-e-step-compute-expected-nonrespondent-counts"></a>
</h3>
<p>The E-Step computes the expected breakdown of nonrespondents into
outcome categories. It answers: “Given our current
<code>odds_matrix</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">O^{(t)}</annotation></semantics></math>,
what is the expected count
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>M</mi><mrow><msup><mi>y</mi><mo>*</mo></msup><msup><mi>x</mi><mo>*</mo></msup></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">M_{y^*x^*}^{(t)}</annotation></semantics></math>
for each full stratum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>x</mi><mo>*</mo></msup><annotation encoding="application/x-tex">x^*</annotation></semantics></math>?”</p>
<ul>
<li>
<strong>Formula:</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>M</mi><mrow><msup><mi>y</mi><mo>*</mo></msup><msup><mi>x</mi><mo>*</mo></msup></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><msub><mi>M</mi><msup><mi>x</mi><mo>*</mo></msup></msub><mfrac><mrow><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mrow><msup><mi>y</mi><mo>*</mo></msup><mo stretchy="false" form="prefix">|</mo><msup><mi>x</mi><mo>*</mo></msup></mrow></msub><msup><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>x</mi><mn>1</mn><mo>*</mo></msubsup><mo>,</mo><msup><mi>y</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><munder><mo>∑</mo><mi>y</mi></munder><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mrow><mi>y</mi><mo stretchy="false" form="prefix">|</mo><msup><mi>x</mi><mo>*</mo></msup></mrow></msub><msup><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>x</mi><mn>1</mn><mo>*</mo></msubsup><mo>,</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">M_{y^*x^*}^{(t)} = M_{x^*} \frac{\hat{p}_{y^*|x^*} O^{(t)}(x_1^*, y^*)}{\sum_{y} \hat{p}_{y|x^*} O^{(t)}(x_1^*, y)}</annotation></semantics></math>
</li>
<li>
<strong>Implementation (<code>E-STEP</code> in code):</strong> This
is vectorized. The denominator is computed via
<code>rowSums(p_hat_matrix * odds_joined_matrix)</code>. The full
calculation is:
<code>m_y_x_matrix &lt;- m_x_vec * (p_hat_matrix * odds_joined_matrix) / denominator</code>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="step-1-2-m-step-update-odds-matrix">Step 1.2 (M-Step): Update Odds Matrix<a class="anchor" aria-label="anchor" href="#step-1-2-m-step-update-odds-matrix"></a>
</h3>
<p>The M-Step updates the nonresponse odds
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(x_1, y)</annotation></semantics></math>
using the expected counts from the E-Step.</p>
<ol style="list-style-type: decimal">
<li>
<strong>Aggregate Expected Counts:</strong> First, the expected
nonrespondent counts
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>M</mi><mrow><msup><mi>y</mi><mo>*</mo></msup><msup><mi>x</mi><mo>*</mo></msup></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">M_{y^*x^*}^{(t)}</annotation></semantics></math>
are aggregated over the instrument
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>2</mn></msub><annotation encoding="application/x-tex">x_2</annotation></semantics></math>
to get the total expected nonrespondents
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>M</mi><mrow><msup><mi>y</mi><mo>*</mo></msup><msubsup><mi>x</mi><mn>1</mn><mo>*</mo></msubsup></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">M_{y^*x_1^*}^{(t)}</annotation></semantics></math>
for each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_1, y)</annotation></semantics></math>
cell.
<ul>
<li>
<strong>Formula:</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>M</mi><mrow><msup><mi>y</mi><mo>*</mo></msup><msubsup><mi>x</mi><mn>1</mn><mo>*</mo></msubsup></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><msub><mo>∑</mo><msub><mi>x</mi><mn>2</mn></msub></msub><msubsup><mi>M</mi><mrow><msup><mi>y</mi><mo>*</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>x</mi><mn>1</mn><mo>*</mo></msubsup><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">M_{y^*x_1^*}^{(t)} = \sum_{x_2} M_{y^*(x_1^*, x_2)}^{(t)}</annotation></semantics></math>
</li>
<li>
<strong>Implementation:</strong>
<code>m_y_x1_matrix &lt;- aggregate(m_y_x_matrix ~ data$x1_key, ...)</code>
</li>
</ul>
</li>
<li>
<strong>Update Odds:</strong> The new odds
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">O^{(t+1)}</annotation></semantics></math>
is the simple ratio of the <em>total expected nonrespondents</em> to the
<em>total observed respondents</em> for each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_1, y)</annotation></semantics></math>
cell.
<ul>
<li>
<strong>Formula:</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>x</mi><mn>1</mn><mo>*</mo></msubsup><mo>,</mo><msup><mi>y</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><msubsup><mi>M</mi><mrow><msup><mi>y</mi><mo>*</mo></msup><msubsup><mi>x</mi><mn>1</mn><mo>*</mo></msubsup></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><msub><mi>N</mi><mrow><msup><mi>y</mi><mo>*</mo></msup><msubsup><mi>x</mi><mn>1</mn><mo>*</mo></msubsup></mrow></msub></mfrac></mrow><annotation encoding="application/x-tex">O^{(t+1)}(x_1^*, y^*) = \frac{M_{y^*x_1^*}^{(t)}}{N_{y^*x_1^*}}</annotation></semantics></math>
</li>
<li>
<strong>Implementation:</strong>
<code>odds_matrix &lt;- m_y_x1_matrix / n_safe</code>
</li>
</ul>
</li>
</ol>
</div>
<div class="section level3">
<h3 id="step-2-convergence">Step 2: Convergence<a class="anchor" aria-label="anchor" href="#step-2-convergence"></a>
</h3>
<p>Steps 1.1 and 1.2 are repeated until the change in the
<code>odds_matrix</code> (measured by the sum of absolute differences)
falls below the tolerance <code>tol</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="final-estimates-and-survey-weights">Final Estimates and Survey Weights<a class="anchor" aria-label="anchor" href="#final-estimates-and-survey-weights"></a>
</h2>
<div class="section level3">
<h3 id="survey-weights">Survey Weights<a class="anchor" aria-label="anchor" href="#survey-weights"></a>
</h3>
<p>The <code>exptilt_nonparam.data.frame</code> function assumes the
input <code>data</code> is <strong>already aggregated</strong>. If a
<code>survey.design</code> object is provided to
<code>exptilt_nonparam.survey.design</code>, an adapter (not shown here)
must first be used to create this aggregated table from the microdata.
In that case,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mrow><msup><mi>y</mi><mo>*</mo></msup><msup><mi>x</mi><mo>*</mo></msup></mrow></msub><annotation encoding="application/x-tex">N_{y^*x^*}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>M</mi><msup><mi>x</mi><mo>*</mo></msup></msub><annotation encoding="application/x-tex">M_{x^*}</annotation></semantics></math>
represent <strong>weighted sums of counts</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∑</mo><msub><mi>d</mi><mi>i</mi></msub><mi>…</mi></mrow><annotation encoding="application/x-tex">\sum d_i \dots</annotation></semantics></math>),
not simple counts. The EM algorithm and all derived matrices
(<code>p_hat_matrix</code>, <code>odds_matrix</code>) are then correctly
computed based on these weighted inputs, following the logic of the
paper.</p>
</div>
<div class="section level3">
<h3 id="final-adjusted-counts">Final Adjusted Counts<a class="anchor" aria-label="anchor" href="#final-adjusted-counts"></a>
</h3>
<p>The final output <code>data_to_return</code> is the object of primary
interest for analysis. It is constructed by: 1. Calculating the final
expected nonrespondent counts
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>M</mi><mrow><msup><mi>y</mi><mo>*</mo></msup><msup><mi>x</mi><mo>*</mo></msup></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">final</mtext><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">M_{y^*x^*}^{(\text{final})}</annotation></semantics></math>
using the converged <code>odds_matrix</code>. 2. Adding these expected
counts to the original observed respondent counts
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mrow><msup><mi>y</mi><mo>*</mo></msup><msup><mi>x</mi><mo>*</mo></msup></mrow></msub><annotation encoding="application/x-tex">N_{y^*x^*}</annotation></semantics></math>.</p>
<ul>
<li>
<strong>Definition:</strong>
<code>data_to_return[y^*, x^*] = N_{y^*x^*} + M_{y^*x^*}^{(\text{final})}</code>
</li>
<li>
<strong>Implementation:</strong>
<code>data_to_return[, outcome_cols] &lt;- n_y_x_matrix_ordered + m_y_x_matrix_ordered</code>
</li>
</ul>
<p>This final adjusted table represents the completed dataset, where the
“Refusal” counts have been redistributed across the outcome columns
according to the NMAR model.</p>
</div>
<div class="section level3">
<h3 id="final-proportion-hattheta_j">Final Proportion
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>j</mi></msub><annotation encoding="application/x-tex">\hat{\theta}_j</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#final-proportion-hattheta_j"></a>
</h3>
<p>The final population proportion for an outcome
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>j</mi></msub><annotation encoding="application/x-tex">\hat{\theta}_j</annotation></semantics></math>,
is the total (weighted) adjusted count for outcome
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
divided by the total (weighted) population. This is calculated
<em>from</em> the <code>data_to_return</code> object.</p>
<ul>
<li>
<strong>Formula (Unweighted):</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>j</mi></msub><mo>=</mo><mfrac><mrow><munder><mo>∑</mo><msup><mi>x</mi><mo>*</mo></msup></munder><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mrow><mi>j</mi><msup><mi>x</mi><mo>*</mo></msup></mrow></msub><mo>+</mo><msubsup><mi>M</mi><mrow><mi>j</mi><msup><mi>x</mi><mo>*</mo></msup></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">final</mtext><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><munder><mo>∑</mo><mi>y</mi></munder><munder><mo>∑</mo><msup><mi>x</mi><mo>*</mo></msup></munder><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mrow><mi>y</mi><msup><mi>x</mi><mo>*</mo></msup></mrow></msub><mo>+</mo><msubsup><mi>M</mi><mrow><mi>y</mi><msup><mi>x</mi><mo>*</mo></msup></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">final</mtext><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">\hat{\theta}_j = \frac{\sum_{x^*} (N_{jx^*} + M_{jx^*}^{(\text{final})})}{\sum_y \sum_{x^*} (N_{yx^*} + M_{yx^*}^{(\text{final})})}</annotation></semantics></math>
</li>
<li>
<strong>Implementation:</strong> This is precisely what the
“Adjusted Proportions” calculation in your notebook’s Chunk 5 performs
on the <code>data_to_return</code> object.</li>
</ul>
<p>This differs from the paper’s Step 3 formula, which is an IPW
(Inverse Probability Weighting) estimator. However, both methods are
asymptotically equivalent, and the “add-and-sum” method (your
<code>data_to_return</code>) is a more direct and intuitive application
of the EM algorithm’s goal.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maciej Beresewicz, Igor Kołodziej, Mateusz Iwaniuk.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
