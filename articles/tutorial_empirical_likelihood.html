<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Empirical Likelihood • NMAR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Empirical Likelihood">
<meta name="description" content="Jing Qin, Denis Leung, Jun Shao &lt;br&gt;
Estimation With Survey Data Under Nonignorable Nonresponse or Informative Sampling &lt;br&gt;
http://dx.doi.org/10.1198/016214502753479338
">
<meta property="og:description" content="Jing Qin, Denis Leung, Jun Shao &lt;br&gt;
Estimation With Survey Data Under Nonignorable Nonresponse or Informative Sampling &lt;br&gt;
http://dx.doi.org/10.1198/016214502753479338
">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">NMAR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/tutorial_empirical_likelihood.html">Empirical Likelihood</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial_exptilt.html">Exponential Tilting</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial_exptilt_nonparam.html">Exponential Tilting (Nonparametric)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ncn-foreigners/NMAR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Empirical Likelihood</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ncn-foreigners/NMAR/blob/package-dev/vignettes/tutorial_empirical_likelihood.Rmd" class="external-link"><code>vignettes/tutorial_empirical_likelihood.Rmd</code></a></small>
      <div class="d-none name"><code>tutorial_empirical_likelihood.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette demonstrates the empirical likelihood (EL) estimator
for Not Missing At Random (NMAR) data in the NMAR package. The method
implements the estimator of Qin, Leung, and Shao (2002), using empirical
likelihood weights that satisfy estimating equations for the response
mechanism and (optionally) auxiliary moment constraints. For full
derivations and the analytic Jacobian/variance details, see the
companion article “Empirical Likelihood Theory for NMAR”.</p>
<p>Key features:</p>
<ul>
<li>Supports <code>data.frame</code> (IID) and
<code>survey.design</code> objects (design-based variance) via the same
<code><a href="../reference/nmar.html">nmar()</a></code> API.</li>
<li>Variance via bootstrap.</li>
<li>Optional standardization of predictors; weight trimming for
robustness.</li>
<li>Rich S3 surface: <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, <code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code>,
<code>tidy()</code>, <code>glance()</code>,
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>/<code><a href="../reference/autoplot.html">autoplot()</a></code>.</li>
</ul>
<div class="section level3">
<h3 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h3>
<ul>
<li>Specify the model with a two-sided formula:
<code>Y_miss ~ X1 + X2 | Z1 + Z2</code> where auxiliaries are left of
<code>|</code> and response‑only predictors are right of <code>|</code>.
If <code>|</code> is omitted, only auxiliaries are used.
<ul>
<li>Variables on the outcome RHS (e.g., <code>X1 + X2</code>) are
auxiliaries; supply their known population means via
<code>auxiliary_means = c(X1 = ..., X2 = ...)</code>.</li>
<li>Predictors to the right of <code>|</code> enter only the response
model (no auxiliary constraint) and do not need population means.</li>
</ul>
</li>
<li>Choose the engine: <code>el_engine(...)</code>, e.g.,
<code>el_engine(auxiliary_means = c(X1 = 0), variance_method = "bootstrap", standardize = TRUE)</code>.</li>
<li>Fit:
<code>nmar(formula = Y_miss ~ X1 + X2 | Z1 + Z2, data = df_or_design, engine = el_engine(...))</code>.</li>
<li>Inspect: <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, <code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code>,
<code><a href="https://rdrr.io/r/stats/weights.html" class="external-link">weights()</a></code>, <code><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted()</a></code>, and
<code>fit$diagnostics</code>. # # Data-frame example (IID)</li>
</ul>
<p>We simulate an NMAR mechanism where the response probability depends
on the unobserved outcome.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>collapse <span class="op">=</span> <span class="cn">TRUE</span>, comment <span class="op">=</span> <span class="st">"#&gt;"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ncn-foreigners/NMAR" class="external-link">NMAR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">X</span> <span class="op">+</span> <span class="va">Z</span></span>
<span></span>
<span><span class="co"># NMAR response: depends on Y</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.0</span> <span class="op">+</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">p</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Y_miss <span class="op">=</span> <span class="va">Y</span>, X <span class="op">=</span> <span class="va">X</span><span class="op">)</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">Y_miss</span><span class="op">[</span><span class="op">!</span><span class="va">R</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA_real_</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">engine</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/el_engine.html">el_engine</a></span><span class="op">(</span>auxiliary_means <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, variance_method <span class="op">=</span> <span class="st">"bootstrap"</span>, standardize <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># Fit EL estimator (bootstrap variance)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmar.html">nmar</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">Y_miss</span> <span class="op">~</span> <span class="va">X</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>  engine <span class="op">=</span> <span class="va">engine</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; NMAR Model Summary</span></span>
<span><span class="co">#&gt; =================</span></span>
<span><span class="co">#&gt; Y_miss mean: 1.878660 (0.288639)</span></span>
<span><span class="co">#&gt; 95% CI: (1.312938, 2.444383)</span></span>
<span><span class="co">#&gt; Converged: TRUE </span></span>
<span><span class="co">#&gt; Variance method: bootstrap </span></span>
<span><span class="co">#&gt; Variance notes: Calculation successful </span></span>
<span><span class="co">#&gt; Total units: 500 </span></span>
<span><span class="co">#&gt; Respondents: 150 </span></span>
<span><span class="co">#&gt; Call: nmar(Y_miss ~ X, data = &lt;data.frame: N=500&gt;, engine = empirical_likelihood)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response-model coefficients:</span></span>
<span><span class="co">#&gt;              Estimate</span></span>
<span><span class="co">#&gt; (Intercept) -1.570694</span></span>
<span><span class="co">#&gt; Y_miss       0.366754</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;           2.5 %   97.5 %</span></span>
<span><span class="co">#&gt; Y_miss 1.312938 2.444383</span></span></code></pre></div>
<p>Probit family (optional):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">engine</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/el_engine.html">el_engine</a></span><span class="op">(</span>auxiliary_means <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"probit"</span>, variance_method <span class="op">=</span> <span class="st">"bootstrap"</span>, standardize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_probit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmar.html">nmar</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">Y_miss</span> <span class="op">~</span> <span class="va">X</span>,</span>
<span>  engine <span class="op">=</span> <span class="va">engine</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dat</span></span>
<span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_probit</span><span class="op">)</span></span>
<span><span class="co">#&gt; NMAR Model Summary</span></span>
<span><span class="co">#&gt; =================</span></span>
<span><span class="co">#&gt; Y_miss mean: 1.880128 (0.243890)</span></span>
<span><span class="co">#&gt; 95% CI: (1.402113, 2.358143)</span></span>
<span><span class="co">#&gt; Converged: TRUE </span></span>
<span><span class="co">#&gt; Variance method: bootstrap </span></span>
<span><span class="co">#&gt; Variance notes: Calculation successful </span></span>
<span><span class="co">#&gt; Total units: 500 </span></span>
<span><span class="co">#&gt; Respondents: 150 </span></span>
<span><span class="co">#&gt; Call: nmar(Y_miss ~ X, data = &lt;data.frame: N=500&gt;, engine = empirical_likelihood)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response-model coefficients:</span></span>
<span><span class="co">#&gt;              Estimate</span></span>
<span><span class="co">#&gt; (Intercept) -0.949678</span></span>
<span><span class="co">#&gt; Y_miss       0.217504</span></span></code></pre></div>
<p>Tidy/glance summaries, and plots:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"broom"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt;     y_hat std.error conf.low conf.high converged trimmed_fraction</span></span>
<span><span class="co">#&gt; 1 1.87866 0.2886393 1.312938  2.444383      TRUE                0</span></span>
<span><span class="co">#&gt;   variance_method jacobian_condition_number max_equation_residual</span></span>
<span><span class="co">#&gt; 1       bootstrap                  36.83019           4.07232e-11</span></span>
<span><span class="co">#&gt;   min_denominator fraction_small_denominators nobs nobs_resp is_survey</span></span>
<span><span class="co">#&gt; 1       0.4613402                           0  500       150     FALSE</span></span>
<span></span>
<span><span class="co"># plot(fit, which = "weights")</span></span>
<span><span class="co"># plot(fit, which = "fitted")</span></span></code></pre></div>
<p>Outputs and diagnostics at a glance:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/weights.html" class="external-link">weights</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] 0.008384402 0.008937803 0.004381958 0.014450653 0.006959120 0.007160884</span></span>
<span><span class="co">#&gt;  [7] 0.005995129 0.006358571 0.007390444 0.007842733</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] 0.2385382 0.2237686 0.4564170 0.1384020 0.2873926 0.2792951 0.3336042</span></span>
<span><span class="co">#&gt;  [8] 0.3145361 0.2706197 0.2550132</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 36</span></span>
<span><span class="co">#&gt;  $ convergence_code                  : int 1</span></span>
<span><span class="co">#&gt;  $ message                           : chr "Function criterion near zero"</span></span>
<span><span class="co">#&gt;  $ vcov_message                      : chr "Calculation successful"</span></span>
<span><span class="co">#&gt;  $ trimmed_fraction                  : num 0</span></span>
<span><span class="co">#&gt;  $ solver_method                     : chr "Newton"</span></span>
<span><span class="co">#&gt;  $ nleqslv_global                    : chr NA</span></span>
<span><span class="co">#&gt;  $ nleqslv_xscalm                    : chr NA</span></span>
<span><span class="co">#&gt;  $ solver_iterations                 : int 6</span></span>
<span><span class="co">#&gt;  $ solver_time                       : num 0.005</span></span>
<span><span class="co">#&gt;  $ variance_time                     : num 3.99</span></span>
<span><span class="co">#&gt;  $ reparam_W                         : chr "logit"</span></span>
<span><span class="co">#&gt;  $ max_equation_residual             : num 4.07e-11</span></span>
<span><span class="co">#&gt;  $ jacobian_condition_number         : num 36.8</span></span>
<span><span class="co">#&gt;  $ aux_inconsistency_max_z           : num 0.114</span></span>
<span><span class="co">#&gt;  $ aux_inconsistency_cols            : chr(0) </span></span>
<span><span class="co">#&gt;  $ grad_source                       : chr NA</span></span>
<span><span class="co">#&gt;  $ var_y_hat_val                     : num NA</span></span>
<span><span class="co">#&gt;  $ var_anal2                         : num NA</span></span>
<span><span class="co">#&gt;  $ grad_l1                           : num NA</span></span>
<span><span class="co">#&gt;  $ sigma_min_eig                     : num NA</span></span>
<span><span class="co">#&gt;  $ B_min_eig                         : num NA</span></span>
<span><span class="co">#&gt;  $ min_denominator                   : num 0.461</span></span>
<span><span class="co">#&gt;  $ fraction_small_denominators       : num 0</span></span>
<span><span class="co">#&gt;  $ denom_q01                         : num 0.496</span></span>
<span><span class="co">#&gt;  $ denom_q05                         : num 0.664</span></span>
<span><span class="co">#&gt;  $ denom_median                      : num 1.05</span></span>
<span><span class="co">#&gt;  $ denom_count_lt_1e4                : int 0</span></span>
<span><span class="co">#&gt;  $ weight_max_share                  : num 0.0145</span></span>
<span><span class="co">#&gt;  $ weight_top5_share                 : num 0.0665</span></span>
<span><span class="co">#&gt;  $ weight_ess                        : num 137</span></span>
<span><span class="co">#&gt;  $ constraint_sum_W                  : num -4.48e-12</span></span>
<span><span class="co">#&gt;  $ constraint_sum_aux                : Named num -4.07e-11</span></span>
<span><span class="co">#&gt;   ..- attr(*, "names")= chr "X"</span></span>
<span><span class="co">#&gt;  $ sum_respondent_weights            : num 150</span></span>
<span><span class="co">#&gt;  $ sum_unnormalized_weights_untrimmed: num 150</span></span>
<span><span class="co">#&gt;  $ normalization_ratio               : num 1</span></span>
<span><span class="co">#&gt;  $ max_constraint_residual           : num 4.07e-11</span></span></code></pre></div>
<p>Bootstrap variance (keep reps small for speed):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">engine</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/el_engine.html">el_engine</a></span><span class="op">(</span>auxiliary_means <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, variance_method <span class="op">=</span> <span class="st">"bootstrap"</span>, bootstrap_reps <span class="op">=</span> <span class="fl">15</span>, standardize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmar.html">nmar</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">Y_miss</span> <span class="op">~</span> <span class="va">X</span>,</span>
<span>  engine <span class="op">=</span> <span class="va">engine</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dat</span></span>
<span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit_boot</span><span class="op">$</span><span class="va">se</span></span>
<span><span class="co">#&gt; [1] 0.2841981</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="respondents-only-data-n_total">Respondents-only data (n_total)<a class="anchor" aria-label="anchor" href="#respondents-only-data-n_total"></a>
</h2>
<p>If you pass respondents-only data (the outcome contains no NA),
provide the total sample size via <code>n_total</code> in the engine so
the estimator can recover the population response rate:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">300</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>; <span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>; <span class="va">Y</span> <span class="op">&lt;-</span> <span class="fl">1.5</span> <span class="op">+</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="va">X</span> <span class="op">+</span> <span class="va">Z</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span> <span class="op">+</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">p</span></span>
<span><span class="va">df_resp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Y_miss <span class="op">=</span> <span class="va">Y</span>, X <span class="op">=</span> <span class="va">X</span><span class="op">)</span>, <span class="va">R</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">eng_resp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/el_engine.html">el_engine</a></span><span class="op">(</span>auxiliary_means <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, variance_method <span class="op">=</span> <span class="st">"none"</span>, n_total <span class="op">=</span> <span class="va">N</span><span class="op">)</span></span>
<span><span class="va">fit_resp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmar.html">nmar</a></span><span class="op">(</span><span class="va">Y_miss</span> <span class="op">~</span> <span class="va">X</span>, data <span class="op">=</span> <span class="va">df_resp</span>, engine <span class="op">=</span> <span class="va">eng_resp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_resp</span><span class="op">)</span></span>
<span><span class="co">#&gt; NMAR Model Summary</span></span>
<span><span class="co">#&gt; =================</span></span>
<span><span class="co">#&gt; Y_miss mean: 1.994823</span></span>
<span><span class="co">#&gt; Converged: TRUE </span></span>
<span><span class="co">#&gt; Variance method: none </span></span>
<span><span class="co">#&gt; Variance notes: Variance skipped (variance_method='none') </span></span>
<span><span class="co">#&gt; Total units: 300 </span></span>
<span><span class="co">#&gt; Respondents: 122 </span></span>
<span><span class="co">#&gt; Call: nmar(Y_miss ~ X, data = &lt;data.frame: N=300&gt;, engine = empirical_likelihood)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response-model coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error z value Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)  0.616276         NA      NA       NA</span></span>
<span><span class="co">#&gt; Y_miss      -0.511238         NA      NA       NA</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="response-only-predictors">Response-only predictors<a class="anchor" aria-label="anchor" href="#response-only-predictors"></a>
</h2>
<p>You can include predictors that enter only the response model (and
are not constrained as auxiliaries) by placing them to the right of
<code>|</code> in the formula.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">400</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">0.6</span> <span class="op">*</span> <span class="va">X</span> <span class="op">+</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">Z</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.6</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="va">Z</span><span class="op">)</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">p</span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Y_miss <span class="op">=</span> <span class="va">Y</span>, X <span class="op">=</span> <span class="va">X</span>, Z <span class="op">=</span> <span class="va">Z</span><span class="op">)</span></span>
<span><span class="va">df2</span><span class="op">$</span><span class="va">Y_miss</span><span class="op">[</span><span class="op">!</span><span class="va">R</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA_real_</span></span>
<span><span class="va">engine</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/el_engine.html">el_engine</a></span><span class="op">(</span>auxiliary_means <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, variance_method <span class="op">=</span> <span class="st">"bootstrap"</span>, standardize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use X as auxiliary (known population mean 0), and Z as response-only predictor</span></span>
<span><span class="va">fit_resp_only</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmar.html">nmar</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">Y_miss</span> <span class="op">~</span> <span class="va">X</span> <span class="op">|</span> <span class="va">Z</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df2</span>,</span>
<span>  engine <span class="op">=</span> <span class="va">engine</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_resp_only</span><span class="op">)</span></span>
<span><span class="co">#&gt; NMAR Model Summary</span></span>
<span><span class="co">#&gt; =================</span></span>
<span><span class="co">#&gt; Y_miss mean: 1.276092 (0.205072)</span></span>
<span><span class="co">#&gt; 95% CI: (0.874159, 1.678025)</span></span>
<span><span class="co">#&gt; Converged: TRUE </span></span>
<span><span class="co">#&gt; Variance method: bootstrap </span></span>
<span><span class="co">#&gt; Variance notes: Calculation successful </span></span>
<span><span class="co">#&gt; Total units: 400 </span></span>
<span><span class="co">#&gt; Respondents: 130 </span></span>
<span><span class="co">#&gt; Call: nmar(Y_miss ~ X | Z, data = &lt;data.frame: N=400&gt;, engine = empirical_likelihood)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response-model coefficients:</span></span>
<span><span class="co">#&gt;              Estimate</span></span>
<span><span class="co">#&gt; (Intercept) -0.899506</span></span>
<span><span class="co">#&gt; Y_miss       0.107841</span></span>
<span><span class="co">#&gt; Z            0.105258</span></span></code></pre></div>
<p>Auxiliary means and formulas:</p>
<ul>
<li>Names of <code>auxiliary_means</code> must match the variables on
the outcome RHS exactly.</li>
<li>When <code>standardize = TRUE</code>, the engine automatically
transforms <code>auxiliary_means</code> to the standardized scale
internally and reports coefficients on the original scale.</li>
<li>Response-only predictors (to the right of <code>|</code>) do not
need auxiliary means.</li>
</ul>
</div>
<div class="section level2">
<h2 id="survey-design-example-optional">Survey design example (optional)<a class="anchor" aria-label="anchor" href="#survey-design-example-optional"></a>
</h2>
<p>The estimator supports complex surveys via
<code><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">survey::svydesign()</a></code>. This chunk runs only if the
<code>survey</code> package is available.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"survey"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://r-survey.r-forge.r-project.org/survey/" class="external-link">survey</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">api</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span>  <span class="va">apiclus1</span><span class="op">$</span><span class="va">api00_miss</span> <span class="op">&lt;-</span> <span class="va">apiclus1</span><span class="op">$</span><span class="va">api00</span></span>
<span>  <span class="va">ystd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">apiclus1</span><span class="op">$</span><span class="va">api00</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span> <span class="op">+</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="va">ystd</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">apiclus1</span><span class="op">$</span><span class="va">ell</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">miss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">apiclus1</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">prob</span></span>
<span>  <span class="va">apiclus1</span><span class="op">$</span><span class="va">api00_miss</span><span class="op">[</span><span class="va">miss</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA_real_</span></span>
<span></span>
<span>  <span class="va">dclus1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">svydesign</a></span><span class="op">(</span>id <span class="op">=</span> <span class="op">~</span><span class="va">dnum</span>, weights <span class="op">=</span> <span class="op">~</span><span class="va">pw</span>, data <span class="op">=</span> <span class="va">apiclus1</span>, fpc <span class="op">=</span> <span class="op">~</span><span class="va">fpc</span><span class="op">)</span></span>
<span>  <span class="va">pop_mean_ell</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">apiclus1</span><span class="op">$</span><span class="va">ell</span><span class="op">)</span></span>
<span>  <span class="va">engine</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/el_engine.html">el_engine</a></span><span class="op">(</span>auxiliary_means <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>ell <span class="op">=</span> <span class="va">pop_mean_ell</span><span class="op">)</span>, variance_method <span class="op">=</span> <span class="st">"bootstrap"</span>, standardize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">fit_svy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nmar.html">nmar</a></span><span class="op">(</span></span>
<span>    formula <span class="op">=</span> <span class="va">api00_miss</span> <span class="op">~</span> <span class="va">ell</span>,</span>
<span>    data <span class="op">=</span> <span class="va">dclus1</span>,</span>
<span>    engine <span class="op">=</span> <span class="va">engine</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_svy</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Loading required package: grid</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="co">#&gt; Loading required package: survival</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'survival'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:future':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     cluster</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'survey'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:graphics':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     dotchart</span></span>
<span><span class="co">#&gt; NMAR Model Summary</span></span>
<span><span class="co">#&gt; =================</span></span>
<span><span class="co">#&gt; api00_miss mean: 691.822197 (31.307011)</span></span>
<span><span class="co">#&gt; 95% CI: (624.675338, 758.969056)</span></span>
<span><span class="co">#&gt; Converged: TRUE </span></span>
<span><span class="co">#&gt; Variance method: bootstrap </span></span>
<span><span class="co">#&gt; Variance notes: Calculation successful </span></span>
<span><span class="co">#&gt; Total units: 6194 </span></span>
<span><span class="co">#&gt; Respondents: 65 </span></span>
<span><span class="co">#&gt; Call: nmar(api00_miss ~ ell, data = &lt;survey.design: N=6194.00032424927&gt;, engine = empirical_likelihood)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response-model coefficients:</span></span>
<span><span class="co">#&gt;              Estimate</span></span>
<span><span class="co">#&gt; (Intercept)  3.231721</span></span>
<span><span class="co">#&gt; api00_miss  -0.005586</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="practical-guidance">Practical guidance<a class="anchor" aria-label="anchor" href="#practical-guidance"></a>
</h2>
<ul>
<li>Variance method: Analytical delta variance for EL is currently
disabled; use bootstrap for standard errors.</li>
<li>Trimming: Use a finite <code>trim_cap</code> to improve robustness
when large weights occur; prefer bootstrap variance when trimming.</li>
<li>Solver control: set
<code>control = list(xtol = 1e-10, ftol = 1e-10, maxit = 200)</code> for
tighter tolerances if needed. Globalization details are managed
internally by <code>nleqslv</code>.</li>
<li>Standardization: <code>standardize = TRUE</code> typically improves
numerical stability and comparability across predictors and auxiliary
means.</li>
<li>Diagnostics: Inspect <code>fit$diagnostics</code> (Jacobian
condition number, max equation residuals, trimming fraction) to assess
numerical health and identification strength.</li>
<li>Response-only predictors: Variables in
<code>response_predictors</code> do not need to appear on the RHS of the
outcome formula; they enter only the response model. Auxiliary means
must be supplied only for variables on the outcome RHS.</li>
<li>Inconsistent auxiliaries: If provided auxiliary means are grossly
inconsistent with the sample, EL weights may go negative and the solver
may fail. Consider revisiting the constraints, relaxing them, or using
<code>trim_cap</code> and bootstrap variance.</li>
</ul>
<p>Troubleshooting:</p>
<ul>
<li>Negative or extreme weights: set a finite <code>trim_cap</code>;
prefer <code>variance_method = "bootstrap"</code> for SE.</li>
<li>Ill-conditioned Jacobian (large
<code>fit$diagnostics$jacobian_condition_number</code>): prefer
<code>variance_method = "bootstrap"</code>. You may also tighten solver
tolerances via
<code>control = list(xtol=..., ftol=..., maxit=...)</code>.</li>
<li>Convergence issues: check
<code>fit$diagnostics$max_equation_residual</code>, rescale predictors
(<code>standardize = TRUE</code>), or reduce the number of
constraints.</li>
</ul>
</div>
<div class="section level2">
<h2 id="solver-control-and-notes">Solver control and notes<a class="anchor" aria-label="anchor" href="#solver-control-and-notes"></a>
</h2>
<ul>
<li>Control example: increase iterations and tighten tolerances via
<code>control</code> (passed to <code>nleqslv</code>):</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ctrl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxit <span class="op">=</span> <span class="fl">200</span>, xtol <span class="op">=</span> <span class="fl">1e-10</span>, ftol <span class="op">=</span> <span class="fl">1e-10</span><span class="op">)</span></span>
<span><span class="va">eng_ctrl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/el_engine.html">el_engine</a></span><span class="op">(</span>auxiliary_means <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, variance_method <span class="op">=</span> <span class="st">"none"</span>, control <span class="op">=</span> <span class="va">ctrl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="../reference/nmar.html">nmar</a></span><span class="op">(</span><span class="va">Y_miss</span> <span class="op">~</span> <span class="va">X</span>, data <span class="op">=</span> <span class="va">dat</span>, engine <span class="op">=</span> <span class="va">eng_ctrl</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references-and-further-reading">References and further reading<a class="anchor" aria-label="anchor" href="#references-and-further-reading"></a>
</h2>
<ul>
<li>Qin, J., Leung, D., and Shao, J. (2002). Estimation with survey data
under nonignorable nonresponse or informative sampling. Journal of the
American Statistical Association, 97(457), 193–200. <a href="doi:10.1198/016214502753479338" class="uri">doi:10.1198/016214502753479338</a>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="families-and-numerical-stability">Families and numerical stability<a class="anchor" aria-label="anchor" href="#families-and-numerical-stability"></a>
</h2>
<ul>
<li>Family: <code>el_engine(family = "logit")</code> (default) or
<code>family = "probit"</code>.</li>
<li>Probit stability: the response-model score uses a stable log-ratio
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mi>/</mi><mi>Φ</mi></mrow><annotation encoding="application/x-tex">\phi/\Phi</annotation></semantics></math>
under the hood.</li>
<li>Theory mapping: see the companion article “Empirical Likelihood
Theory for NMAR” for equations, Jacobian blocks, and variance
details.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] grid      stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">#&gt; [8] base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] survey_4.4-8   survival_3.8-3 Matrix_1.7-3   future_1.67.0  NMAR_0.0.0.1  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] sass_0.4.10         generics_0.1.4      tidyr_1.3.1        </span></span>
<span><span class="co">#&gt;  [4] lpSolve_5.6.23      lattice_0.22-7      listenv_0.9.1      </span></span>
<span><span class="co">#&gt;  [7] digest_0.6.37       magrittr_2.0.4      evaluate_1.0.5     </span></span>
<span><span class="co">#&gt; [10] nleqslv_3.3.5       fastmap_1.2.0       sampling_2.11      </span></span>
<span><span class="co">#&gt; [13] jsonlite_2.0.0      backports_1.5.0     DBI_1.2.3          </span></span>
<span><span class="co">#&gt; [16] purrr_1.1.0         codetools_0.2-20    textshaping_1.0.4  </span></span>
<span><span class="co">#&gt; [19] jquerylib_0.1.4     cli_3.6.5           mitools_2.4        </span></span>
<span><span class="co">#&gt; [22] rlang_1.1.6         parallelly_1.45.1   future.apply_1.20.0</span></span>
<span><span class="co">#&gt; [25] splines_4.5.1       cachem_1.1.0        yaml_2.3.10        </span></span>
<span><span class="co">#&gt; [28] tools_4.5.1         parallel_4.5.1      dplyr_1.1.4        </span></span>
<span><span class="co">#&gt; [31] globals_0.18.0      broom_1.0.10        vctrs_0.6.5        </span></span>
<span><span class="co">#&gt; [34] R6_2.6.1            lifecycle_1.0.4     fs_1.6.6           </span></span>
<span><span class="co">#&gt; [37] htmlwidgets_1.6.4   MASS_7.3-65         svrep_0.9.1        </span></span>
<span><span class="co">#&gt; [40] ragg_1.5.0          pkgconfig_2.0.3     desc_1.4.3         </span></span>
<span><span class="co">#&gt; [43] progressr_0.17.0    pkgdown_2.1.3       pillar_1.11.1      </span></span>
<span><span class="co">#&gt; [46] bslib_0.9.0         glue_1.8.0          Rcpp_1.1.0         </span></span>
<span><span class="co">#&gt; [49] systemfonts_1.3.1   xfun_0.54           tibble_3.3.0       </span></span>
<span><span class="co">#&gt; [52] tidyselect_1.2.1    knitr_1.50          htmltools_0.5.8.1  </span></span>
<span><span class="co">#&gt; [55] rmarkdown_2.30      compiler_4.5.1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="notes-on-variance-choices">Notes on variance choices<a class="anchor" aria-label="anchor" href="#notes-on-variance-choices"></a>
</h2>
<ul>
<li>Analytical delta variance for EL is not implemented in this version.
Use <code>variance_method = "bootstrap"</code> for SEs.</li>
<li>For speed‑critical bootstraps, you can set
<code>variance_method = "none"</code> for point fits and let the
bootstrap call use it internally for replicates (this is the default
behavior when you request bootstrap SEs through
<code>el_engine(...)</code>).</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maciej Beręsewicz, Igor Kołodziej, Mateusz Iwaniuk.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
